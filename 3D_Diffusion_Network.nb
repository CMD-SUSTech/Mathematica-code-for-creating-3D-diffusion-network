(* Content-type: application/vnd.wolfram.mathematica *)

(*** Wolfram Notebook File ***)
(* http://www.wolfram.com/nb *)

(* CreatedBy='Mathematica 12.0' *)

(*CacheID: 234*)
(* Internal cache information:
NotebookFileLineBreakTest
NotebookFileLineBreakTest
NotebookDataPosition[       158,          7]
NotebookDataLength[    199193,       4581]
NotebookOptionsPosition[    195738,       4512]
NotebookOutlinePosition[    196164,       4529]
CellTagsIndexPosition[    196121,       4526]
WindowFrame->Normal*)

(* Beginning of Notebook Content *)
Notebook[{

Cell[CellGroupData[{
Cell[TextData[StyleBox["Steps 1-3 in the paper",
 FontFamily->"Tahoma",
 FontSize->20,
 FontColor->RGBColor[0., 0.5098039215686274, 0.7490196078431373]]], "Section",
 CellChangeTimes->{
  3.861677451689701*^9, {3.861677484775999*^9, 3.8616775165810046`*^9}, {
   3.8616775642747974`*^9, 3.8616775644778476`*^9}, {3.861677623886115*^9, 
   3.861677637320485*^9}, 3.862536274595021*^9, 3.86486892230955*^9, {
   3.8648689583685627`*^9, 3.864869038748819*^9}, {3.864869299768076*^9, 
   3.864869300002394*^9}, {3.864870234042578*^9, 3.864870242706471*^9}, {
   3.8648723025226116`*^9, 3.864872303570187*^9}, {3.864872495529555*^9, 
   3.864872499096853*^9}, {3.864888177375281*^9, 3.864888182817638*^9}, {
   3.8680030147972336`*^9, 3.8680031168622985`*^9}, {3.868072087782483*^9, 
   3.868072089204934*^9}, {3.868151878254257*^9, 3.868151879504495*^9}, {
   3.868153174941499*^9, 3.868153208865707*^9}, {3.946604491688714*^9, 
   3.946604500356733*^9}, {3.946605344118484*^9, 3.946605344601804*^9}, {
   3.946605424588828*^9, 3.9466054262839594`*^9}, {3.946605499147711*^9, 
   3.946605499430928*^9}, {3.947590946152051*^9, 3.947590951577709*^9}, {
   3.947591035471349*^9, 3.947591039262901*^9}, {3.947655833343676*^9, 
   3.947655839766768*^9}},ExpressionUUID->"67b66d33-e159-4bf6-8153-\
251727357a1b"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", 
   RowBox[{"Create", " ", "overall", " ", "directories"}], "*)"}], 
  "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"Off", "[", 
     RowBox[{"RenameFile", "::", "eexist"}], "]"}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"MyCreateDir", "[", "path_", "]"}], ":=", 
    RowBox[{"If", "[", 
     RowBox[{
      RowBox[{"!", 
       RowBox[{"DirectoryQ", "[", "path", "]"}]}], ",", 
      RowBox[{"CreateDirectory", "[", "path", "]"}], ",", 
      RowBox[{"Print", "[", 
       RowBox[{"path", "<>", "\"\< exists.\>\""}], "]"}]}], "]"}]}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"MyImport", "[", 
     RowBox[{"file_", ",", "format_"}], "]"}], ":=", 
    RowBox[{"If", "[", 
     RowBox[{
      RowBox[{"FileExistsQ", "[", "file", "]"}], ",", 
      RowBox[{"Import", "[", 
       RowBox[{"file", ",", "format"}], "]"}], ",", 
      RowBox[{
       RowBox[{"Print", "[", 
        RowBox[{"file", "<>", "\"\< does not exist. Aborting...\>\""}], "]"}],
        ";", 
       RowBox[{"Abort", "[", "]"}]}]}], "]"}]}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"MyRename", "[", 
     RowBox[{"file1_", ",", "file2_"}], "]"}], ":=", 
    RowBox[{"If", "[", 
     RowBox[{
      RowBox[{"FileExistsQ", "[", "file1", "]"}], ",", 
      RowBox[{"RenameFile", "[", 
       RowBox[{"file1", ",", "file2"}], "]"}], ",", 
      RowBox[{
       RowBox[{"Print", "[", 
        RowBox[{"file1", "<>", "\"\< does not exist. Aborting...\>\""}], 
        "]"}], ";", 
       RowBox[{"Abort", "[", "]"}]}]}], "]"}]}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"MyCopyFile", "[", 
     RowBox[{"file1_", ",", "file2_"}], "]"}], ":=", 
    RowBox[{"If", "[", 
     RowBox[{
      RowBox[{"FileExistsQ", "[", "file2", "]"}], ",", 
      RowBox[{
       RowBox[{"Print", "[", 
        RowBox[{"\"\<Overite existing \>\"", "<>", "file2"}], " ", "]"}], ";", 
       RowBox[{"DeleteFile", "[", "file2", "]"}], ";", 
       RowBox[{"CopyFile", "[", 
        RowBox[{"file1", ",", "file2"}], "]"}]}], ",", 
      RowBox[{"CopyFile", "[", 
       RowBox[{"file1", ",", "file2"}], "]"}]}], "]"}]}], 
   "\[IndentingNewLine]", "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"CreateDir", "[", 
      RowBox[{"folderPath_", ",", "strName_", ",", "ion_"}], "]"}], ":=", 
     RowBox[{"Module", "[", 
      RowBox[{
       RowBox[{"{", "dirs", "}"}], ",", "\[IndentingNewLine]", 
       "               ", 
       RowBox[{
        RowBox[{"dirs", "=", 
         RowBox[{"{", 
          RowBox[{
          "\"\<1_zeolite_GeoOpt\>\"", ",", "\"\<2_quick_GeoOpt\>\"", ",", 
           "\"\<3_normal_GeoOpt\>\"", ",", "\"\<4_IF_GeoOpt\>\"", ",", 
           "\"\<5_cNEB_Opt\>\"", ",", "\"\<6_3D_network\>\""}], "}"}]}], ";", 
        "\[IndentingNewLine]", "               ", 
        RowBox[{"Map", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"MyCreateDir", "[", 
            RowBox[{
            "folderPath", "<>", "\"\</\>\"", "<>", "strName", "<>", 
             "\"\<_\>\"", "<>", "ion", "<>", "\"\</\>\"", "<>", 
             RowBox[{"ToString", "[", "#", "]"}]}], "]"}], "&"}], ",", 
          "dirs"}], "]"}]}]}], "\[IndentingNewLine]", "               ", 
      "]"}]}], ";"}], "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{"(*", 
    StyleBox[
     RowBox[{
     "Generate", " ", "symmetrically", " ", "equivalent", " ", "points"}],
     FontColor->RGBColor[0, 0.501961, 0.752941]], "*)"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"symmetry", "[", 
      RowBox[{"folderPath_", ",", "symGroupN_", ",", "xyz_"}], "]"}], ":=", 
     RowBox[{"Module", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"spgOperations", ",", "sym"}], "}"}], ",", 
       "\[IndentingNewLine]", "              ", 
       RowBox[{
        RowBox[{"spgOperations", "=", 
         RowBox[{
          RowBox[{"MyImport", "[", 
           RowBox[{
            RowBox[{
            "folderPath", "<>", "\"\</CrystalSpaceGroupOperations.txt\>\""}], 
            ",", "\"\<TSV\>\""}], "]"}], "//", "ToExpression"}]}], ";", 
        "\[IndentingNewLine]", "              ", 
        RowBox[{"sym", "=", 
         RowBox[{
          RowBox[{"spgOperations", "[", 
           RowBox[{"[", "symGroupN", "]"}], "]"}], "[", 
          RowBox[{"[", 
           RowBox[{"2", ";;"}], "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
        "              ", 
        RowBox[{"sym", "/.", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"x", "\[Rule]", 
            RowBox[{"xyz", "[", 
             RowBox[{"[", "1", "]"}], "]"}]}], ",", 
           RowBox[{"y", "\[Rule]", 
            RowBox[{"xyz", "[", 
             RowBox[{"[", "2", "]"}], "]"}]}], ",", 
           RowBox[{"z", "\[Rule]", 
            RowBox[{"xyz", "[", 
             RowBox[{"[", "3", "]"}], "]"}]}]}], "}"}]}]}]}], 
      "\[IndentingNewLine]", "              ", "]"}]}], ";"}], 
   "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{"(*", 
    StyleBox[
     RowBox[{"Create", " ", "POSCAR", " ", "file"}],
     FontColor->RGBColor[0, 0.501961, 0.752941]], "*)"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"CreatePOSCAR", "[", 
      RowBox[{
      "folderPath_", ",", "strName_", ",", "ion_", ",", "uneqlPoints_"}], 
      "]"}], ":=", 
     RowBox[{"Module", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"path", ",", "mat", ",", "i", ",", "ans1"}], "}"}], ",", 
       "\[IndentingNewLine]", "              ", 
       RowBox[{
        RowBox[{"path", "=", 
         RowBox[{
         "folderPath", "<>", "\"\</\>\"", "<>", "strName", "<>", "\"\<_\>\"", 
          "<>", "ion", "<>", "\"\</2_quick_GeoOpt\>\""}]}], ";", 
        "\[IndentingNewLine]", "\[IndentingNewLine]", "              ", 
        RowBox[{"mat", "=", 
         RowBox[{"MyImport", "[", 
          RowBox[{
           RowBox[{
           "folderPath", "<>", "\"\</\>\"", "<>", "strName", "<>", 
            "\"\<_\>\"", "<>", "ion", "<>", 
            "\"\</1_zeolite_GeoOpt/CONTCAR\>\""}], ",", "\"\<Table\>\""}], 
          "]"}]}], ";", "\[IndentingNewLine]", "              ", 
        RowBox[{
         RowBox[{"mat", "[", 
          RowBox[{"[", "6", "]"}], "]"}], "=", 
         RowBox[{"Append", "[", 
          RowBox[{
           RowBox[{"mat", "[", 
            RowBox[{"[", "6", "]"}], "]"}], ",", "ion"}], "]"}]}], ";", 
        "\[IndentingNewLine]", "              ", 
        RowBox[{
         RowBox[{"mat", "[", 
          RowBox[{"[", "7", "]"}], "]"}], "=", 
         RowBox[{"Append", "[", 
          RowBox[{
           RowBox[{"mat", "[", 
            RowBox[{"[", "7", "]"}], "]"}], ",", "1"}], "]"}]}], ";", 
        "\[IndentingNewLine]", "              ", 
        RowBox[{"mat", "=", 
         RowBox[{"Insert", "[", 
          RowBox[{"mat", ",", 
           RowBox[{"{", "\"\<Selective dynamics\>\"", "}"}], ",", "8"}], 
          "]"}]}], ";", "\[IndentingNewLine]", "              ", 
        RowBox[{
         RowBox[{"mat", "[", 
          RowBox[{"[", 
           RowBox[{"10", ";;"}], "]"}], "]"}], "=", 
         RowBox[{"Map", "[", 
          RowBox[{
           RowBox[{
            RowBox[{"Append", "[", 
             RowBox[{
              RowBox[{"mat", "[", 
               RowBox[{"[", "#", "]"}], "]"}], ",", "  ", 
              "\"\<  F  F  F\>\""}], "]"}], "&"}], ",", 
           RowBox[{"Range", "[", 
            RowBox[{"10", ",", 
             RowBox[{"Length", "@", "mat"}], ",", "1"}], "]"}]}], "]"}]}], 
        ";", "\[IndentingNewLine]", "\[IndentingNewLine]", "              ", 
        RowBox[{"Map", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"MyCreateDir", "[", 
            RowBox[{"path", "<>", "\"\</\>\"", "<>", 
             RowBox[{"ToString", "[", "#", "]"}]}], "]"}], "&"}], ",", 
          RowBox[{"Range", "[", 
           RowBox[{"Length", "@", "uneqlPoints"}], "]"}]}], "]"}], ";", 
        "\[IndentingNewLine]", "\[IndentingNewLine]", "              ", 
        RowBox[{"For", "[", 
         RowBox[{
          RowBox[{"i", "=", "1"}], ",", 
          RowBox[{"i", "\[LessEqual]", 
           RowBox[{"Length", "@", "uneqlPoints"}]}], ",", 
          RowBox[{"i", "=", 
           RowBox[{"i", "+", "1"}]}], ",", "\[IndentingNewLine]", 
          "                    ", 
          RowBox[{
           RowBox[{"ans1", "=", 
            RowBox[{"Append", "[", 
             RowBox[{"mat", ",", 
              RowBox[{
               RowBox[{"(", 
                RowBox[{
                 RowBox[{"Map", "[", 
                  RowBox[{
                   RowBox[{
                    RowBox[{
                    RowBox[{"ToString", "[", "#", "]"}], "<>", "\"\< \>\""}], 
                    "&"}], ",", 
                   RowBox[{"uneqlPoints", "[", 
                    RowBox[{"[", "i", "]"}], "]"}]}], "]"}], "//", 
                 "StringJoin"}], ")"}], "<>", "\"\<T T T\>\""}]}], "]"}]}], 
           ";", "   ", "\[IndentingNewLine]", "                    ", 
           RowBox[{"Export", "[", 
            RowBox[{
             RowBox[{"path", "<>", "\"\</\>\"", "<>", 
              RowBox[{"ToString", "[", "i", "]"}], "<>", "\"\</POSCAR\>\""}], 
             ",", "ans1", ",", "\"\<Table\>\""}], "]"}]}]}], 
         "\[IndentingNewLine]", "                   ", "]"}], ";", 
        "\[IndentingNewLine]", "\[IndentingNewLine]", "              ", 
        RowBox[{
         RowBox[{
          RowBox[{"FileNames", "[", 
           RowBox[{"\"\<POSCAR\>\"", ",", "path", ",", "2"}], "]"}], "//", 
          "TableForm"}], "//", "Print"}]}]}], "\[IndentingNewLine]", 
      "              ", "]"}]}], ";"}], "\[IndentingNewLine]", 
   "\[IndentingNewLine]", 
   RowBox[{"(*", 
    StyleBox[
     RowBox[{
     "Generate", " ", "POSCAR", " ", "files", " ", "with", " ", "alkali", " ",
       "ion", " ", "at", " ", "inequivalent", " ", "sampling", " ", "sites"}],
     FontColor->RGBColor[0, 0.501961, 0.752941]], "*)"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"Step2POSCARs", "[", 
      RowBox[{
      "folderPath_", ",", "strName_", ",", "ion_", ",", "symGroupN_", ",", 
       RowBox[{"{", 
        RowBox[{"bondOX_", ",", "bondTol_"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"meshIntvl_", ",", "meshTol_"}], "}"}]}], "]"}], ":=", 
     RowBox[{"Module", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
        "path", ",", "mat", ",", "cell", ",", "matSiO2", ",", "cellSize", ",",
          "meshsize", ",", "a", ",", "b", ",", "c", ",", "mesh", ",", 
         RowBox[{"AtomsNearby", "=", 
          RowBox[{"{", "}"}]}], ",", "Natom", ",", "i", ",", "dx", ",", "dy", 
         ",", "dz", ",", "dr", ",", "uneqlAtoms", ",", "m", ",", "n", ",", 
         "SymPoint", ",", "dxyz", ",", "dr1", ",", "strNearbyAdsPt", ",", 
         "strUneqlAdsPt"}], "}"}], ",", "\[IndentingNewLine]", 
       "             ", 
       RowBox[{
        RowBox[{"path", "=", 
         RowBox[{
         "folderPath", "<>", "\"\</\>\"", "<>", "strName", "<>", "\"\<_\>\"", 
          "<>", "ion"}]}], ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
        "              ", 
        RowBox[{"mat", "=", 
         RowBox[{"MyImport", "[", 
          RowBox[{
           RowBox[{"path", "<>", "\"\</1_zeolite_GeoOpt/CONTCAR\>\""}], ",", 
           "\"\<Table\>\""}], "]"}]}], ";", "\[IndentingNewLine]", 
        "              ", 
        RowBox[{"cell", "=", 
         RowBox[{
          RowBox[{"mat", "[", 
           RowBox[{"[", 
            RowBox[{"2", ",", "1"}], "]"}], "]"}], "*", 
          RowBox[{"mat", "[", 
           RowBox[{"[", 
            RowBox[{
             RowBox[{"{", 
              RowBox[{"3", ",", "4", ",", "5"}], "}"}], ",", "All"}], "]"}], 
           "]"}]}]}], ";", "\[IndentingNewLine]", "              ", 
        RowBox[{"cellSize", "=", 
         RowBox[{"Norm", "/@", "cell"}]}], ";", "\[IndentingNewLine]", 
        "              ", 
        RowBox[{"meshsize", "=", 
         RowBox[{"Round", "[", 
          RowBox[{"cellSize", "/", "meshIntvl"}], "]"}]}], ";", 
        "\[IndentingNewLine]", "              ", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"a", ",", "b", ",", "c"}], "}"}], "=", 
         RowBox[{
          RowBox[{"Map", "[", 
           RowBox[{
            RowBox[{
             RowBox[{
              RowBox[{"Range", "[", "#", "]"}], "/", "#"}], "&"}], ",", 
            "meshsize"}], "]"}], "//", "N"}]}], ";", "\[IndentingNewLine]", 
        "              ", 
        RowBox[{"Natom", "=", 
         RowBox[{"Plus", "@@", 
          RowBox[{"mat", "[", 
           RowBox[{"[", "7", "]"}], "]"}]}]}], ";", "\[IndentingNewLine]", 
        "              ", 
        RowBox[{"matSiO2", "=", 
         RowBox[{"mat", "[", 
          RowBox[{"[", 
           RowBox[{"9", ";;", 
            RowBox[{"8", "+", "Natom"}]}], "]"}], "]"}]}], ";", 
        "\[IndentingNewLine]", "\[IndentingNewLine]", "              ", 
        RowBox[{"(*", 
         RowBox[{"--", 
          RowBox[{"--", 
           RowBox[{"--", 
            RowBox[{"--", 
             RowBox[{"--", 
              RowBox[{"--", 
               RowBox[{"--", 
                RowBox[{"--", 
                 RowBox[{"--", 
                  RowBox[{"--", 
                   RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{
                    "--", "--"}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]\
}]}]}]}], "*)"}], "\[IndentingNewLine]", "              ", 
        RowBox[{"mesh", "=", 
         RowBox[{"Tuples", "[", 
          RowBox[{"{", 
           RowBox[{"a", ",", "b", ",", "c"}], "}"}], "]"}]}], ";", 
        "\[IndentingNewLine]", "              ", 
        RowBox[{"For", "[", 
         RowBox[{
          RowBox[{"i", "=", "1"}], ",", 
          RowBox[{"i", "\[LessEqual]", 
           RowBox[{"Length", "@", "mesh"}]}], ",", 
          RowBox[{"i", "=", 
           RowBox[{"i", "+", "1"}]}], ",", "\[IndentingNewLine]", 
          "                     ", 
          RowBox[{
           RowBox[{"dx", "=", 
            RowBox[{"Map", "[", 
             RowBox[{
              RowBox[{
               RowBox[{
                RowBox[{"mesh", "[", 
                 RowBox[{"[", 
                  RowBox[{"i", ",", "1"}], "]"}], "]"}], "-", 
                RowBox[{"matSiO2", "[", 
                 RowBox[{"[", 
                  RowBox[{"#", ",", "1"}], "]"}], "]"}], "-", 
                RowBox[{"Round", "[", 
                 RowBox[{
                  RowBox[{"mesh", "[", 
                   RowBox[{"[", 
                    RowBox[{"i", ",", "1"}], "]"}], "]"}], "-", 
                  RowBox[{"matSiO2", "[", 
                   RowBox[{"[", 
                    RowBox[{"#", ",", "1"}], "]"}], "]"}]}], "]"}]}], "&"}], 
              ",", 
              RowBox[{"Range", "[", "Natom", "]"}]}], "]"}]}], ";", 
           "\[IndentingNewLine]", "                     ", 
           RowBox[{"dy", "=", 
            RowBox[{"Map", "[", 
             RowBox[{
              RowBox[{
               RowBox[{
                RowBox[{"mesh", "[", 
                 RowBox[{"[", 
                  RowBox[{"i", ",", "2"}], "]"}], "]"}], "-", 
                RowBox[{"matSiO2", "[", 
                 RowBox[{"[", 
                  RowBox[{"#", ",", "2"}], "]"}], "]"}], "-", 
                RowBox[{"Round", "[", 
                 RowBox[{
                  RowBox[{"mesh", "[", 
                   RowBox[{"[", 
                    RowBox[{"i", ",", "2"}], "]"}], "]"}], "-", 
                  RowBox[{"matSiO2", "[", 
                   RowBox[{"[", 
                    RowBox[{"#", ",", "2"}], "]"}], "]"}]}], "]"}]}], "&"}], 
              ",", 
              RowBox[{"Range", "[", "Natom", "]"}]}], "]"}]}], ";", 
           "\[IndentingNewLine]", "                     ", 
           RowBox[{"dz", "=", 
            RowBox[{"Map", "[", 
             RowBox[{
              RowBox[{
               RowBox[{
                RowBox[{"mesh", "[", 
                 RowBox[{"[", 
                  RowBox[{"i", ",", "3"}], "]"}], "]"}], "-", 
                RowBox[{"matSiO2", "[", 
                 RowBox[{"[", 
                  RowBox[{"#", ",", "3"}], "]"}], "]"}], "-", 
                RowBox[{"Round", "[", 
                 RowBox[{
                  RowBox[{"mesh", "[", 
                   RowBox[{"[", 
                    RowBox[{"i", ",", "3"}], "]"}], "]"}], "-", 
                  RowBox[{"matSiO2", "[", 
                   RowBox[{"[", 
                    RowBox[{"#", ",", "3"}], "]"}], "]"}]}], "]"}]}], "&"}], 
              ",", 
              RowBox[{"Range", "[", "Natom", "]"}]}], "]"}]}], ";", 
           "\[IndentingNewLine]", "                     ", 
           RowBox[{"dr", "=", 
            RowBox[{"Norm", "/@", 
             RowBox[{"(", 
              RowBox[{
               RowBox[{
                RowBox[{"{", 
                 RowBox[{"dx", ",", "dy", ",", "dz"}], "}"}], 
                "\[Transpose]"}], ".", "cell"}], ")"}]}]}], ";", 
           "\[IndentingNewLine]", "                     ", 
           RowBox[{"If", "[", 
            RowBox[{
             RowBox[{
              RowBox[{"bondOX", "-", "bondTol"}], "<", 
              RowBox[{"Min", "[", "dr", "]"}], "<", 
              RowBox[{"bondOX", "+", "bondTol"}]}], ",", 
             RowBox[{"AtomsNearby", "=", 
              RowBox[{"Append", "[", 
               RowBox[{"AtomsNearby", ",", 
                RowBox[{"mesh", "[", 
                 RowBox[{"[", "i", "]"}], "]"}]}], "]"}]}]}], "]"}], ";"}]}], 
         "\[IndentingNewLine]", "             ", "]"}], ";", 
        "\[IndentingNewLine]", "\[IndentingNewLine]", "              ", 
        RowBox[{"Print", "[", 
         RowBox[{
          RowBox[{
          "\"\<Number of nearby-sampling-point for \>\"", "<>", "ion", "<>", 
           "\"\< in \>\"", "<>", "strName", " ", "<>", "\"\<: \>\""}], ",", 
          RowBox[{"Length", "@", "AtomsNearby"}]}], "]"}], ";", 
        "\[IndentingNewLine]", "              ", 
        RowBox[{
         RowBox[{"mat", "[", 
          RowBox[{"[", "6", "]"}], "]"}], "=", 
         RowBox[{"Append", "[", 
          RowBox[{
           RowBox[{"mat", "[", 
            RowBox[{"[", "6", "]"}], "]"}], ",", "ion"}], "]"}]}], ";", 
        "\[IndentingNewLine]", "              ", 
        RowBox[{
         RowBox[{"mat", "[", 
          RowBox[{"[", "7", "]"}], "]"}], "=", 
         RowBox[{"Append", "[", 
          RowBox[{
           RowBox[{"mat", "[", 
            RowBox[{"[", "7", "]"}], "]"}], ",", 
           RowBox[{"ToString", "[", 
            RowBox[{"AtomsNearby", "//", "Length"}], "]"}]}], "]"}]}], ";", 
        "\[IndentingNewLine]", "              ", 
        RowBox[{"strNearbyAdsPt", "=", 
         RowBox[{"Join", "[", 
          RowBox[{"mat", ",", "AtomsNearby"}], "]"}]}], ";", 
        "\[IndentingNewLine]", "              ", 
        RowBox[{"Export", "[", 
         RowBox[{
          RowBox[{
          "path", "<>", "\"\</2_quick_GeoOpt/\>\"", "<>", "strName", "<>", 
           "\"\<_NearbySites.vasp\>\""}], ",", "strNearbyAdsPt", ",", 
          "\"\<Table\>\""}], "]"}], ";", "\[IndentingNewLine]", 
        "\[IndentingNewLine]", "              ", 
        RowBox[{"(*", 
         RowBox[{"--", 
          RowBox[{"--", 
           RowBox[{"--", 
            RowBox[{"--", 
             RowBox[{"--", 
              RowBox[{"--", 
               RowBox[{"--", 
                RowBox[{"--", 
                 RowBox[{"--", 
                  RowBox[{"--", 
                   RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{
                    "--", "--"}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]\
}]}]}]}], "*)"}], "\[IndentingNewLine]", "              ", 
        RowBox[{"uneqlAtoms", "=", "AtomsNearby"}], ";", 
        "\[IndentingNewLine]", "              ", 
        RowBox[{"For", "[", 
         RowBox[{
          RowBox[{"m", "=", "1"}], ",", 
          RowBox[{"m", "\[LessEqual]", 
           RowBox[{"Length", "@", "AtomsNearby"}]}], ",", 
          RowBox[{"m", "=", 
           RowBox[{"m", "+", "1"}]}], ",", "\[IndentingNewLine]", 
          "                   ", 
          RowBox[{
           RowBox[{"SymPoint", "=", 
            RowBox[{"symmetry", "[", 
             RowBox[{"folderPath", ",", "symGroupN", ",", 
              RowBox[{"AtomsNearby", "[", 
               RowBox[{"[", "m", "]"}], "]"}]}], "]"}]}], ";", 
           "\[IndentingNewLine]", "                   ", 
           RowBox[{"For", "[", 
            RowBox[{
             RowBox[{"n", "=", 
              RowBox[{"m", "+", "1"}]}], ",", 
             RowBox[{"n", "\[LessEqual]", 
              RowBox[{"Length", "@", "AtomsNearby"}]}], ",", 
             RowBox[{"n", "=", 
              RowBox[{"n", "+", "1"}]}], ",", "\[IndentingNewLine]", 
             "                         ", 
             RowBox[{
              RowBox[{"dxyz", "=", 
               RowBox[{"Map", "[", 
                RowBox[{
                 RowBox[{
                  RowBox[{
                   RowBox[{"SymPoint", "[", 
                    RowBox[{"[", "#", "]"}], "]"}], "-", 
                   RowBox[{"AtomsNearby", "[", 
                    RowBox[{"[", "n", "]"}], "]"}], "-", 
                   RowBox[{"Round", "[", 
                    RowBox[{
                    RowBox[{"SymPoint", "[", 
                    RowBox[{"[", "#", "]"}], "]"}], "-", 
                    RowBox[{"AtomsNearby", "[", 
                    RowBox[{"[", "n", "]"}], "]"}]}], "]"}]}], "&"}], ",", 
                 RowBox[{"Range", "[", 
                  RowBox[{"Length", "@", "SymPoint"}], "]"}]}], "]"}]}], ";", 
              "\[IndentingNewLine]", "                         ", 
              RowBox[{"dr1", "=", 
               RowBox[{"Norm", "/@", 
                RowBox[{"(", 
                 RowBox[{"dxyz", ".", "cell"}], ")"}]}]}], ";", 
              "\[IndentingNewLine]", "                         ", 
              RowBox[{"If", "[", 
               RowBox[{
                RowBox[{
                 RowBox[{"Min", "[", "dr1", "]"}], "<", "meshTol"}], ",", 
                RowBox[{"uneqlAtoms", "=", 
                 RowBox[{"DeleteCases", "[", 
                  RowBox[{"uneqlAtoms", ",", 
                   RowBox[{"AtomsNearby", "[", 
                    RowBox[{"[", "n", "]"}], "]"}]}], "]"}]}]}], "]"}]}]}], 
            "\[IndentingNewLine]", "                 ", "]"}], ";"}]}], 
         "\[IndentingNewLine]", "              ", "]"}], ";", 
        "\[IndentingNewLine]", "\[IndentingNewLine]", "              ", 
        RowBox[{"Print", "[", 
         RowBox[{
          RowBox[{
          "\"\<Number of inequivalent nearby-sampling-points for \>\"", "<>", 
           "ion", "<>", "\"\< in \>\"", "<>", "strName", "<>", "\"\<: \>\""}],
           ",", 
          RowBox[{"Length", "@", "uneqlAtoms"}]}], "]"}], ";", 
        "\[IndentingNewLine]", "              ", 
        RowBox[{
         RowBox[{"mat", "[", 
          RowBox[{"[", "7", "]"}], "]"}], "=", 
         RowBox[{"Append", "[", 
          RowBox[{
           RowBox[{"Drop", "[", 
            RowBox[{
             RowBox[{"mat", "[", 
              RowBox[{"[", "7", "]"}], "]"}], ",", 
             RowBox[{"-", "1"}]}], "]"}], ",", 
           RowBox[{"ToString", "[", 
            RowBox[{"uneqlAtoms", "//", "Length"}], "]"}]}], "]"}]}], ";", 
        "\[IndentingNewLine]", "              ", 
        RowBox[{"strUneqlAdsPt", "=", 
         RowBox[{"Join", "[", 
          RowBox[{"mat", ",", "uneqlAtoms"}], "]"}]}], ";", 
        "\[IndentingNewLine]", "              ", 
        RowBox[{"Export", "[", 
         RowBox[{
          RowBox[{
          "path", "<>", "\"\</2_quick_GeoOpt/\>\"", "<>", "strName", "<>", 
           "\"\<_uneqlSites.vasp\>\""}], ",", "strUneqlAdsPt", ",", 
          "\"\<Table\>\""}], "]"}], ";", "\[IndentingNewLine]", 
        "\[IndentingNewLine]", "              ", 
        RowBox[{"CreatePOSCAR", "[", 
         RowBox[{
         "folderPath", ",", "strName", ",", "ion", ",", "uneqlAtoms"}], 
         "]"}]}]}], "\[IndentingNewLine]", "              ", "]"}]}], 
    ";"}]}]}]], "Input",
 CellChangeTimes->{{3.947679036307638*^9, 3.9476791188234997`*^9}, {
   3.947688988071331*^9, 3.947688988562595*^9}, {3.947689888221299*^9, 
   3.94768990559306*^9}, {3.947695947138276*^9, 3.947695951166609*^9}, {
   3.947696190296404*^9, 3.947696225354743*^9}, {3.94769626270151*^9, 
   3.947696263567982*^9}, {3.947696360792206*^9, 3.947696361249254*^9}, {
   3.947696405816298*^9, 3.947696407013989*^9}, {3.947696461949855*^9, 
   3.947696462822411*^9}, {3.947710218849634*^9, 3.947710253765128*^9}, 
   3.947710332114843*^9, {3.947710485604385*^9, 3.947710494598824*^9}, {
   3.947710784924307*^9, 3.947710836788678*^9}, {3.947711665223059*^9, 
   3.947711684883877*^9}, {3.947711817551988*^9, 3.947711836235018*^9}, {
   3.947711951646996*^9, 3.94771195567671*^9}, {3.947712087612143*^9, 
   3.947712127055683*^9}, {3.94771231335176*^9, 3.947712332103193*^9}, {
   3.947712632716975*^9, 3.947712654072234*^9}, 3.947712957813955*^9, {
   3.94771304781351*^9, 3.94771305724232*^9}, 3.947713204451723*^9, 
   3.947713456689748*^9, {3.947713837542584*^9, 3.947713956603731*^9}, {
   3.947714030117358*^9, 3.947714033116843*^9}, {3.947714074394784*^9, 
   3.947714119017021*^9}, {3.94771500244707*^9, 3.947715027617408*^9}, {
   3.947715221840239*^9, 3.947715254060243*^9}, {3.947715439238385*^9, 
   3.947715563896994*^9}, {3.947732810505046*^9, 3.947732982874245*^9}, {
   3.9477330209707613`*^9, 3.947733110375216*^9}, {3.947741951913754*^9, 
   3.947741979115787*^9}, 3.947742058877756*^9, {3.947742321496491*^9, 
   3.947742326150421*^9}, {3.947742485334427*^9, 3.9477426240789137`*^9}, {
   3.947742708248726*^9, 3.947742731357345*^9}, {3.947742776131763*^9, 
   3.947742798761504*^9}, {3.947742862239575*^9, 3.947742935779456*^9}, {
   3.947752086548229*^9, 3.947752086751966*^9}, {3.947752464613103*^9, 
   3.947752487462288*^9}},
 CellLabel->"In[1]:=",ExpressionUUID->"10101d97-c54b-4c44-8ddf-90dadb59f522"]
}, Closed]],

Cell[CellGroupData[{

Cell[TextData[StyleBox["Step 4 in the paper",
 FontFamily->"Tahoma",
 FontSize->20,
 FontColor->RGBColor[0., 0.5098039215686274, 0.7490196078431373]]], "Section",
 CellChangeTimes->{
  3.861677451689701*^9, {3.861677484775999*^9, 3.8616775165810046`*^9}, {
   3.8616775642747974`*^9, 3.8616775644778476`*^9}, {3.861677623886115*^9, 
   3.861677637320485*^9}, 3.862536274595021*^9, 3.86486892230955*^9, {
   3.8648689583685627`*^9, 3.864869038748819*^9}, {3.864869299768076*^9, 
   3.864869300002394*^9}, {3.864870234042578*^9, 3.864870242706471*^9}, {
   3.8648723025226116`*^9, 3.864872303570187*^9}, {3.864872495529555*^9, 
   3.864872499096853*^9}, {3.864888177375281*^9, 3.864888182817638*^9}, {
   3.8680030147972336`*^9, 3.8680031168622985`*^9}, {3.868072087782483*^9, 
   3.868072089204934*^9}, {3.868151878254257*^9, 3.868151879504495*^9}, {
   3.868153174941499*^9, 3.868153208865707*^9}, {3.8684206928758388`*^9, 
   3.868420693112447*^9}, {3.946605349689148*^9, 3.946605353290177*^9}, {
   3.946605428714634*^9, 3.946605431511861*^9}, {3.9475909836644497`*^9, 
   3.947590985232304*^9}, {3.947655842487311*^9, 
   3.9476558452800217`*^9}},ExpressionUUID->"66f55196-31fa-4be5-96d0-\
d6e54c178936"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", 
   StyleBox[
    RowBox[{
    "Identify", " ", "inequivalent", " ", "sites", " ", "after", " ", "quick",
      " ", "DFT", " ", "calculations"}],
    FontColor->RGBColor[0, 0.501961, 0.752941]], "*)"}], 
  "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{
     RowBox[{"IneqSites", "[", 
      RowBox[{
      "folderPath_", ",", "strName_", ",", "ion_", ",", "symGroupN_", ",", 
       "eqlTol_", ",", "GeoOptDir_"}], "]"}], ":=", 
     RowBox[{"Module", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
        "DFTpath", ",", "atomsNearby", ",", "dirName", ",", "contcar", ",", 
         "posIon", ",", "cell", ",", "uneqlAtoms", ",", "i", ",", "SymPoint", 
         ",", "j", ",", "dxyz", ",", "dr", ",", "ChosenDFTs"}], "}"}], ",", 
       "\[IndentingNewLine]", "              ", 
       RowBox[{
        RowBox[{"DFTpath", "=", 
         RowBox[{
         "folderPath", "<>", "\"\</\>\"", "<>", "strName", "<>", "\"\<_\>\"", 
          "<>", "ion", "<>", "\"\</\>\"", "<>", "GeoOptDir"}]}], ";", 
        "\[IndentingNewLine]", "              ", 
        RowBox[{"SetDirectory", "[", "DFTpath", "]"}], ";", 
        "\[IndentingNewLine]", "\[IndentingNewLine]", "              ", 
        RowBox[{"dirName", "=", 
         RowBox[{"Sort", "[", 
          RowBox[{
           RowBox[{"Select", "[", 
            RowBox[{
             RowBox[{"FileNames", "[", "]"}], ",", "DirectoryQ"}], "]"}], "//",
            "ToExpression"}], "]"}]}], ";", "\[IndentingNewLine]", 
        "              ", 
        RowBox[{"contcar", "=", 
         RowBox[{"MyImport", "[", 
          RowBox[{
           RowBox[{"DFTpath", "<>", "\"\</1/CONTCAR\>\""}], ",", 
           "\"\<Table\>\""}], "]"}]}], ";", "\[IndentingNewLine]", 
        "              ", 
        RowBox[{"posIon", "=", 
         RowBox[{
          RowBox[{"Total", "[", 
           RowBox[{"contcar", "[", 
            RowBox[{"[", "7", "]"}], "]"}], "]"}], "+", 
          RowBox[{
           RowBox[{"Position", "[", 
            RowBox[{"contcar", ",", 
             RowBox[{"{", "\"\<Direct\>\"", "}"}]}], "]"}], "[", 
           RowBox[{"[", 
            RowBox[{"1", ",", "1"}], "]"}], "]"}]}]}], ";", 
        "\[IndentingNewLine]", "\[IndentingNewLine]", "              ", 
        RowBox[{"atomsNearby", "=", 
         RowBox[{"Map", "[", 
          RowBox[{
           RowBox[{
            RowBox[{"Part", "[", 
             RowBox[{
              RowBox[{
               RowBox[{"MyImport", "[", 
                RowBox[{
                 RowBox[{"DFTpath", "<>", "\"\</\>\"", "<>", 
                  RowBox[{"ToString", "[", 
                   RowBox[{"dirName", "[", 
                    RowBox[{"[", "#", "]"}], "]"}], "]"}], "<>", 
                  "\"\</CONTCAR\>\""}], ",", "\"\<Table\>\""}], "]"}], "[", 
               RowBox[{"[", "posIon", "]"}], "]"}], ",", 
              RowBox[{";;", "3"}]}], "]"}], "&"}], ",", 
           RowBox[{"Range", "[", 
            RowBox[{"Length", "@", "dirName"}], "]"}]}], "]"}]}], ";", 
        "\[IndentingNewLine]", "              ", 
        RowBox[{"cell", "=", 
         RowBox[{
          RowBox[{"contcar", "[", 
           RowBox[{"[", 
            RowBox[{"2", ",", "1"}], "]"}], "]"}], "*", 
          RowBox[{"contcar", "[", 
           RowBox[{"[", 
            RowBox[{
             RowBox[{"{", 
              RowBox[{"3", ",", "4", ",", "5"}], "}"}], ",", "All"}], "]"}], 
           "]"}]}]}], ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
        "              ", 
        RowBox[{"uneqlAtoms", "=", "atomsNearby"}], ";", 
        "\[IndentingNewLine]", "              ", 
        RowBox[{"For", "[", 
         RowBox[{
          RowBox[{"i", "=", "1"}], ",", 
          RowBox[{"i", "\[LessEqual]", 
           RowBox[{"Length", "@", "atomsNearby"}]}], ",", 
          RowBox[{"i", "=", 
           RowBox[{"i", "+", "1"}]}], ",", "\[IndentingNewLine]", 
          "                    ", 
          RowBox[{
           RowBox[{"SymPoint", "=", 
            RowBox[{"symmetry", "[", 
             RowBox[{"folderPath", ",", "symGroupN", ",", 
              RowBox[{"atomsNearby", "[", 
               RowBox[{"[", "i", "]"}], "]"}]}], "]"}]}], ";", 
           "\[IndentingNewLine]", "                    ", 
           RowBox[{"For", "[", 
            RowBox[{
             RowBox[{"j", "=", 
              RowBox[{"i", "+", "1"}]}], ",", 
             RowBox[{"j", "\[LessEqual]", 
              RowBox[{"Length", "@", "atomsNearby"}]}], ",", 
             RowBox[{"j", "=", 
              RowBox[{"j", "+", "1"}]}], ",", "\[IndentingNewLine]", 
             "                           ", 
             RowBox[{
              RowBox[{"dxyz", "=", 
               RowBox[{"Map", "[", 
                RowBox[{
                 RowBox[{
                  RowBox[{
                   RowBox[{"SymPoint", "[", 
                    RowBox[{"[", "#", "]"}], "]"}], "-", 
                   RowBox[{"atomsNearby", "[", 
                    RowBox[{"[", "j", "]"}], "]"}], "-", 
                   RowBox[{"Round", "[", 
                    RowBox[{
                    RowBox[{"SymPoint", "[", 
                    RowBox[{"[", "#", "]"}], "]"}], "-", 
                    RowBox[{"atomsNearby", "[", 
                    RowBox[{"[", "j", "]"}], "]"}]}], "]"}]}], "&"}], ",", 
                 RowBox[{"Range", "[", 
                  RowBox[{"Length", "@", "SymPoint"}], "]"}]}], "]"}]}], ";", 
              "\[IndentingNewLine]", "                           ", 
              RowBox[{"dr", "=", 
               RowBox[{"Norm", "/@", 
                RowBox[{"(", 
                 RowBox[{"dxyz", ".", "cell"}], ")"}]}]}], ";", 
              "\[IndentingNewLine]", "                           ", 
              RowBox[{"If", "[", 
               RowBox[{
                RowBox[{
                 RowBox[{"Min", "[", "dr", "]"}], "<", "eqlTol"}], ",", 
                RowBox[{"uneqlAtoms", "=", 
                 RowBox[{"DeleteCases", "[", 
                  RowBox[{"uneqlAtoms", ",", 
                   RowBox[{"atomsNearby", "[", 
                    RowBox[{"[", "j", "]"}], "]"}]}], "]"}]}]}], "]"}]}]}], 
            "\[IndentingNewLine]", "                    ", "]"}], ";"}]}], 
         "\[IndentingNewLine]", "               ", "]"}], ";", 
        "\[IndentingNewLine]", "\[IndentingNewLine]", "              ", 
        RowBox[{"ChosenDFTs", "=", 
         RowBox[{
          RowBox[{"Map", "[", 
           RowBox[{
            RowBox[{
             RowBox[{"Position", "[", 
              RowBox[{"atomsNearby", ",", 
               RowBox[{"uneqlAtoms", "[", 
                RowBox[{"[", "#", "]"}], "]"}]}], "]"}], "&"}], ",", 
            RowBox[{"Range", "[", 
             RowBox[{"Length", "@", "uneqlAtoms"}], "]"}]}], "]"}], "//", 
          "Flatten"}]}], ";", "\[IndentingNewLine]", "              ", 
        RowBox[{"Print", "[", 
         RowBox[{
          RowBox[{"Length", "@", "uneqlAtoms"}], ",", 
          "\"\< inequivalent sites after DFT optimization.\>\""}], "]"}], ";",
         "\[IndentingNewLine]", "\[IndentingNewLine]", "              ", 
        RowBox[{"Export", "[", 
         RowBox[{
          RowBox[{"DFTpath", "<>", "\"\</CONTCAR_IneqSites\>\""}], ",", 
          "uneqlAtoms", ",", "\"\<Table\>\""}], "]"}], " ", ";", 
        "\[IndentingNewLine]", "              ", "ChosenDFTs"}]}], 
      "\[IndentingNewLine]", "              ", "]"}]}], ";"}], 
   "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{"(*", 
    StyleBox[
     RowBox[{
     "Copy", " ", "chosen", " ", "quick", " ", "DFT", " ", "results", " ", 
      "for", " ", "normal", " ", "DFT", " ", "calculations"}],
     FontColor->RGBColor[0, 0.501961, 0.752941]], "*)"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"delete", "[", "]"}], ":=", 
     RowBox[{"Do", "[", 
      RowBox[{
       RowBox[{"Quiet", "@", 
        RowBox[{"DeleteFile", "[", "i", "]"}]}], ",", 
       RowBox[{"{", 
        RowBox[{"i", ",", 
         RowBox[{"{", 
          RowBox[{
          "\"\<OUTCAR\>\"", ",", "\"\<OSZICAR\>\"", ",", "\"\<DOSCAR\>\"", 
           ",", "\"\<IBZKPT\>\"", ",", "\"\<EIGENVAL\>\"", ",", 
           "\"\<REPORT\>\"", ",", "\"\<log\>\"", ",", "\"\<XDATCAR\>\"", ",", 
           "\"\<PCDAT\>\""}], "}"}]}], "}"}]}], "]"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"CopyEdit", "[", 
      RowBox[{
      "folderPath_", ",", "strName_", ",", "ion_", ",", "ChosenDFTs_"}], 
      "]"}], ":=", 
     RowBox[{"Module", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"qDFTpath", ",", "nDFTpath", ",", "i", ",", "poscar"}], "}"}],
        ",", "\[IndentingNewLine]", "              ", 
       RowBox[{
        RowBox[{"qDFTpath", "=", 
         RowBox[{
         "folderPath", "<>", "\"\</\>\"", "<>", "strName", "<>", "\"\<_\>\"", 
          "<>", "ion", "<>", "\"\</2_quick_GeoOpt\>\""}]}], ";", 
        "\[IndentingNewLine]", "              ", 
        RowBox[{"nDFTpath", "=", 
         RowBox[{
         "folderPath", "<>", "\"\</\>\"", "<>", "strName", "<>", "\"\<_\>\"", 
          "<>", "ion", "<>", "\"\</3_normal_GeoOpt\>\""}]}], ";", 
        "\[IndentingNewLine]", "              ", 
        RowBox[{"Map", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"(", 
            RowBox[{
             RowBox[{"CopyDirectory", "[", 
              RowBox[{
               RowBox[{"qDFTpath", "<>", "\"\</\>\"", "<>", 
                RowBox[{"ToString", "[", "#", "]"}]}], ",", 
               RowBox[{"nDFTpath", "<>", "\"\</\>\"", "<>", 
                RowBox[{"ToString", "[", "#", "]"}]}]}], "]"}], ";", 
             RowBox[{"SetDirectory", "[", 
              RowBox[{"nDFTpath", "<>", "\"\</\>\"", "<>", 
               RowBox[{"ToString", "[", "#", "]"}]}], "]"}], ";", 
             RowBox[{"delete", "[", "]"}]}], ")"}], "&"}], ",", 
          "ChosenDFTs"}], "]"}], ";", "\[IndentingNewLine]", 
        "\[IndentingNewLine]", "              ", 
        RowBox[{"For", " ", "[", 
         RowBox[{
          RowBox[{"i", "=", "1"}], ",", 
          RowBox[{"i", "\[LessEqual]", 
           RowBox[{"Length", "@", "ChosenDFTs"}]}], ",", 
          RowBox[{"i", "=", 
           RowBox[{"i", "+", "1"}]}], ",", "\[IndentingNewLine]", 
          "                     ", 
          RowBox[{
           RowBox[{"MyRename", "[", 
            RowBox[{
             RowBox[{"nDFTpath", "<>", "\"\</\>\"", "<>", 
              RowBox[{"ToString", "[", 
               RowBox[{"ChosenDFTs", "[", 
                RowBox[{"[", "i", "]"}], "]"}], "]"}], "<>", 
              "\"\</CONTCAR\>\""}], ",", 
             RowBox[{"nDFTpath", "<>", "\"\</\>\"", "<>", 
              RowBox[{"ToString", "[", 
               RowBox[{"ChosenDFTs", "[", 
                RowBox[{"[", "i", "]"}], "]"}], "]"}], "<>", 
              "\"\</CONTCAR_old\>\""}]}], "]"}], ";", "\[IndentingNewLine]", 
           "                     ", 
           RowBox[{"poscar", "=", 
            RowBox[{"MyImport", "[", 
             RowBox[{
              RowBox[{"nDFTpath", "<>", "\"\</\>\"", "<>", 
               RowBox[{"ToString", "[", 
                RowBox[{"ChosenDFTs", "[", 
                 RowBox[{"[", "i", "]"}], "]"}], "]"}], "<>", 
               "\"\</CONTCAR_old\>\""}], ",", "\"\<Table\>\""}], "]"}]}], ";",
            "\[IndentingNewLine]", "                     ", 
           RowBox[{"poscar", "=", 
            RowBox[{"DeleteCases", "[", 
             RowBox[{"poscar", ",", 
              RowBox[{"{", 
               RowBox[{"\"\<Selective\>\"", ",", "\"\<dynamics\>\""}], 
               "}"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
           "                     ", 
           RowBox[{
            RowBox[{"Export", "[", 
             RowBox[{
              RowBox[{"nDFTpath", "<>", "\"\</\>\"", "<>", 
               RowBox[{"ToString", "[", 
                RowBox[{"ChosenDFTs", "[", 
                 RowBox[{"[", "i", "]"}], "]"}], "]"}], "<>", 
               "\"\</POSCAR\>\""}], ",", "poscar", ",", "\"\<Table\>\""}], 
             "]"}], "//", "Print"}]}]}], "\[IndentingNewLine]", 
         "              ", "]"}]}]}], "\[IndentingNewLine]", "              ",
       "]"}]}], ";"}], "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"Step3POSCARs", "[", 
      RowBox[{
      "folderPath_", ",", "strName_", ",", "ion_", ",", "symGroupN_", ",", 
       "eqlTol_", ",", "GeoOptDir_"}], "]"}], ":=", 
     RowBox[{"Module", "[", 
      RowBox[{
       RowBox[{"{", "ChosenDFTs", "}"}], ",", "\[IndentingNewLine]", 
       "              ", 
       RowBox[{
        RowBox[{"ChosenDFTs", "=", 
         RowBox[{"IneqSites", "[", 
          RowBox[{
          "folderPath", ",", "strName", ",", "ion", ",", "symGroupN", ",", 
           "eqlTol", ",", "GeoOptDir"}], "]"}]}], ";", "\[IndentingNewLine]", 
        "              ", 
        RowBox[{"CopyEdit", "[", 
         RowBox[{
         "folderPath", ",", "strName", ",", "ion", ",", "ChosenDFTs"}], "]"}],
         ";"}]}], "\[IndentingNewLine]", "              ", "]"}]}], 
    ";"}]}]}]], "Input",
 CellChangeTimes->{{3.9476792139490147`*^9, 3.947679248681343*^9}, {
   3.947679339420692*^9, 3.947679356422059*^9}, {3.947679412052403*^9, 
   3.947679412542279*^9}, {3.947696178130413*^9, 3.947696182566308*^9}, {
   3.947696269347978*^9, 3.947696269854533*^9}, {3.947710611971679*^9, 
   3.947710611978911*^9}, {3.947710845295392*^9, 3.947710858571854*^9}, {
   3.9477117535072145`*^9, 3.947711766274909*^9}, {3.94771430786478*^9, 
   3.947714336752573*^9}, {3.947714401314907*^9, 3.947714411009835*^9}, 
   3.947714441984848*^9, 3.947714474295849*^9, {3.947714507056476*^9, 
   3.94771457718589*^9}, {3.947714638299158*^9, 3.947714648804731*^9}, {
   3.947714825642737*^9, 3.9477149525060086`*^9}, {3.94771499236346*^9, 
   3.947714998621183*^9}, {3.947715054647198*^9, 3.947715061247978*^9}, {
   3.9477151430699453`*^9, 3.947715143489571*^9}, {3.947715416876973*^9, 
   3.9477154172214413`*^9}, 3.947715581608899*^9, {3.947752100546658*^9, 
   3.9477521008522253`*^9}, {3.9477616564831676`*^9, 3.9477618761540337`*^9}, 
   3.947762050178135*^9, {3.9477623662159977`*^9, 3.947762367529965*^9}, {
   3.94776246822711*^9, 3.947762469105389*^9}, {3.9477625146897173`*^9, 
   3.94776251797174*^9}, {3.947763027606537*^9, 3.9477630304994802`*^9}, {
   3.9477630756309767`*^9, 3.947763077368094*^9}},
 CellLabel->"In[10]:=",ExpressionUUID->"df2e0752-035e-4f15-8b65-f5ff9acdb406"]
}, Closed]],

Cell[CellGroupData[{

Cell[TextData[StyleBox["Step 5 in the paper",
 FontFamily->"Tahoma",
 FontSize->20,
 FontColor->RGBColor[0., 0.5098039215686274, 0.7490196078431373]]], "Section",
 CellChangeTimes->{
  3.861677451689701*^9, {3.861677484775999*^9, 3.8616775165810046`*^9}, {
   3.8616775642747974`*^9, 3.8616775644778476`*^9}, {3.861677623886115*^9, 
   3.861677637320485*^9}, 3.862536274595021*^9, 3.8648689223095503`*^9, {
   3.8648689583685627`*^9, 3.864869038748819*^9}, {3.864869299768076*^9, 
   3.864869300002394*^9}, {3.864870234042578*^9, 3.864870242706471*^9}, {
   3.8648723025226116`*^9, 3.864872303570187*^9}, {3.864872495529555*^9, 
   3.864872499096853*^9}, {3.864888177375281*^9, 3.864888182817638*^9}, {
   3.8680030147972336`*^9, 3.8680031168622985`*^9}, {3.868072087782483*^9, 
   3.868072089204934*^9}, {3.868151878254257*^9, 3.868151879504495*^9}, {
   3.868153174941499*^9, 3.868153208865707*^9}, {3.8684206928758388`*^9, 
   3.868420693112447*^9}, {3.8684316846841288`*^9, 3.868431684952415*^9}, {
   3.946605438000347*^9, 3.9466054406119986`*^9}, 3.946606407022202*^9, {
   3.947590988206456*^9, 3.947590989962858*^9}, {3.947678857546352*^9, 
   3.947678860183939*^9}},ExpressionUUID->"dca36987-43ff-4a2d-98af-\
1c5bbf2a3d89"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", 
   StyleBox[
    RowBox[{
    "Remove", " ", "equivalent", " ", "coordinates", " ", "under", " ", 
     "periodic", " ", "boundary", " ", "conditions"}],
    FontColor->RGBColor[0, 0.501961, 0.752941]], "*)"}], 
  "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{
     RowBox[{"woPerXYZ", "[", "xyz_", "]"}], ":=", 
     RowBox[{"Module", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"xyz0", ",", 
         RowBox[{"xyzWOper", "=", 
          RowBox[{"{", "}"}]}], ",", "i", ",", "perxyz1", ",", "perxyz2", ",",
          "perxyz", ",", "xyzexcludei", ",", "l"}], "}"}], ",", 
       "\[IndentingNewLine]", "              ", 
       RowBox[{
        RowBox[{"xyz0", "=", 
         RowBox[{"xyz", "//", "DeleteDuplicates"}]}], ";", 
        "\[IndentingNewLine]", "              ", 
        RowBox[{"For", "[", 
         RowBox[{
          RowBox[{"i", "=", "1"}], ",", 
          RowBox[{"i", "\[LessEqual]", 
           RowBox[{"Length", "@", "xyz0"}]}], ",", 
          RowBox[{"i", "=", 
           RowBox[{"i", "+", "1"}]}], ",", "\[IndentingNewLine]", 
          "                     ", 
          RowBox[{
           RowBox[{"perxyz1", "=", 
            RowBox[{"Tuples", "[", 
             RowBox[{"Map", "[", 
              RowBox[{
               RowBox[{
                RowBox[{
                 RowBox[{"xyz0", "[", 
                  RowBox[{"[", 
                   RowBox[{"i", ",", "#"}], "]"}], "]"}], "+", 
                 RowBox[{"{", 
                  RowBox[{"0", ",", "1", ",", 
                   RowBox[{"-", "1"}]}], "}"}]}], "&"}], ",", 
               RowBox[{"{", 
                RowBox[{"1", ",", "2", ",", "3"}], "}"}]}], "]"}], "]"}]}], 
           ";", "\[IndentingNewLine]", "                     ", 
           RowBox[{"perxyz2", "=", 
            RowBox[{"Tuples", "[", 
             RowBox[{"Map", "[", 
              RowBox[{
               RowBox[{
                RowBox[{
                 RowBox[{"xyz0", "[", 
                  RowBox[{"[", 
                   RowBox[{"i", ",", "#"}], "]"}], "]"}], "+", 
                 RowBox[{"{", 
                  RowBox[{"0", ",", "2", ",", 
                   RowBox[{"-", "2"}]}], "}"}]}], "&"}], ",", 
               RowBox[{"{", 
                RowBox[{"1", ",", "2", ",", "3"}], "}"}]}], "]"}], "]"}]}], 
           ";", "\[IndentingNewLine]", "                     ", 
           RowBox[{"perxyz", "=", 
            RowBox[{"Join", "[", 
             RowBox[{"perxyz1", ",", "perxyz2"}], "]"}]}], ";", 
           RowBox[{"(*", 
            RowBox[{"all", " ", "period", " ", "points"}], "*)"}], 
           "\[IndentingNewLine]", "                     ", 
           RowBox[{"xyzexcludei", "=", 
            RowBox[{"Take", "[", 
             RowBox[{"xyz0", ",", 
              RowBox[{"{", 
               RowBox[{
                RowBox[{"i", "+", "1"}], ",", 
                RowBox[{"-", "1"}]}], "}"}]}], "]"}]}], ";", 
           "\[IndentingNewLine]", "                     ", 
           RowBox[{"l", "=", 
            RowBox[{
             RowBox[{
              RowBox[{"Round", "[", 
               RowBox[{"perxyz", ",", "0.01"}], "]"}], "\[Intersection]", 
              RowBox[{"Round", "[", 
               RowBox[{"xyzexcludei", ",", "0.01"}], "]"}]}], "//", 
             "Length"}]}], ";", 
           RowBox[{"(*", " ", 
            RowBox[{
            "periodic", " ", "points", " ", "of", " ", "i", " ", "compare", 
             " ", "with", " ", "xyz0", " ", "after", " ", "i"}], "*)"}], 
           "\[IndentingNewLine]", "                     ", 
           RowBox[{"If", "[", 
            RowBox[{
             RowBox[{"l", "==", "0"}], ",", 
             RowBox[{"xyzWOper", "=", 
              RowBox[{"Append", "[", 
               RowBox[{"xyzWOper", ",", 
                RowBox[{"xyz0", "[", 
                 RowBox[{"[", "i", "]"}], "]"}]}], "]"}]}]}], "]"}], ";"}]}], 
         "\[IndentingNewLine]", "              ", "]"}], ";", 
        "\[IndentingNewLine]", "              ", "xyzWOper"}]}], 
      "\[IndentingNewLine]", "              ", "]"}]}], ";"}], 
   "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{
     StyleBox["Impose",
      FontColor->RGBColor[0, 0.501961, 0.752941]], 
     StyleBox[" ",
      FontColor->RGBColor[0, 0.501961, 0.752941]], 
     StyleBox["periodicity",
      FontColor->RGBColor[0, 0.501961, 0.752941]], 
     StyleBox[" ",
      FontColor->RGBColor[0, 0.501961, 0.752941]], 
     StyleBox["to",
      FontColor->RGBColor[0, 0.501961, 0.752941]], 
     StyleBox[" ",
      FontColor->RGBColor[0, 0.501961, 0.752941]], "coordinations"}], "*)"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"periodPoints", "[", "pointsList_", "]"}], ":=", 
     RowBox[{"Module", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
         RowBox[{"PeriodPoints", "=", 
          RowBox[{"{", "}"}]}], ",", "i", ",", "periodi1", ",", "periodi2", 
         ",", "periodi"}], "}"}], ",", "\[IndentingNewLine]", 
       "              ", 
       RowBox[{
        RowBox[{"For", " ", "[", 
         RowBox[{
          RowBox[{"i", "=", "1"}], ",", 
          RowBox[{"i", "\[LessEqual]", 
           RowBox[{"Length", "@", "pointsList"}]}], ",", 
          RowBox[{"i", "=", 
           RowBox[{"i", "+", "1"}]}], ",", "\[IndentingNewLine]", 
          "                     ", 
          RowBox[{
           RowBox[{"periodi1", "=", 
            RowBox[{"Tuples", "[", 
             RowBox[{"Map", "[", 
              RowBox[{
               RowBox[{
                RowBox[{
                 RowBox[{"pointsList", "[", 
                  RowBox[{"[", 
                   RowBox[{"i", ",", "#"}], "]"}], "]"}], "+", 
                 RowBox[{"{", 
                  RowBox[{"0", ",", "1", ",", 
                   RowBox[{"-", "1"}]}], "}"}]}], "&"}], ",", 
               RowBox[{"{", 
                RowBox[{"1", ",", "2", ",", "3"}], "}"}]}], "]"}], "]"}]}], 
           ";", "\[IndentingNewLine]", "                     ", 
           RowBox[{"periodi2", "=", 
            RowBox[{"Tuples", "[", 
             RowBox[{"Map", "[", 
              RowBox[{
               RowBox[{
                RowBox[{
                 RowBox[{"pointsList", "[", 
                  RowBox[{"[", 
                   RowBox[{"i", ",", "#"}], "]"}], "]"}], "+", 
                 RowBox[{"{", 
                  RowBox[{"0", ",", "2", ",", 
                   RowBox[{"-", "2"}]}], "}"}]}], "&"}], ",", 
               RowBox[{"{", 
                RowBox[{"1", ",", "2", ",", "3"}], "}"}]}], "]"}], "]"}]}], 
           ";", "\[IndentingNewLine]", "                     ", 
           RowBox[{"periodi", "=", 
            RowBox[{"Join", "[", 
             RowBox[{"periodi1", ",", "periodi2"}], "]"}]}], ";", 
           RowBox[{"(*", 
            RowBox[{"add", " ", "two", " ", "periodicity"}], "*)"}], 
           "\[IndentingNewLine]", "                     ", 
           RowBox[{"PeriodPoints", "=", 
            RowBox[{"Append", "[", 
             RowBox[{"PeriodPoints", ",", "periodi"}], "]"}]}]}]}], 
         "\[IndentingNewLine]", "              ", "]"}], ";", 
        "\[IndentingNewLine]", "              ", 
        RowBox[{"Flatten", "[", 
         RowBox[{"PeriodPoints", ",", "1"}], "]"}]}]}], "\[IndentingNewLine]",
       "              ", "]"}]}], ";"}], "\[IndentingNewLine]", 
   "\[IndentingNewLine]", 
   RowBox[{"(*", 
    StyleBox[
     RowBox[{
      RowBox[{"Generate", " ", "non"}], "-", 
      RowBox[{"substitutable", " ", "or", " ", "basic", " ", "paths"}]}],
     FontColor->RGBColor[0, 0.501961, 0.752941]], "*)"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"exclSubst", "[", 
      RowBox[{"folderPath_", ",", "strName_", ",", "ion_", ",", "IFxyz_"}], 
      "]"}], ":=", 
     RowBox[{"Module", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"mat", ",", "cell", ",", "nDFTpath", ",", 
         RowBox[{"BasicIFxyz", "=", 
          RowBox[{"{", "}"}]}], ",", "i", ",", "ABxyz", ",", "dxyzAB", ",", 
         "drAB", ",", "aID", ",", "bID", ",", "c1ID", ",", "d1ID", ",", 
         "c2ID", ",", "d2ID", ",", "c3ID", ",", "d3ID", ",", "e1ID", ",", 
         "e2ID", ",", "e3ID", ",", "drAE1E1B", ",", "nrowAE1ID", ",", 
         "nrowE1BID", ",", "AE1xyz", ",", "E1Bxyz", ",", "dxyzAE1", ",", 
         "dxyzE1B", ",", "drAE1", ",", "drE1B", ",", "drAE2E2B", ",", 
         "nrowAE2ID", ",", "nrowE2BID", ",", "AE2xyz", ",", "E2Bxyz", ",", 
         "dxyzAE2", ",", "dxyzE2B", ",", "drAE2", ",", "drE2B", ",", 
         "drAE3E3B", ",", "nrowAE3ID", ",", "nrowE3BID", ",", "AE3xyz", ",", 
         "E3Bxyz", ",", "dxyzAE3", ",", "dxyzE3B", ",", "drAE3", ",", "drE3B",
          ",", "drAEEB"}], "}"}], ",", "\[IndentingNewLine]", 
       "\[IndentingNewLine]", "              ", 
       RowBox[{
        RowBox[{"mat", "=", 
         RowBox[{"MyImport", "[", 
          RowBox[{
           RowBox[{
           "folderPath", "<>", "\"\</\>\"", "<>", "strName", "<>", 
            "\"\<_\>\"", "<>", "ion", "<>", 
            "\"\</1_zeolite_GeoOpt/CONTCAR\>\""}], ",", "\"\<Table\>\""}], 
          "]"}]}], ";", "\[IndentingNewLine]", "              ", 
        RowBox[{"cell", "=", 
         RowBox[{
          RowBox[{"mat", "[", 
           RowBox[{"[", 
            RowBox[{"2", ",", "1"}], "]"}], "]"}], "*", 
          RowBox[{"mat", "[", 
           RowBox[{"[", 
            RowBox[{
             RowBox[{"{", 
              RowBox[{"3", ",", "4", ",", "5"}], "}"}], ",", "All"}], "]"}], 
           "]"}]}]}], ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
        "              ", 
        RowBox[{"For", "[", 
         RowBox[{
          RowBox[{"i", "=", "1"}], ",", 
          RowBox[{"i", "\[LessEqual]", 
           RowBox[{"Length", "@", "IFxyz"}]}], ",", 
          RowBox[{"i", "=", 
           RowBox[{"i", "+", "1"}]}], ",", "\[IndentingNewLine]", 
          "              ", 
          RowBox[{
           RowBox[{"ABxyz", "=", 
            RowBox[{"IFxyz", "[", 
             RowBox[{"[", 
              RowBox[{"i", ",", 
               RowBox[{"{", 
                RowBox[{"3", ",", "4"}], "}"}]}], "]"}], "]"}]}], ";", 
           "\[IndentingNewLine]", "              ", 
           RowBox[{"dxyzAB", "=", 
            RowBox[{
             RowBox[{"ABxyz", "[", 
              RowBox[{"[", "1", "]"}], "]"}], "-", 
             RowBox[{"ABxyz", "[", 
              RowBox[{"[", "2", "]"}], "]"}], "-", 
             RowBox[{"Round", "[", 
              RowBox[{
               RowBox[{"ABxyz", "[", 
                RowBox[{"[", "1", "]"}], "]"}], "-", 
               RowBox[{"ABxyz", "[", 
                RowBox[{"[", "2", "]"}], "]"}]}], "]"}]}]}], ";", 
           "\[IndentingNewLine]", "              ", 
           RowBox[{"drAB", "=", 
            RowBox[{"Norm", "[", 
             RowBox[{"dxyzAB", ".", "cell"}], "]"}]}], ";", 
           "\[IndentingNewLine]", "              ", 
           RowBox[{"aID", "=", 
            RowBox[{"IFxyz", "[", 
             RowBox[{"[", 
              RowBox[{"i", ",", "1"}], "]"}], "]"}]}], ";", 
           "\[IndentingNewLine]", "              ", 
           RowBox[{"bID", "=", 
            RowBox[{"IFxyz", "[", 
             RowBox[{"[", 
              RowBox[{"i", ",", "2"}], "]"}], "]"}]}], ";", 
           "\[IndentingNewLine]", "\[IndentingNewLine]", "              ", 
           RowBox[{"c1ID", "=", 
            RowBox[{
             RowBox[{"Select", "[", 
              RowBox[{"IFxyz", ",", 
               RowBox[{
                RowBox[{
                 RowBox[{"#", "[", 
                  RowBox[{"[", "1", "]"}], "]"}], "==", "aID"}], "&"}]}], 
              "]"}], "[", 
             RowBox[{"[", 
              RowBox[{"All", ",", "2"}], "]"}], "]"}]}], ";", 
           "\[IndentingNewLine]", "              ", 
           RowBox[{"c2ID", "=", 
            RowBox[{
             RowBox[{"Select", "[", 
              RowBox[{"IFxyz", ",", 
               RowBox[{
                RowBox[{
                 RowBox[{"#", "[", 
                  RowBox[{"[", "1", "]"}], "]"}], "==", "aID"}], "&"}]}], 
              "]"}], "[", 
             RowBox[{"[", 
              RowBox[{"All", ",", "2"}], "]"}], "]"}]}], ";", 
           "\[IndentingNewLine]", "              ", 
           RowBox[{"c3ID", "=", 
            RowBox[{
             RowBox[{"Select", "[", 
              RowBox[{"IFxyz", ",", 
               RowBox[{
                RowBox[{
                 RowBox[{"#", "[", 
                  RowBox[{"[", "2", "]"}], "]"}], "==", "aID"}], "&"}]}], 
              "]"}], "[", 
             RowBox[{"[", 
              RowBox[{"All", ",", "1"}], "]"}], "]"}]}], ";", 
           "\[IndentingNewLine]", "\[IndentingNewLine]", "              ", 
           RowBox[{"d1ID", "=", 
            RowBox[{
             RowBox[{"Select", "[", 
              RowBox[{"IFxyz", ",", 
               RowBox[{
                RowBox[{
                 RowBox[{"#", "[", 
                  RowBox[{"[", "2", "]"}], "]"}], "==", "bID"}], "&"}]}], 
              "]"}], "[", 
             RowBox[{"[", 
              RowBox[{"All", ",", "1"}], "]"}], "]"}]}], ";", 
           "\[IndentingNewLine]", "              ", 
           RowBox[{"d3ID", "=", 
            RowBox[{
             RowBox[{"Select", "[", 
              RowBox[{"IFxyz", ",", 
               RowBox[{
                RowBox[{
                 RowBox[{"#", "[", 
                  RowBox[{"[", "2", "]"}], "]"}], "==", "bID"}], "&"}]}], 
              "]"}], "[", 
             RowBox[{"[", 
              RowBox[{"All", ",", "1"}], "]"}], "]"}]}], ";", 
           "\[IndentingNewLine]", "              ", 
           RowBox[{"d2ID", "=", 
            RowBox[{
             RowBox[{"Select", "[", 
              RowBox[{"IFxyz", ",", 
               RowBox[{
                RowBox[{
                 RowBox[{"#", "[", 
                  RowBox[{"[", "1", "]"}], "]"}], "==", "bID"}], "&"}]}], 
              "]"}], "[", 
             RowBox[{"[", 
              RowBox[{"All", ",", "2"}], "]"}], "]"}]}], ";", 
           "\[IndentingNewLine]", "\[IndentingNewLine]", "              ", 
           RowBox[{"e1ID", "=", 
            RowBox[{"c1ID", "\[Intersection]", "d1ID"}]}], ";", 
           RowBox[{"e2ID", "=", 
            RowBox[{"c2ID", "\[Intersection]", "d2ID"}]}], ";", 
           RowBox[{"e3ID", "=", 
            RowBox[{"c3ID", "\[Intersection]", "d3ID"}]}], ";", 
           RowBox[{"(*", 
            RowBox[{
             RowBox[{"Print", "[", 
              RowBox[{
               RowBox[{"Length", "@", "eID"}], ",", "eID"}], "]"}], ";"}], 
            "*)"}], "\[IndentingNewLine]", "              ", 
           RowBox[{"If", "[", 
            RowBox[{
             RowBox[{
              RowBox[{
               RowBox[{"Length", "@", "e1ID"}], "==", "0"}], "&&", 
              RowBox[{
               RowBox[{"Length", "@", "e2ID"}], "==", "0"}], "&&", 
              RowBox[{
               RowBox[{"Length", "@", "e3ID"}], "==", "0"}]}], ",", 
             RowBox[{
              RowBox[{"BasicIFxyz", "=", 
               RowBox[{"Append", "[", 
                RowBox[{"BasicIFxyz", ",", 
                 RowBox[{"IFxyz", "[", 
                  RowBox[{"[", "i", "]"}], "]"}]}], "]"}]}], ";", "Abort"}], 
             ",", "\[IndentingNewLine]", "              ", 
             RowBox[{
              RowBox[{"If", "[", 
               RowBox[{
                RowBox[{
                 RowBox[{"Length", "@", "e1ID"}], "==", "0"}], ",", 
                RowBox[{"drAE1E1B", "=", 
                 RowBox[{"{", "}"}]}], ",", "\[IndentingNewLine]", 
                "              ", 
                RowBox[{
                 RowBox[{"nrowAE1ID", "=", 
                  RowBox[{
                   RowBox[{"Map", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"Position", "[", 
                    RowBox[{
                    RowBox[{"IFxyz", "[", 
                    RowBox[{"[", 
                    RowBox[{"All", ",", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", "2"}], "}"}]}], "]"}], "]"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"aID", ",", 
                    RowBox[{"e1ID", "[", 
                    RowBox[{"[", "#", "]"}], "]"}]}], "}"}]}], "]"}], "&"}], 
                    ",", 
                    RowBox[{"Range", "[", 
                    RowBox[{"Length", "@", "e1ID"}], "]"}]}], "]"}], "//", 
                   "Flatten"}]}], ";", "\[IndentingNewLine]", 
                 "              ", 
                 RowBox[{"nrowE1BID", "=", 
                  RowBox[{
                   RowBox[{"Map", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"Position", "[", 
                    RowBox[{
                    RowBox[{"IFxyz", "[", 
                    RowBox[{"[", 
                    RowBox[{"All", ",", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", "2"}], "}"}]}], "]"}], "]"}], ",", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"e1ID", "[", 
                    RowBox[{"[", "#", "]"}], "]"}], ",", "bID"}], "}"}]}], 
                    "]"}], "&"}], ",", 
                    RowBox[{"Range", "[", 
                    RowBox[{"Length", "@", "e1ID"}], "]"}]}], "]"}], "//", 
                   "Flatten"}]}], ";", "\[IndentingNewLine]", 
                 "              ", 
                 RowBox[{"AE1xyz", "=", 
                  RowBox[{"Map", "[", 
                   RowBox[{
                    RowBox[{
                    RowBox[{"IFxyz", "[", 
                    RowBox[{"[", 
                    RowBox[{
                    RowBox[{"nrowAE1ID", "[", 
                    RowBox[{"[", "#", "]"}], "]"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"3", ",", "4"}], "}"}]}], "]"}], "]"}], "&"}], 
                    ",", 
                    RowBox[{"Range", "[", 
                    RowBox[{"Length", "@", "nrowAE1ID"}], "]"}]}], "]"}]}], 
                 ";", "\[IndentingNewLine]", "              ", 
                 RowBox[{"E1Bxyz", "=", 
                  RowBox[{"Map", "[", 
                   RowBox[{
                    RowBox[{
                    RowBox[{"IFxyz", "[", 
                    RowBox[{"[", 
                    RowBox[{
                    RowBox[{"nrowE1BID", "[", 
                    RowBox[{"[", "#", "]"}], "]"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"3", ",", "4"}], "}"}]}], "]"}], "]"}], "&"}], 
                    ",", 
                    RowBox[{"Range", "[", 
                    RowBox[{"Length", "@", "nrowE1BID"}], "]"}]}], "]"}]}], 
                 ";", "\[IndentingNewLine]", "              ", 
                 RowBox[{"dxyzAE1", "=", 
                  RowBox[{"Map", "[", 
                   RowBox[{
                    RowBox[{
                    RowBox[{
                    RowBox[{"AE1xyz", "[", 
                    RowBox[{"[", 
                    RowBox[{"#", ",", "1"}], "]"}], "]"}], "-", 
                    RowBox[{"AE1xyz", "[", 
                    RowBox[{"[", 
                    RowBox[{"#", ",", "2"}], "]"}], "]"}], "-", 
                    RowBox[{"Round", "[", 
                    RowBox[{
                    RowBox[{"AE1xyz", "[", 
                    RowBox[{"[", 
                    RowBox[{"#", ",", "1"}], "]"}], "]"}], "-", 
                    RowBox[{"AE1xyz", "[", 
                    RowBox[{"[", 
                    RowBox[{"#", ",", "2"}], "]"}], "]"}]}], "]"}]}], "&"}], 
                    ",", 
                    RowBox[{"Range", "[", 
                    RowBox[{"Length", "@", "AE1xyz"}], "]"}]}], "]"}]}], ";", 
                 "\[IndentingNewLine]", "              ", 
                 RowBox[{"dxyzE1B", "=", 
                  RowBox[{"Map", "[", 
                   RowBox[{
                    RowBox[{
                    RowBox[{
                    RowBox[{"E1Bxyz", "[", 
                    RowBox[{"[", 
                    RowBox[{"#", ",", "1"}], "]"}], "]"}], "-", 
                    RowBox[{"E1Bxyz", "[", 
                    RowBox[{"[", 
                    RowBox[{"#", ",", "2"}], "]"}], "]"}], "-", 
                    RowBox[{"Round", "[", 
                    RowBox[{
                    RowBox[{"E1Bxyz", "[", 
                    RowBox[{"[", 
                    RowBox[{"#", ",", "1"}], "]"}], "]"}], "-", 
                    RowBox[{"E1Bxyz", "[", 
                    RowBox[{"[", 
                    RowBox[{"#", ",", "2"}], "]"}], "]"}]}], "]"}]}], "&"}], 
                    ",", 
                    RowBox[{"Range", "[", 
                    RowBox[{"Length", "@", "E1Bxyz"}], "]"}]}], "]"}]}], ";", 
                 "\[IndentingNewLine]", "              ", 
                 RowBox[{"drAE1", "=", 
                  RowBox[{"Norm", "/@", 
                   RowBox[{"(", 
                    RowBox[{"dxyzAE1", ".", "cell"}], ")"}]}]}], ";", 
                 "\[IndentingNewLine]", "              ", 
                 RowBox[{"drE1B", "=", 
                  RowBox[{"Norm", "/@", 
                   RowBox[{"(", 
                    RowBox[{"dxyzE1B", ".", "cell"}], ")"}]}]}], ";", 
                 "\[IndentingNewLine]", "              ", 
                 RowBox[{"drAE1E1B", "=", 
                  RowBox[{
                   RowBox[{"{", 
                    RowBox[{"drAE1", ",", "drE1B"}], "}"}], 
                   "\[Transpose]"}]}]}]}], "\[IndentingNewLine]", 
               "              ", "]"}], ";", "\[IndentingNewLine]", 
              "\[IndentingNewLine]", "              ", 
              RowBox[{"If", "[", 
               RowBox[{
                RowBox[{
                 RowBox[{"Length", "@", "e2ID"}], "==", "0"}], ",", 
                RowBox[{"drAE2E2B", "=", 
                 RowBox[{"{", "}"}]}], ",", "\[IndentingNewLine]", 
                "              ", 
                RowBox[{
                 RowBox[{"nrowAE2ID", "=", 
                  RowBox[{
                   RowBox[{"Map", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"Position", "[", 
                    RowBox[{
                    RowBox[{"IFxyz", "[", 
                    RowBox[{"[", 
                    RowBox[{"All", ",", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", "2"}], "}"}]}], "]"}], "]"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"aID", ",", 
                    RowBox[{"e2ID", "[", 
                    RowBox[{"[", "#", "]"}], "]"}]}], "}"}]}], "]"}], "&"}], 
                    ",", 
                    RowBox[{"Range", "[", 
                    RowBox[{"Length", "@", "e2ID"}], "]"}]}], "]"}], "//", 
                   "Flatten"}]}], ";", "\[IndentingNewLine]", 
                 "              ", 
                 RowBox[{"nrowE2BID", "=", 
                  RowBox[{
                   RowBox[{"Map", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"Position", "[", 
                    RowBox[{
                    RowBox[{"IFxyz", "[", 
                    RowBox[{"[", 
                    RowBox[{"All", ",", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", "2"}], "}"}]}], "]"}], "]"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"bID", ",", 
                    RowBox[{"e2ID", "[", 
                    RowBox[{"[", "#", "]"}], "]"}]}], "}"}]}], "]"}], "&"}], 
                    ",", 
                    RowBox[{"Range", "[", 
                    RowBox[{"Length", "@", "e2ID"}], "]"}]}], "]"}], "//", 
                   "Flatten"}]}], ";", "\[IndentingNewLine]", 
                 "              ", 
                 RowBox[{"AE2xyz", "=", 
                  RowBox[{"Map", "[", 
                   RowBox[{
                    RowBox[{
                    RowBox[{"IFxyz", "[", 
                    RowBox[{"[", 
                    RowBox[{
                    RowBox[{"nrowAE2ID", "[", 
                    RowBox[{"[", "#", "]"}], "]"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"3", ",", "4"}], "}"}]}], "]"}], "]"}], "&"}], 
                    ",", 
                    RowBox[{"Range", "[", 
                    RowBox[{"Length", "@", "nrowAE2ID"}], "]"}]}], "]"}]}], 
                 ";", "\[IndentingNewLine]", "              ", 
                 RowBox[{"E2Bxyz", "=", 
                  RowBox[{"Map", "[", 
                   RowBox[{
                    RowBox[{
                    RowBox[{"IFxyz", "[", 
                    RowBox[{"[", 
                    RowBox[{
                    RowBox[{"nrowE2BID", "[", 
                    RowBox[{"[", "#", "]"}], "]"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"3", ",", "4"}], "}"}]}], "]"}], "]"}], "&"}], 
                    ",", 
                    RowBox[{"Range", "[", 
                    RowBox[{"Length", "@", "nrowE2BID"}], "]"}]}], "]"}]}], 
                 ";", "\[IndentingNewLine]", "              ", 
                 RowBox[{"dxyzAE2", "=", 
                  RowBox[{"Map", "[", 
                   RowBox[{
                    RowBox[{
                    RowBox[{
                    RowBox[{"AE2xyz", "[", 
                    RowBox[{"[", 
                    RowBox[{"#", ",", "1"}], "]"}], "]"}], "-", 
                    RowBox[{"AE2xyz", "[", 
                    RowBox[{"[", 
                    RowBox[{"#", ",", "2"}], "]"}], "]"}], "-", 
                    RowBox[{"Round", "[", 
                    RowBox[{
                    RowBox[{"AE2xyz", "[", 
                    RowBox[{"[", 
                    RowBox[{"#", ",", "1"}], "]"}], "]"}], "-", 
                    RowBox[{"AE2xyz", "[", 
                    RowBox[{"[", 
                    RowBox[{"#", ",", "2"}], "]"}], "]"}]}], "]"}]}], "&"}], 
                    ",", 
                    RowBox[{"Range", "[", 
                    RowBox[{"Length", "@", "AE2xyz"}], "]"}]}], "]"}]}], ";", 
                 "\[IndentingNewLine]", "              ", 
                 RowBox[{"dxyzE2B", "=", 
                  RowBox[{"Map", "[", 
                   RowBox[{
                    RowBox[{
                    RowBox[{
                    RowBox[{"E2Bxyz", "[", 
                    RowBox[{"[", 
                    RowBox[{"#", ",", "1"}], "]"}], "]"}], "-", 
                    RowBox[{"E2Bxyz", "[", 
                    RowBox[{"[", 
                    RowBox[{"#", ",", "2"}], "]"}], "]"}], "-", 
                    RowBox[{"Round", "[", 
                    RowBox[{
                    RowBox[{"E2Bxyz", "[", 
                    RowBox[{"[", 
                    RowBox[{"#", ",", "1"}], "]"}], "]"}], "-", 
                    RowBox[{"E2Bxyz", "[", 
                    RowBox[{"[", 
                    RowBox[{"#", ",", "2"}], "]"}], "]"}]}], "]"}]}], "&"}], 
                    ",", 
                    RowBox[{"Range", "[", 
                    RowBox[{"Length", "@", "E2Bxyz"}], "]"}]}], "]"}]}], ";", 
                 "\[IndentingNewLine]", "              ", 
                 RowBox[{"drAE2", "=", 
                  RowBox[{"Norm", "/@", 
                   RowBox[{"(", 
                    RowBox[{"dxyzAE2", ".", "cell"}], ")"}]}]}], ";", 
                 "\[IndentingNewLine]", "              ", 
                 RowBox[{"drE2B", "=", 
                  RowBox[{"Norm", "/@", 
                   RowBox[{"(", 
                    RowBox[{"dxyzE2B", ".", "cell"}], ")"}]}]}], ";", 
                 "\[IndentingNewLine]", "              ", 
                 RowBox[{"drAE2E2B", "=", 
                  RowBox[{
                   RowBox[{"{", 
                    RowBox[{"drAE2", ",", "drE2B"}], "}"}], 
                   "\[Transpose]"}]}]}]}], "\[IndentingNewLine]", 
               "              ", "]"}], ";", "\[IndentingNewLine]", 
              "\[IndentingNewLine]", "              ", 
              RowBox[{"If", "[", 
               RowBox[{
                RowBox[{
                 RowBox[{"Length", "@", "e3ID"}], "\[Equal]", "0"}], ",", 
                RowBox[{"drAE3E3B", "=", 
                 RowBox[{"{", "}"}]}], ",", "\[IndentingNewLine]", 
                "              ", 
                RowBox[{
                 RowBox[{"nrowAE3ID", "=", 
                  RowBox[{
                   RowBox[{"Map", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"Position", "[", 
                    RowBox[{
                    RowBox[{"IFxyz", "[", 
                    RowBox[{"[", 
                    RowBox[{"All", ",", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", "2"}], "}"}]}], "]"}], "]"}], ",", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"e3ID", "[", 
                    RowBox[{"[", "#", "]"}], "]"}], ",", "aID"}], "}"}]}], 
                    "]"}], "&"}], ",", 
                    RowBox[{"Range", "[", 
                    RowBox[{"Length", "@", "e3ID"}], "]"}]}], "]"}], "//", 
                   "Flatten"}]}], ";", "\[IndentingNewLine]", 
                 "              ", 
                 RowBox[{"nrowE3BID", "=", 
                  RowBox[{
                   RowBox[{"Map", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"Position", "[", 
                    RowBox[{
                    RowBox[{"IFxyz", "[", 
                    RowBox[{"[", 
                    RowBox[{"All", ",", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", "2"}], "}"}]}], "]"}], "]"}], ",", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"e3ID", "[", 
                    RowBox[{"[", "#", "]"}], "]"}], ",", "bID"}], "}"}]}], 
                    "]"}], "&"}], ",", 
                    RowBox[{"Range", "[", 
                    RowBox[{"Length", "@", "e3ID"}], "]"}]}], "]"}], "//", 
                   "Flatten"}]}], ";", "\[IndentingNewLine]", 
                 "              ", 
                 RowBox[{"AE3xyz", "=", 
                  RowBox[{"Map", "[", 
                   RowBox[{
                    RowBox[{
                    RowBox[{"IFxyz", "[", 
                    RowBox[{"[", 
                    RowBox[{
                    RowBox[{"nrowAE3ID", "[", 
                    RowBox[{"[", "#", "]"}], "]"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"3", ",", "4"}], "}"}]}], "]"}], "]"}], "&"}], 
                    ",", 
                    RowBox[{"Range", "[", 
                    RowBox[{"Length", "@", "nrowAE3ID"}], "]"}]}], "]"}]}], 
                 ";", "\[IndentingNewLine]", "              ", 
                 RowBox[{"E3Bxyz", "=", 
                  RowBox[{"Map", "[", 
                   RowBox[{
                    RowBox[{
                    RowBox[{"IFxyz", "[", 
                    RowBox[{"[", 
                    RowBox[{
                    RowBox[{"nrowE3BID", "[", 
                    RowBox[{"[", "#", "]"}], "]"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"3", ",", "4"}], "}"}]}], "]"}], "]"}], "&"}], 
                    ",", 
                    RowBox[{"Range", "[", 
                    RowBox[{"Length", "@", "nrowE3BID"}], "]"}]}], "]"}]}], 
                 ";", "\[IndentingNewLine]", "              ", 
                 RowBox[{"dxyzAE3", "=", 
                  RowBox[{"Map", "[", 
                   RowBox[{
                    RowBox[{
                    RowBox[{
                    RowBox[{"AE3xyz", "[", 
                    RowBox[{"[", 
                    RowBox[{"#", ",", "1"}], "]"}], "]"}], "-", 
                    RowBox[{"AE3xyz", "[", 
                    RowBox[{"[", 
                    RowBox[{"#", ",", "2"}], "]"}], "]"}], "-", 
                    RowBox[{"Round", "[", 
                    RowBox[{
                    RowBox[{"AE3xyz", "[", 
                    RowBox[{"[", 
                    RowBox[{"#", ",", "1"}], "]"}], "]"}], "-", 
                    RowBox[{"AE3xyz", "[", 
                    RowBox[{"[", 
                    RowBox[{"#", ",", "2"}], "]"}], "]"}]}], "]"}]}], "&"}], 
                    ",", 
                    RowBox[{"Range", "[", 
                    RowBox[{"Length", "@", "AE3xyz"}], "]"}]}], "]"}]}], ";", 
                 "\[IndentingNewLine]", "              ", 
                 RowBox[{"dxyzE3B", "=", 
                  RowBox[{"Map", "[", 
                   RowBox[{
                    RowBox[{
                    RowBox[{
                    RowBox[{"E3Bxyz", "[", 
                    RowBox[{"[", 
                    RowBox[{"#", ",", "1"}], "]"}], "]"}], "-", 
                    RowBox[{"E3Bxyz", "[", 
                    RowBox[{"[", 
                    RowBox[{"#", ",", "2"}], "]"}], "]"}], "-", 
                    RowBox[{"Round", "[", 
                    RowBox[{
                    RowBox[{"E3Bxyz", "[", 
                    RowBox[{"[", 
                    RowBox[{"#", ",", "1"}], "]"}], "]"}], "-", 
                    RowBox[{"E3Bxyz", "[", 
                    RowBox[{"[", 
                    RowBox[{"#", ",", "2"}], "]"}], "]"}]}], "]"}]}], "&"}], 
                    ",", 
                    RowBox[{"Range", "[", 
                    RowBox[{"Length", "@", "E3Bxyz"}], "]"}]}], "]"}]}], ";", 
                 "\[IndentingNewLine]", "              ", 
                 RowBox[{"drAE3", "=", 
                  RowBox[{"Norm", "/@", 
                   RowBox[{"(", 
                    RowBox[{"dxyzAE3", ".", "cell"}], ")"}]}]}], ";", 
                 "\[IndentingNewLine]", "              ", 
                 RowBox[{"drE3B", "=", 
                  RowBox[{"Norm", "/@", 
                   RowBox[{"(", 
                    RowBox[{"dxyzE3B", ".", "cell"}], ")"}]}]}], ";", 
                 "\[IndentingNewLine]", "              ", 
                 RowBox[{"drAE3E3B", "=", 
                  RowBox[{
                   RowBox[{"{", 
                    RowBox[{"drAE3", ",", "drE3B"}], "}"}], 
                   "\[Transpose]"}]}]}]}], "\[IndentingNewLine]", 
               "              ", "]"}], ";", "\[IndentingNewLine]", 
              "\[IndentingNewLine]", "              ", 
              RowBox[{"drAEEB", "=", 
               RowBox[{"Join", "[", 
                RowBox[{"drAE1E1B", ",", "drAE2E2B", ",", "drAE3E3B"}], 
                "]"}]}], ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
              "              ", 
              RowBox[{"If", "[", 
               RowBox[{
                RowBox[{"MemberQ", "[", 
                 RowBox[{
                  RowBox[{"Map", "[", 
                   RowBox[{
                    RowBox[{
                    RowBox[{
                    RowBox[{
                    RowBox[{"drAEEB", "[", 
                    RowBox[{"[", 
                    RowBox[{"#", ",", "1"}], "]"}], "]"}], "<", "drAB"}], "&&", 
                    RowBox[{
                    RowBox[{"drAEEB", "[", 
                    RowBox[{"[", 
                    RowBox[{"#", ",", "2"}], "]"}], "]"}], "<", "drAB"}]}], 
                    "&"}], ",", 
                    RowBox[{"Range", "[", 
                    RowBox[{"Length", "@", "drAEEB"}], "]"}]}], "]"}], ",", 
                  "True"}], "]"}], ",", ",", 
                RowBox[{"BasicIFxyz", "=", 
                 RowBox[{"Append", "[", 
                  RowBox[{"BasicIFxyz", ",", 
                   RowBox[{"IFxyz", "[", 
                    RowBox[{"[", "i", "]"}], "]"}]}], "]"}]}]}], "]"}]}]}], 
            "\[IndentingNewLine]", "              ", "]"}], ";"}]}], 
         "\[IndentingNewLine]", "              ", "]"}], ";", 
        "\[IndentingNewLine]", "\[IndentingNewLine]", "              ", 
        RowBox[{"(*", 
         RowBox[{
          RowBox[{"Print", "[", 
           RowBox[{"\"\<Number of BasicIFxyz: \>\"", ",", 
            RowBox[{"Length", "@", "BasicIFxyz"}]}], "]"}], ";"}], "*)"}], 
        "\[IndentingNewLine]", "              ", 
        RowBox[{"nDFTpath", "=", 
         RowBox[{
         "folderPath", "<>", "\"\</\>\"", "<>", "strName", "<>", "\"\<_\>\"", 
          "<>", "ion", "<>", "\"\</3_normal_GeoOpt\>\""}]}], ";", 
        "\[IndentingNewLine]", "              ", 
        RowBox[{"Export", "[", 
         RowBox[{
          RowBox[{
          "nDFTpath", "<>", "\"\</\>\"", "<>", "ion", "<>", 
           "\"\<_basic_IFxyz\>\""}], ",", "BasicIFxyz", ",", 
          "\"\<Table\>\""}], "]"}], ";", "\[IndentingNewLine]", 
        "              ", "BasicIFxyz"}]}], "\[IndentingNewLine]", 
      "              ", "]"}]}], ";"}], "\[IndentingNewLine]", 
   "\[IndentingNewLine]", 
   RowBox[{"(*", 
    StyleBox[
     RowBox[{"Remove", " ", "equivalent", " ", "paths"}],
     FontColor->RGBColor[0, 0.501961, 0.752941]], "*)"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"MyMemberQ", "[", 
      RowBox[{"var1_", ",", "var2_"}], "]"}], ":=", 
     RowBox[{"MemberQ", "[", 
      RowBox[{
       RowBox[{"Round", "[", 
        RowBox[{"var1", ",", "0.01"}], "]"}], ",", 
       RowBox[{"Round", "[", 
        RowBox[{"var2", ",", "0.01"}], "]"}]}], "]"}]}], ";"}], 
   "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"exclEqlPaths", "[", 
      RowBox[{
      "folderPath_", ",", "strName_", ",", "ion_", ",", "symGroupN_", ",", 
       "BasicIFxyz_"}], "]"}], ":=", 
     RowBox[{"Module", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
        "mat", ",", "cell", ",", "nDFTpath", ",", "IneqBasicIFxyz", ",", 
         "IFxyzdminUneql", ",", "i", ",", "listI", ",", "listF", ",", "dxyz", 
         ",", "dr", ",", "j", ",", "dxyzj", ",", "drj"}], "}"}], ",", 
       "\[IndentingNewLine]", "              ", 
       RowBox[{
        RowBox[{"mat", "=", 
         RowBox[{"MyImport", "[", 
          RowBox[{
           RowBox[{
           "folderPath", "<>", "\"\</\>\"", "<>", "strName", "<>", 
            "\"\<_\>\"", "<>", "ion", "<>", 
            "\"\</1_zeolite_GeoOpt/CONTCAR\>\""}], ",", "\"\<Table\>\""}], 
          "]"}]}], ";", "\[IndentingNewLine]", "              ", 
        RowBox[{"cell", "=", 
         RowBox[{
          RowBox[{"mat", "[", 
           RowBox[{"[", 
            RowBox[{"2", ",", "1"}], "]"}], "]"}], "*", 
          RowBox[{"mat", "[", 
           RowBox[{"[", 
            RowBox[{
             RowBox[{"{", 
              RowBox[{"3", ",", "4", ",", "5"}], "}"}], ",", "All"}], "]"}], 
           "]"}]}]}], ";", "\[IndentingNewLine]", "              ", 
        RowBox[{"nDFTpath", "=", 
         RowBox[{
         "folderPath", "<>", "\"\</\>\"", "<>", "strName", "<>", "\"\<_\>\"", 
          "<>", "ion", "<>", "\"\</3_normal_GeoOpt\>\""}]}], ";", 
        "\[IndentingNewLine]", "\[IndentingNewLine]", "              ", 
        RowBox[{"IneqBasicIFxyz", "=", "BasicIFxyz"}], ";", 
        "\[IndentingNewLine]", "              ", 
        RowBox[{"For", " ", "[", 
         RowBox[{
          RowBox[{"i", "=", "1"}], ",", 
          RowBox[{"i", "\[LessEqual]", 
           RowBox[{"Length", "@", "BasicIFxyz"}]}], ",", 
          RowBox[{"i", "=", 
           RowBox[{"i", "+", "1"}]}], ",", "\[IndentingNewLine]", 
          "              ", 
          RowBox[{
           RowBox[{"listI", "=", 
            RowBox[{
             RowBox[{"symmetry", "[", 
              RowBox[{"folderPath", ",", "symGroupN", ",", 
               RowBox[{"BasicIFxyz", "[", 
                RowBox[{"[", 
                 RowBox[{"i", ",", "3"}], "]"}], "]"}]}], "]"}], "//", 
             "DeleteDuplicates"}]}], ";", "\[IndentingNewLine]", 
           "              ", 
           RowBox[{"listI", "=", 
            RowBox[{"periodPoints", "[", "listI", "]"}]}], ";", 
           "\[IndentingNewLine]", "              ", 
           RowBox[{"listF", "=", 
            RowBox[{
             RowBox[{"symmetry", "[", 
              RowBox[{"folderPath", ",", "symGroupN", ",", 
               RowBox[{"BasicIFxyz", "[", 
                RowBox[{"[", 
                 RowBox[{"i", ",", "4"}], "]"}], "]"}]}], "]"}], "//", 
             "DeleteDuplicates"}]}], ";", "\[IndentingNewLine]", 
           "              ", 
           RowBox[{"listF", "=", 
            RowBox[{"periodPoints", "[", "listF", "]"}]}], ";", 
           "\[IndentingNewLine]", "              ", 
           RowBox[{"dxyz", "=", 
            RowBox[{
             RowBox[{"BasicIFxyz", "[", 
              RowBox[{"[", 
               RowBox[{"i", ",", "3"}], "]"}], "]"}], "-", 
             RowBox[{"BasicIFxyz", "[", 
              RowBox[{"[", 
               RowBox[{"i", ",", "4"}], "]"}], "]"}], "-", 
             RowBox[{"Round", "[", 
              RowBox[{
               RowBox[{"BasicIFxyz", "[", 
                RowBox[{"[", 
                 RowBox[{"i", ",", "3"}], "]"}], "]"}], "-", 
               RowBox[{"BasicIFxyz", "[", 
                RowBox[{"[", 
                 RowBox[{"i", ",", "4"}], "]"}], "]"}]}], "]"}]}]}], ";", 
           "\[IndentingNewLine]", "              ", 
           RowBox[{"dr", "=", 
            RowBox[{"Norm", "[", 
             RowBox[{"dxyz", ".", "cell"}], "]"}]}], ";", 
           RowBox[{"dr", "=", 
            RowBox[{"Round", "[", 
             RowBox[{"dr", ",", "0.1"}], "]"}]}], ";", "\[IndentingNewLine]", 
           "\[IndentingNewLine]", "              ", 
           RowBox[{"For", " ", "[", 
            RowBox[{
             RowBox[{"j", "=", 
              RowBox[{"i", "+", "1"}]}], ",", 
             RowBox[{"j", "\[LessEqual]", 
              RowBox[{"Length", "@", "BasicIFxyz"}]}], ",", 
             RowBox[{"j", "=", 
              RowBox[{"j", "+", "1"}]}], ",", "\[IndentingNewLine]", 
             "              ", 
             RowBox[{
              RowBox[{"dxyzj", "=", 
               RowBox[{
                RowBox[{"BasicIFxyz", "[", 
                 RowBox[{"[", 
                  RowBox[{"j", ",", "3"}], "]"}], "]"}], "-", 
                RowBox[{"BasicIFxyz", "[", 
                 RowBox[{"[", 
                  RowBox[{"j", ",", "4"}], "]"}], "]"}], "-", 
                RowBox[{"Round", "[", 
                 RowBox[{
                  RowBox[{"BasicIFxyz", "[", 
                   RowBox[{"[", 
                    RowBox[{"j", ",", "3"}], "]"}], "]"}], "-", 
                  RowBox[{"BasicIFxyz", "[", 
                   RowBox[{"[", 
                    RowBox[{"j", ",", "4"}], "]"}], "]"}]}], "]"}]}]}], ";", 
              "\[IndentingNewLine]", "              ", 
              RowBox[{"drj", "=", 
               RowBox[{"Norm", "[", 
                RowBox[{"dxyzj", ".", "cell"}], "]"}]}], ";", 
              RowBox[{"drj", "=", 
               RowBox[{"Round", "[", 
                RowBox[{"drj", ",", "0.1"}], "]"}]}], ";", 
              "\[IndentingNewLine]", "\[IndentingNewLine]", "              ", 
              RowBox[{"If", "[", 
               RowBox[{
                RowBox[{
                 RowBox[{"(", 
                  RowBox[{
                   RowBox[{"MyMemberQ", "[", 
                    RowBox[{"listI", ",", 
                    RowBox[{"BasicIFxyz", "[", 
                    RowBox[{"[", 
                    RowBox[{"j", ",", "3"}], "]"}], "]"}]}], "]"}], "&&", 
                   RowBox[{"MyMemberQ", "[", 
                    RowBox[{"listF", ",", 
                    RowBox[{"BasicIFxyz", "[", 
                    RowBox[{"[", 
                    RowBox[{"j", ",", "4"}], "]"}], "]"}]}], "]"}], "&&", 
                   RowBox[{"drj", "\[Equal]", "dr"}]}], ")"}], "||", 
                 RowBox[{"(", 
                  RowBox[{
                   RowBox[{"MyMemberQ", "[", 
                    RowBox[{"listI", ",", 
                    RowBox[{"BasicIFxyz", "[", 
                    RowBox[{"[", 
                    RowBox[{"j", ",", "4"}], "]"}], "]"}]}], "]"}], "&&", 
                   RowBox[{"MyMemberQ", "[", 
                    RowBox[{"listF", ",", 
                    RowBox[{"BasicIFxyz", "[", 
                    RowBox[{"[", 
                    RowBox[{"j", ",", "3"}], "]"}], "]"}]}], "]"}], "&&", 
                   RowBox[{"drj", "\[Equal]", "dr"}]}], ")"}]}], ",", " ", 
                "\[IndentingNewLine]", "                  ", 
                RowBox[{"IneqBasicIFxyz", "=", 
                 RowBox[{"DeleteCases", "[", 
                  RowBox[{"IneqBasicIFxyz", ",", 
                   RowBox[{"BasicIFxyz", "[", 
                    RowBox[{"[", "j", "]"}], "]"}]}], "]"}]}]}], "]"}], 
              ";"}]}], "\[IndentingNewLine]", "              ", "]"}]}]}], 
         "\[IndentingNewLine]", "              ", "]"}], ";", 
        "\[IndentingNewLine]", "\[IndentingNewLine]", "              ", 
        RowBox[{"Export", "[", 
         RowBox[{
          RowBox[{
          "nDFTpath", "<>", "\"\</\>\"", "<>", "ion", "<>", 
           "\"\<_Ineq_basic_IFxyz\>\""}], ",", "IneqBasicIFxyz", ",", 
          "\"\<Table\>\""}], "]"}], ";", "\[IndentingNewLine]", 
        "              ", "IneqBasicIFxyz"}]}], "\[IndentingNewLine]", 
      "              ", "]"}]}], ";"}], "\[IndentingNewLine]", 
   "\[IndentingNewLine]", 
   RowBox[{"(*", 
    StyleBox[
     RowBox[{
     "Generate", " ", "all", " ", "paths", " ", "with", " ", "hopping", " ", 
      "length", " ", "in", " ", "the", " ", "certain", " ", "range", " ", 
      "and", " ", "then", " ", "remove", " ", "substitutable", " ", "and", 
      " ", "equivalent", " ", "paths"}],
     FontColor->RGBColor[0, 0.501961, 0.752941]], "*)"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"netIF", "[", 
      RowBox[{
      "folderPath_", ",", "strName_", ",", "ion_", ",", "symGroupN_", ",", 
       RowBox[{"{", 
        RowBox[{"drmin_", ",", "drmax_"}], "}"}]}], "]"}], ":=", 
     RowBox[{"Module", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
        "mat", ",", "absUneqlPt", ",", "cell", ",", "nDFTpath", ",", 
         "absUneqlPtSym", ",", "xyzLi", ",", "xyzwoPer0", ",", "xyzwoPer", 
         ",", "m", ",", "n", ",", "dxyz0", ",", "dr0", ",", 
         RowBox[{"netij", "=", 
          RowBox[{"{", "}"}]}], ",", 
         RowBox[{"netxyz", "=", 
          RowBox[{"{", "}"}]}], ",", 
         RowBox[{"netdr", "=", 
          RowBox[{"{", "}"}]}], ",", "i", ",", "j", ",", "dxyz", ",", "dr", 
         ",", "name", ",", "IFxyz", ",", "BasicIFxyz", ",", 
         "IneqBasicIFxyz"}], "}"}], ",", "\[IndentingNewLine]", 
       "\[IndentingNewLine]", "              ", 
       RowBox[{
        RowBox[{"mat", "=", 
         RowBox[{"MyImport", "[", 
          RowBox[{
           RowBox[{
           "folderPath", "<>", "\"\</\>\"", "<>", "strName", "<>", 
            "\"\<_\>\"", "<>", "ion", "<>", 
            "\"\</1_zeolite_GeoOpt/CONTCAR\>\""}], ",", "\"\<Table\>\""}], 
          "]"}]}], ";", "\[IndentingNewLine]", "              ", 
        RowBox[{"cell", "=", 
         RowBox[{
          RowBox[{"mat", "[", 
           RowBox[{"[", 
            RowBox[{"2", ",", "1"}], "]"}], "]"}], "*", 
          RowBox[{"mat", "[", 
           RowBox[{"[", 
            RowBox[{
             RowBox[{"{", 
              RowBox[{"3", ",", "4", ",", "5"}], "}"}], ",", "All"}], "]"}], 
           "]"}]}]}], ";", "\[IndentingNewLine]", "              ", 
        RowBox[{"(*", 
         RowBox[{
          RowBox[{"Print", "[", "strName", "]"}], ";"}], "*)"}], 
        "\[IndentingNewLine]", "              ", 
        RowBox[{"nDFTpath", "=", 
         RowBox[{
         "folderPath", "<>", "\"\</\>\"", "<>", "strName", "<>", "\"\<_\>\"", 
          "<>", "ion", "<>", "\"\</3_normal_GeoOpt\>\""}]}], ";", 
        "\[IndentingNewLine]", "              ", 
        RowBox[{"absUneqlPt", "=", 
         RowBox[{"MyImport", "[", 
          RowBox[{
           RowBox[{"nDFTpath", "<>", "\"\</CONTCAR_IneqSites\>\""}], ",", 
           "\"\<Table\>\""}], "]"}]}], ";", "\[IndentingNewLine]", 
        "\[IndentingNewLine]", "              ", 
        RowBox[{"absUneqlPtSym", "=", 
         RowBox[{"Map", "[", 
          RowBox[{
           RowBox[{
            RowBox[{"symmetry", "[", 
             RowBox[{"folderPath", ",", "symGroupN", ",", 
              RowBox[{"absUneqlPt", "[", 
               RowBox[{"[", "#", "]"}], "]"}]}], "]"}], "&"}], ",", 
           RowBox[{"Range", "[", 
            RowBox[{"Length", "@", "absUneqlPt"}], "]"}]}], "]"}]}], ";", 
        "\[IndentingNewLine]", "              ", 
        RowBox[{"xyzLi", "=", 
         RowBox[{"Flatten", "[", 
          RowBox[{
           RowBox[{"Round", "[", 
            RowBox[{"absUneqlPtSym", ",", "0.00001"}], "]"}], ",", "1"}], 
          "]"}]}], ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
        "              ", 
        RowBox[{"xyzwoPer0", "=", 
         RowBox[{"woPerXYZ", "[", "xyzLi", "]"}]}], ";", 
        "\[IndentingNewLine]", "              ", 
        RowBox[{"xyzwoPer", "=", "xyzwoPer0"}], ";", "\[IndentingNewLine]", 
        "              ", 
        RowBox[{"For", "[", 
         RowBox[{
          RowBox[{"m", "=", "1"}], ",", 
          RowBox[{"m", "\[LessEqual]", 
           RowBox[{"Length", "@", "xyzwoPer0"}]}], ",", 
          RowBox[{"m", "=", 
           RowBox[{"m", "+", "1"}]}], ",", "\[IndentingNewLine]", 
          "              ", 
          RowBox[{"For", "[", 
           RowBox[{
            RowBox[{"n", "=", 
             RowBox[{"m", "+", "1"}]}], ",", 
            RowBox[{"n", "\[LessEqual]", 
             RowBox[{"Length", "@", "xyzwoPer0"}]}], ",", 
            RowBox[{"n", "=", 
             RowBox[{"n", "+", "1"}]}], ",", "\[IndentingNewLine]", 
            "                    ", 
            RowBox[{
             RowBox[{"dxyz0", "=", 
              RowBox[{
               RowBox[{"xyzwoPer0", "[", 
                RowBox[{"[", "m", "]"}], "]"}], "-", 
               RowBox[{"xyzwoPer0", "[", 
                RowBox[{"[", "n", "]"}], "]"}], "-", 
               RowBox[{"Round", "[", 
                RowBox[{
                 RowBox[{"xyzwoPer0", "[", 
                  RowBox[{"[", "m", "]"}], "]"}], "-", 
                 RowBox[{"xyzwoPer0", "[", 
                  RowBox[{"[", "n", "]"}], "]"}]}], "]"}]}]}], ";", 
             "\[IndentingNewLine]", "                    ", 
             RowBox[{"dr0", "=", 
              RowBox[{"Norm", "[", 
               RowBox[{"dxyz0", ".", "cell"}], "]"}]}], ";", 
             "\[IndentingNewLine]", "                     ", 
             RowBox[{"If", "[", 
              RowBox[{
               RowBox[{
                RowBox[{"Round", "[", 
                 RowBox[{"dr0", ",", "0.1"}], "]"}], "<", "0.5"}], ",", 
               RowBox[{"xyzwoPer", "=", 
                RowBox[{"DeleteCases", "[", 
                 RowBox[{"xyzwoPer", ",", 
                  RowBox[{"xyzwoPer0", "[", 
                   RowBox[{"[", "n", "]"}], "]"}]}], "]"}]}]}], "]"}]}]}], 
           "\[IndentingNewLine]", "                   ", "]"}]}], 
         "\[IndentingNewLine]", "              ", "]"}], ";", 
        "\[IndentingNewLine]", "\[IndentingNewLine]", "              ", 
        RowBox[{"For", " ", "[", 
         RowBox[{
          RowBox[{"i", "=", "1"}], ",", 
          RowBox[{"i", "\[LessEqual]", 
           RowBox[{"Length", "@", "xyzwoPer"}]}], ",", 
          RowBox[{"i", "=", 
           RowBox[{"i", "+", "1"}]}], ",", "\[IndentingNewLine]", 
          "              ", 
          RowBox[{"For", "[", 
           RowBox[{
            RowBox[{"j", "=", 
             RowBox[{"i", "+", "1"}]}], ",", 
            RowBox[{"j", "\[LessEqual]", 
             RowBox[{"Length", "@", "xyzwoPer"}]}], ",", 
            RowBox[{"j", "=", 
             RowBox[{"j", "+", "1"}]}], ",", "\[IndentingNewLine]", 
            "                   ", 
            RowBox[{
             RowBox[{"dxyz", "=", 
              RowBox[{
               RowBox[{"xyzwoPer", "[", 
                RowBox[{"[", "i", "]"}], "]"}], "-", 
               RowBox[{"xyzwoPer", "[", 
                RowBox[{"[", "j", "]"}], "]"}], "-", 
               RowBox[{"Round", "[", 
                RowBox[{
                 RowBox[{"xyzwoPer", "[", 
                  RowBox[{"[", "i", "]"}], "]"}], "-", 
                 RowBox[{"xyzwoPer", "[", 
                  RowBox[{"[", "j", "]"}], "]"}]}], "]"}]}]}], ";", 
             "\[IndentingNewLine]", "                   ", 
             RowBox[{"dr", "=", 
              RowBox[{"Norm", "[", 
               RowBox[{"dxyz", ".", "cell"}], "]"}]}], ";", 
             "\[IndentingNewLine]", "                   ", 
             RowBox[{"If", "[", 
              RowBox[{
               RowBox[{"drmin", "\[LessEqual]", 
                RowBox[{"Round", "[", 
                 RowBox[{"dr", ",", "0.1"}], "]"}], "\[LessEqual]", "drmax"}],
                ",", "\[IndentingNewLine]", "                       ", 
               RowBox[{
                RowBox[{"netij", "=", 
                 RowBox[{"Append", "[", 
                  RowBox[{"netij", ",", 
                   RowBox[{"{", 
                    RowBox[{"i", ",", "j"}], "}"}]}], "]"}]}], ";", 
                RowBox[{"netxyz", "=", 
                 RowBox[{"Append", "[", 
                  RowBox[{"netxyz", ",", 
                   RowBox[{"{", 
                    RowBox[{
                    RowBox[{"xyzwoPer", "[", 
                    RowBox[{"[", "i", "]"}], "]"}], ",", 
                    RowBox[{"xyzwoPer", "[", 
                    RowBox[{"[", "j", "]"}], "]"}]}], "}"}]}], "]"}]}], ";", 
                RowBox[{"netdr", "=", 
                 RowBox[{"Append", "[", 
                  RowBox[{"netdr", ",", 
                   RowBox[{"{", 
                    RowBox[{"Round", "[", 
                    RowBox[{"dr", ",", "0.1"}], "]"}], "}"}]}], "]"}]}]}]}], 
              "\[IndentingNewLine]", "                      ", "]"}]}]}], 
           "\[IndentingNewLine]", "                    ", "]"}]}], 
         "\[IndentingNewLine]", "              ", "]"}], ";", 
        "\[IndentingNewLine]", "              ", 
        RowBox[{"IFxyz", "=", 
         RowBox[{"Map", "[", 
          RowBox[{
           RowBox[{
            RowBox[{"Join", "[", 
             RowBox[{
              RowBox[{"netij", "[", 
               RowBox[{"[", "#", "]"}], "]"}], ",", 
              RowBox[{"netxyz", "[", 
               RowBox[{"[", "#", "]"}], "]"}], ",", 
              RowBox[{"netdr", "[", 
               RowBox[{"[", "#", "]"}], "]"}]}], "]"}], "&"}], ",", 
           RowBox[{"Range", "[", 
            RowBox[{"Length", "@", "netij"}], "]"}]}], "]"}]}], ";", 
        "\[IndentingNewLine]", "\[IndentingNewLine]", "              ", 
        RowBox[{"(*", 
         RowBox[{
          RowBox[{"Print", "[", 
           RowBox[{
           "\"\<Number of xyz with symmetry without periodic condition: \>\"",
             ",", 
            RowBox[{"Length", "@", "xyzwoPer"}]}], "]"}], ";"}], "*)"}], 
        "\[IndentingNewLine]", "              ", 
        RowBox[{"(*", 
         RowBox[{
          RowBox[{"Print", "[", 
           RowBox[{"\"\<Number of IFxyz: \>\"", ",", 
            RowBox[{"Length", "@", "IFxyz"}]}], "]"}], ";"}], "*)"}], 
        "\[IndentingNewLine]", "              ", 
        RowBox[{"Export", "[", 
         RowBox[{
          RowBox[{
          "nDFTpath", "<>", "\"\</\>\"", "<>", "ion", "<>", 
           "\"\<_symwoPer\>\""}], ",", "xyzwoPer", ",", "\"\<Table\>\""}], 
         "]"}], ";", "\[IndentingNewLine]", "              ", 
        RowBox[{"Export", "[", 
         RowBox[{
          RowBox[{
          "nDFTpath", "<>", "\"\</\>\"", "<>", "ion", "<>", 
           "\"\<_IFxyz\>\""}], ",", "IFxyz", ",", "\"\<Table\>\""}], "]"}], 
        ";", "\[IndentingNewLine]", "\[IndentingNewLine]", "              ", 
        RowBox[{"BasicIFxyz", "=", 
         RowBox[{"exclSubst", "[", 
          RowBox[{"folderPath", ",", "strName", ",", "ion", ",", "IFxyz"}], 
          "]"}]}], ";", "\[IndentingNewLine]", "              ", 
        RowBox[{"IneqBasicIFxyz", "=", 
         RowBox[{"exclEqlPaths", "[", 
          RowBox[{
          "folderPath", ",", "strName", ",", "ion", ",", "symGroupN", ",", 
           "BasicIFxyz"}], "]"}]}], ";"}]}], "\[IndentingNewLine]", 
      "              ", "]"}]}], ";"}], "\[IndentingNewLine]", 
   "\[IndentingNewLine]", 
   RowBox[{"(*", 
    StyleBox[
     RowBox[{
     "Create", " ", "directory", " ", "and", " ", "POSCAR", " ", "for", " ", 
      "cNEB", " ", "calculations"}],
     FontColor->RGBColor[0, 0.501961, 0.752941]], "*)"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"Step4POSCARs", "[", 
      RowBox[{"folderPath_", ",", "strName_", ",", "ion_"}], "]"}], ":=", 
     RowBox[{"Module", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
        "mat", ",", "nDFTpath", ",", "exportDirPath", ",", "IneqBasicIFxyz", 
         ",", "IDI", ",", "IDF", ",", "IDandxyz", ",", "dataID", ",", 
         "dataXYZ", ",", "ans1"}], "}"}], ",", "\[IndentingNewLine]", 
       "              ", 
       RowBox[{
        RowBox[{"mat", "=", 
         RowBox[{"MyImport", "[", 
          RowBox[{
           RowBox[{
           "folderPath", "<>", "\"\</\>\"", "<>", "strName", "<>", 
            "\"\<_\>\"", "<>", "ion", "<>", 
            "\"\</1_zeolite_GeoOpt/CONTCAR\>\""}], ",", "\"\<Table\>\""}], 
          "]"}]}], ";", "\[IndentingNewLine]", "              ", 
        RowBox[{
         RowBox[{"mat", "[", 
          RowBox[{"[", "6", "]"}], "]"}], "=", 
         RowBox[{"Append", "[", 
          RowBox[{
           RowBox[{"mat", "[", 
            RowBox[{"[", "6", "]"}], "]"}], ",", "ion"}], "]"}]}], ";", 
        "\[IndentingNewLine]", "              ", 
        RowBox[{
         RowBox[{"mat", "[", 
          RowBox[{"[", "7", "]"}], "]"}], "=", 
         RowBox[{"Append", "[", 
          RowBox[{
           RowBox[{"mat", "[", 
            RowBox[{"[", "7", "]"}], "]"}], ",", "1"}], "]"}]}], ";", 
        "\[IndentingNewLine]", "              ", 
        RowBox[{"Print", "[", "strName", "]"}], ";", "\[IndentingNewLine]", 
        "\[IndentingNewLine]", "              ", 
        RowBox[{"nDFTpath", "=", 
         RowBox[{
         "folderPath", "<>", "\"\</\>\"", "<>", "strName", "<>", "\"\<_\>\"", 
          "<>", "ion", "<>", "\"\</3_normal_GeoOpt\>\""}]}], ";", 
        "\[IndentingNewLine]", "              ", 
        RowBox[{"exportDirPath", "=", 
         RowBox[{
         "folderPath", "<>", "\"\</\>\"", "<>", "strName", "<>", "\"\<_\>\"", 
          "<>", "ion", "<>", "\"\</4_IF_GeoOpt\>\""}]}], ";", 
        "\[IndentingNewLine]", "              ", 
        RowBox[{"IneqBasicIFxyz", "=", 
         RowBox[{
          RowBox[{"MyImport", "[", 
           RowBox[{
            RowBox[{
            "nDFTpath", "<>", "\"\</\>\"", "<>", "ion", "<>", 
             "\"\<_Ineq_basic_IFxyz\>\""}], ",", "\"\<TSV\>\""}], "]"}], "//",
           "ToExpression"}]}], ";", "\[IndentingNewLine]", 
        "\[IndentingNewLine]", "              ", 
        RowBox[{"IDI", "=", 
         RowBox[{
          RowBox[{"Map", "[", 
           RowBox[{
            RowBox[{
             RowBox[{"IneqBasicIFxyz", "[", 
              RowBox[{"[", 
               RowBox[{"#", ",", 
                RowBox[{"{", 
                 RowBox[{"1", ",", "3"}], "}"}]}], "]"}], "]"}], "&"}], ",", 
            RowBox[{"Range", "[", 
             RowBox[{"Length", "@", "IneqBasicIFxyz"}], "]"}]}], "]"}], "//", 
          "DeleteDuplicates"}]}], ";", "\[IndentingNewLine]", 
        "              ", 
        RowBox[{"IDF", "=", 
         RowBox[{
          RowBox[{"Map", "[", 
           RowBox[{
            RowBox[{
             RowBox[{"IneqBasicIFxyz", "[", 
              RowBox[{"[", 
               RowBox[{"#", ",", 
                RowBox[{"{", 
                 RowBox[{"2", ",", "4"}], "}"}]}], "]"}], "]"}], "&"}], ",", 
            RowBox[{"Range", "[", 
             RowBox[{"Length", "@", "IneqBasicIFxyz"}], "]"}]}], "]"}], "//", 
          "DeleteDuplicates"}]}], ";", "\[IndentingNewLine]", 
        "              ", 
        RowBox[{"IDandxyz", "=", 
         RowBox[{"IDI", "\[Union]", "IDF"}]}], ";", "\[IndentingNewLine]", 
        "              ", 
        RowBox[{"dataID", "=", 
         RowBox[{"IDandxyz", "[", 
          RowBox[{"[", 
           RowBox[{"All", ",", "1"}], "]"}], "]"}]}], ";", 
        "\[IndentingNewLine]", "\[IndentingNewLine]", "              ", 
        RowBox[{"Print", "[", 
         RowBox[{
          RowBox[{"Length", "@", "IDandxyz"}], ",", 
          "\"\< adsorption sites to create: \>\"", ",", 
          RowBox[{"IDandxyz", "[", 
           RowBox[{"[", 
            RowBox[{"All", ",", "1"}], "]"}], "]"}]}], "]"}], ";", 
        "\[IndentingNewLine]", "              ", 
        RowBox[{"Print", "[", 
         RowBox[{
          RowBox[{"Length", "@", 
           RowBox[{"IneqBasicIFxyz", "[", 
            RowBox[{"[", 
             RowBox[{"All", ",", 
              RowBox[{"{", 
               RowBox[{"1", ",", "2"}], "}"}]}], "]"}], "]"}]}], ",", 
          "\"\< inequivalent, non-substitutable paths formed by these sites: \
\>\"", ",", 
          RowBox[{"IneqBasicIFxyz", "[", 
           RowBox[{"[", 
            RowBox[{"All", ",", 
             RowBox[{"{", 
              RowBox[{"1", ",", "2"}], "}"}]}], "]"}], "]"}]}], "]"}], ";", 
        "\[IndentingNewLine]", "\[IndentingNewLine]", "              ", 
        RowBox[{"Map", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"MyCreateDir", "[", 
            RowBox[{"exportDirPath", "<>", "\"\</\>\"", "<>", 
             RowBox[{"ToString", "[", "#", "]"}]}], "]"}], "&"}], ",", 
          "dataID"}], "]"}], ";", "\[IndentingNewLine]", "              ", 
        RowBox[{"dataXYZ", "=", 
         RowBox[{"IDandxyz", "[", 
          RowBox[{"[", 
           RowBox[{"All", ",", "2"}], "]"}], "]"}]}], ";", 
        "\[IndentingNewLine]", "              ", 
        RowBox[{"ans1", "=", 
         RowBox[{"Map", "[", 
          RowBox[{
           RowBox[{
            RowBox[{"Append", "[", 
             RowBox[{"mat", ",", 
              RowBox[{"dataXYZ", "[", 
               RowBox[{"[", "#", "]"}], "]"}]}], "]"}], "&"}], ",", 
           RowBox[{"Range", "[", 
            RowBox[{"Length", "@", "dataXYZ"}], "]"}]}], "]"}]}], ";", 
        "\[IndentingNewLine]", "              ", 
        RowBox[{"Map", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"Export", "[", 
            RowBox[{
             RowBox[{"exportDirPath", "<>", "\"\</\>\"", "<>", 
              RowBox[{"ToString", "[", 
               RowBox[{"dataID", "[", 
                RowBox[{"[", "#", "]"}], "]"}], "]"}], "<>", 
              "\"\</POSCAR\>\""}], ",", 
             RowBox[{"ans1", "[", 
              RowBox[{"[", "#", "]"}], "]"}], ",", "\"\<Table\>\""}], "]"}], 
           "&"}], ",", 
          RowBox[{"Range", "[", 
           RowBox[{"Length", "@", "ans1"}], "]"}]}], "]"}], ";", 
        "\[IndentingNewLine]", "              ", 
        RowBox[{"Export", "[", 
         RowBox[{
          RowBox[{"exportDirPath", "<>", "\"\</pathID.txt\>\""}], ",", " ", 
          RowBox[{"ToString", "[", 
           RowBox[{"IneqBasicIFxyz", "[", 
            RowBox[{"[", 
             RowBox[{"All", ",", 
              RowBox[{"{", 
               RowBox[{"1", ",", "2"}], "}"}]}], "]"}], "]"}], "]"}]}], 
         "]"}]}]}], "\[IndentingNewLine]", "              ", "]"}]}], 
    ";"}]}]}]], "Input",
 CellChangeTimes->{{3.947679389021981*^9, 3.947679396431747*^9}, {
   3.9476794321166058`*^9, 3.947679639066236*^9}, {3.94767969894118*^9, 
   3.947679835027523*^9}, {3.9476798814966288`*^9, 3.9476798819768744`*^9}, {
   3.947679917341619*^9, 3.94767995055339*^9}, 3.947680026485827*^9, {
   3.947680067149605*^9, 3.947680331903977*^9}, {3.9476804267826843`*^9, 
   3.947680522037092*^9}, {3.947680557240683*^9, 3.94768057299256*^9}, {
   3.947680611603451*^9, 3.947680613182645*^9}, {3.947680693390931*^9, 
   3.94768070722541*^9}, {3.94768084092211*^9, 3.947681072020716*^9}, {
   3.947681115489628*^9, 3.947681128876685*^9}, {3.947681216006462*^9, 
   3.94768125547829*^9}, {3.947681301818218*^9, 3.947681307379184*^9}, {
   3.9476813657888536`*^9, 3.9476814496098146`*^9}, {3.947681640386969*^9, 
   3.947681695938162*^9}, {3.947681779230385*^9, 3.947681911419393*^9}, {
   3.947681968718941*^9, 3.947682017763361*^9}, {3.947682083795923*^9, 
   3.947682127376306*^9}, {3.947682364002881*^9, 3.947682399221169*^9}, {
   3.947682442232077*^9, 3.947682444412459*^9}, {3.947682503977736*^9, 
   3.947682505860299*^9}, {3.947682687342702*^9, 3.947682725137363*^9}, {
   3.9476827688111486`*^9, 3.947682876992041*^9}, {3.947682908202309*^9, 
   3.947682950491802*^9}, {3.947682981220252*^9, 3.94768300285962*^9}, {
   3.947683048612035*^9, 3.94768314251855*^9}, {3.947683181202819*^9, 
   3.947683218712129*^9}, {3.947683276087072*^9, 3.947683915314476*^9}, {
   3.947683971103079*^9, 3.9476839713795156`*^9}, {3.947684034701899*^9, 
   3.947684082902018*^9}, {3.947684158039077*^9, 3.94768419747926*^9}, {
   3.947684345474646*^9, 3.947684473618642*^9}, {3.947684504113616*^9, 
   3.94768462957593*^9}, {3.947684674297317*^9, 3.947684716564142*^9}, {
   3.947684789127081*^9, 3.947684813522107*^9}, 3.947684862587516*^9, {
   3.947684897873831*^9, 3.947684915854608*^9}, {3.947685051478436*^9, 
   3.947685079349217*^9}, {3.947685133282002*^9, 3.947685144157075*^9}, {
   3.94768523789716*^9, 3.947685251939834*^9}, {3.947685552659403*^9, 
   3.947685561256357*^9}, 3.947685809742494*^9, {3.947685972166861*^9, 
   3.947686000680491*^9}, {3.947686034998858*^9, 3.947686041956292*^9}, {
   3.947686074479062*^9, 3.947686082923134*^9}, 3.947686151456542*^9, {
   3.947686197110252*^9, 3.947686202696869*^9}, {3.947686257081942*^9, 
   3.94768627752124*^9}, {3.947686335734971*^9, 3.947686373847808*^9}, {
   3.947686458814498*^9, 3.947686533225968*^9}, {3.9476865920948668`*^9, 
   3.947686648862357*^9}, {3.947686712255029*^9, 3.947686728673014*^9}, {
   3.947686823103353*^9, 3.947686858890341*^9}, 3.947686912297654*^9, {
   3.947686949606145*^9, 3.947686990711645*^9}, {3.9476871037878017`*^9, 
   3.947687166516069*^9}, {3.947687208287956*^9, 3.947687214594215*^9}, {
   3.947687307625939*^9, 3.947687354153986*^9}, {3.94768746634828*^9, 
   3.947687536344773*^9}, {3.947687566956019*^9, 3.947687580516501*^9}, {
   3.947687879083972*^9, 3.947687937454713*^9}, {3.947688009376169*^9, 
   3.947688010350523*^9}, {3.947688051542155*^9, 3.9476880639840183`*^9}, {
   3.947692043571189*^9, 3.947692065062796*^9}, {3.947693957454413*^9, 
   3.947693987094283*^9}, {3.94769627576666*^9, 3.947696295445133*^9}, {
   3.947696367651456*^9, 3.947696369210936*^9}, {3.94771074025263*^9, 
   3.947710741508382*^9}, 3.947713477290254*^9, {3.947716008611187*^9, 
   3.947716065157541*^9}, 3.947716117200683*^9, {3.947716174710442*^9, 
   3.947716213941875*^9}, {3.947716271200004*^9, 3.9477163143734007`*^9}, {
   3.947716354788641*^9, 3.947716403415572*^9}, {3.947716441497798*^9, 
   3.947716466422987*^9}, {3.947716508764688*^9, 3.947716524699439*^9}, {
   3.947716654664076*^9, 3.947716677361663*^9}, {3.947716720487195*^9, 
   3.947716747733255*^9}, {3.9477171918039*^9, 3.947717192877168*^9}, {
   3.947717243140964*^9, 3.947717244921762*^9}, 3.947717337387013*^9, {
   3.947717424579947*^9, 3.947717426628948*^9}, {3.947742049272693*^9, 
   3.947742049303589*^9}, {3.9477429567866087`*^9, 3.947743010738757*^9}, {
   3.947743046441211*^9, 3.947743068643759*^9}, {3.947752136068525*^9, 
   3.9477521364024487`*^9}, 3.947763207709594*^9, 3.94776324048709*^9, 
   3.9477633421583242`*^9},
 CellLabel->"In[14]:=",ExpressionUUID->"c36d70f7-7c2d-425f-aeeb-f0f5ea2291d3"]
}, Closed]],

Cell[CellGroupData[{

Cell[TextData[StyleBox["Prepare files for cNEB",
 FontFamily->"Tahoma",
 FontSize->20,
 FontColor->RGBColor[0., 0.5098039215686274, 0.7490196078431373]]], "Section",
 CellChangeTimes->{{3.935198057363014*^9, 3.9351980889683056`*^9}, {
  3.9351981697376947`*^9, 3.935198179931798*^9}, {3.94759105666687*^9, 
  3.94759105745255*^9}, {3.947690047954599*^9, 3.9476900589300637`*^9}, {
  3.947690492644923*^9, 3.947690516140127*^9}, {3.947690603116321*^9, 
  3.947690606217016*^9}, {3.947692110299595*^9, 3.947692110907564*^9}, {
  3.947721154430665*^9, 
  3.947721162700592*^9}},ExpressionUUID->"028338cc-696b-4e76-8b80-\
34664c32bf42"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", 
   RowBox[{
    StyleBox["Copy",
     FontColor->RGBColor[0, 0.501961, 0.752941]], 
    StyleBox[" ",
     FontColor->RGBColor[0, 0.501961, 0.752941]], 
    StyleBox["CONTCARs",
     FontColor->RGBColor[0, 0.501961, 0.752941]], 
    StyleBox[" ",
     FontColor->RGBColor[0, 0.501961, 0.752941]], 
    StyleBox["in",
     FontColor->RGBColor[0, 0.501961, 0.752941]], 
    StyleBox[" ",
     FontColor->RGBColor[0, 0.501961, 0.752941]], "4", "_IF", "_GeoOpt", " ", 
    StyleBox["and",
     FontColor->RGBColor[0, 0.501961, 0.752941]], 
    StyleBox[" ",
     FontColor->RGBColor[0, 0.501961, 0.752941]], 
    StyleBox["prepare",
     FontColor->RGBColor[0, 0.501961, 0.752941]], 
    StyleBox[" ",
     FontColor->RGBColor[0, 0.501961, 0.752941]], 
    StyleBox["cNEB",
     FontColor->RGBColor[0, 0.501961, 0.752941]], 
    StyleBox[" ",
     FontColor->RGBColor[0, 0.501961, 0.752941]], 
    StyleBox["folders",
     FontColor->RGBColor[0, 0.501961, 0.752941]], 
    StyleBox[" ",
     FontColor->RGBColor[0, 0.501961, 0.752941]], 
    StyleBox["according",
     FontColor->RGBColor[0, 0.501961, 0.752941]], 
    StyleBox[" ",
     FontColor->RGBColor[0, 0.501961, 0.752941]], 
    StyleBox["to",
     FontColor->RGBColor[0, 0.501961, 0.752941]], 
    StyleBox[" ",
     FontColor->RGBColor[0, 0.501961, 0.752941]], "4", "_IF", 
    RowBox[{"_GeoOpt", "/", 
     RowBox[{"pathID", ".", "txt"}]}]}], " ", "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"PrepareNEB", "[", 
     RowBox[{"folderPath_", ",", "strName_", ",", "ion_"}], "]"}], ":=", 
    RowBox[{"Module", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
       "IFpath", ",", "NEBpath", ",", "pathIDs", ",", "names", ",", "i", ",", 
        "file10", ",", "file20", ",", "file11", ",", "file21"}], "}"}], ",", 
      "\[IndentingNewLine]", "              ", 
      RowBox[{
       RowBox[{"IFpath", "=", 
        RowBox[{
        "folderPath", "<>", "\"\</\>\"", "<>", "strName", "<>", "\"\<_\>\"", "<>",
          "ion", "<>", "\"\</4_IF_GeoOpt/\>\""}]}], ";", 
       "\[IndentingNewLine]", "              ", 
       RowBox[{"NEBpath", "=", 
        RowBox[{
        "folderPath", "<>", "\"\</\>\"", "<>", "strName", "<>", "\"\<_\>\"", "<>",
          "ion", "<>", "\"\</5_cNEB_Opt/\>\""}]}], ";", "\[IndentingNewLine]",
        "\[IndentingNewLine]", "              ", 
       RowBox[{"pathIDs", "=", 
        RowBox[{
         RowBox[{
          RowBox[{"MyImport", "[", 
           RowBox[{
            RowBox[{"IFpath", "<>", "\"\<pathID.txt\>\""}], ",", 
            "\"\<TSV\>\""}], "]"}], "[", 
          RowBox[{"[", 
           RowBox[{"1", ",", "1"}], "]"}], "]"}], "//", "ToExpression"}]}], 
       ";", 
       RowBox[{"pathIDs", "=", 
        RowBox[{"Map", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"ToString", "[", "#", "]"}], "&"}], ",", "pathIDs", ",", 
          RowBox[{"{", "2", "}"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
       "              ", 
       RowBox[{"names", "=", 
        RowBox[{"Map", "[", 
         RowBox[{
          RowBox[{
           RowBox[{
            RowBox[{"#", "[", 
             RowBox[{"[", "1", "]"}], "]"}], "<>", "\"\<-\>\"", "<>", 
            RowBox[{"#", "[", 
             RowBox[{"[", "2", "]"}], "]"}]}], "&"}], ",", "pathIDs"}], 
         "]"}]}], ";", "\[IndentingNewLine]", "              ", 
       RowBox[{"Map", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"MyCreateDir", "[", 
           RowBox[{"NEBpath", "<>", "#"}], "]"}], "&"}], ",", "names"}], 
        "]"}], ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
       "              ", 
       RowBox[{"For", "[", 
        RowBox[{
         RowBox[{"i", "=", "1"}], ",", 
         RowBox[{"i", "<=", 
          RowBox[{"Length", "[", "names", "]"}]}], ",", 
         RowBox[{"i", "=", 
          RowBox[{"i", "+", "1"}]}], ",", "\[IndentingNewLine]", 
         "              ", 
         RowBox[{
          RowBox[{"file10", "=", 
           RowBox[{"IFpath", "<>", 
            RowBox[{"pathIDs", "[", 
             RowBox[{"[", 
              RowBox[{"i", ",", "1"}], "]"}], "]"}], "<>", 
            "\"\</CONTCAR\>\""}]}], ";", "\[IndentingNewLine]", 
          "              ", 
          RowBox[{"file20", "=", 
           RowBox[{"IFpath", "<>", 
            RowBox[{"pathIDs", "[", 
             RowBox[{"[", 
              RowBox[{"i", ",", "2"}], "]"}], "]"}], "<>", 
            "\"\</CONTCAR\>\""}]}], ";", "\[IndentingNewLine]", 
          "              ", 
          RowBox[{"file11", "=", 
           RowBox[{"NEBpath", "<>", 
            RowBox[{"names", "[", 
             RowBox[{"[", "i", "]"}], "]"}], "<>", "\"\</CONTCAR_\>\"", "<>", 
            RowBox[{"ToString", "@", 
             RowBox[{"pathIDs", "[", 
              RowBox[{"[", 
               RowBox[{"i", ",", "1"}], "]"}], "]"}]}]}]}], ";", 
          "\[IndentingNewLine]", "              ", 
          RowBox[{"file21", "=", 
           RowBox[{"NEBpath", "<>", 
            RowBox[{"names", "[", 
             RowBox[{"[", "i", "]"}], "]"}], "<>", "\"\</CONTCAR_\>\"", "<>", 
            RowBox[{"ToString", "@", 
             RowBox[{"pathIDs", "[", 
              RowBox[{"[", 
               RowBox[{"i", ",", "2"}], "]"}], "]"}]}]}]}], ";", 
          "\[IndentingNewLine]", "              ", 
          RowBox[{"MyCopyFile", "[", 
           RowBox[{"file10", ",", "file11"}], "]"}], ";", 
          "\[IndentingNewLine]", "              ", 
          RowBox[{"MyCopyFile", "[", 
           RowBox[{"file20", ",", "file21"}], "]"}], ";"}]}], 
        "\[IndentingNewLine]", "              ", "]"}], ";", 
       "\[IndentingNewLine]", "\[IndentingNewLine]", "              ", 
       RowBox[{"FileNames", "[", 
        RowBox[{"\"\<*\>\"", ",", "NEBpath"}], "]"}]}]}], 
     "\[IndentingNewLine]", "              ", "]"}]}], ";"}]}]], "Input",
 CellChangeTimes->{{3.947721260437977*^9, 3.947721320563078*^9}, {
   3.947721374915561*^9, 3.947721469843767*^9}, {3.9477311342247343`*^9, 
   3.947731297033894*^9}, {3.947731333320489*^9, 3.947731393828206*^9}, {
   3.947732024166436*^9, 3.947732086990917*^9}, {3.947732197664983*^9, 
   3.947732244189786*^9}, {3.9477322800371246`*^9, 3.947732289536268*^9}, {
   3.947732348440283*^9, 3.947732348733137*^9}, {3.947732468786663*^9, 
   3.94773248019785*^9}, 3.94773252965628*^9, {3.947732579617217*^9, 
   3.947732580786088*^9}, {3.947732668410858*^9, 3.947732675529539*^9}, {
   3.9477331297247562`*^9, 3.9477331316759*^9}},
 CellLabel->"In[21]:=",ExpressionUUID->"8dd4975a-d123-4bcb-8040-124c60415da2"]
}, Closed]],

Cell[CellGroupData[{

Cell[TextData[StyleBox["Collect cNEB results",
 FontFamily->"Tahoma",
 FontSize->20,
 FontColor->RGBColor[0., 0.5098039215686274, 0.7490196078431373]]], "Section",
 CellChangeTimes->{{3.935198057363014*^9, 3.9351980889683056`*^9}, {
  3.9351981697376947`*^9, 3.935198179931798*^9}, {3.94759105666687*^9, 
  3.94759105745255*^9}, {3.947690047954599*^9, 3.9476900589300632`*^9}, {
  3.947690492644923*^9, 3.947690516140127*^9}, {3.947690603116321*^9, 
  3.947690606217016*^9}, {3.947692110299595*^9, 
  3.947692110907564*^9}},ExpressionUUID->"a926768b-aec1-44fd-a961-\
221fe6e4cdc9"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"FinalE0", "[", "oszicarPath_", "]"}], ":=", 
    RowBox[{"Module", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"data", ",", "row"}], "}"}], ",", "\[IndentingNewLine]", 
      "              ", 
      RowBox[{
       RowBox[{"data", "=", 
        RowBox[{"MyImport", "[", 
         RowBox[{
          RowBox[{"oszicarPath", "<>", "\"\</OSZICAR\>\""}], ",", 
          "\"\<Table\>\""}], "]"}]}], ";", "\[IndentingNewLine]", 
       "              ", 
       RowBox[{"row", "=", 
        RowBox[{
         RowBox[{"Position", "[", 
          RowBox[{"data", ",", "\"\<E0=\>\""}], "]"}], "[", 
         RowBox[{"[", 
          RowBox[{
           RowBox[{"-", "1"}], ",", "1"}], "]"}], "]"}]}], ";", 
       "\[IndentingNewLine]", "              ", 
       RowBox[{"data", "[", 
        RowBox[{"[", 
         RowBox[{"row", ",", "5"}], "]"}], "]"}]}]}], "\[IndentingNewLine]", 
     "              ", "]"}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"CompileMEP", "[", 
    RowBox[{"folderPath_", ",", "strName_", ",", "ion_", ",", "Eion_"}], 
    "]"}], ":=", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
      "path", ",", "zeolitePath", ",", "IFpath", ",", "cNEBpath", ",", 
       "ExcelFile", ",", "dirName", ",", "titleDir", ",", "energyE", ",", 
       "data1", ",", "energyMEP", ",", "data2", ",", "energyAds", ",", 
       "data3", ",", "cNEBE", ",", "i", ",", "geoOptE", ",", "dir", ",", 
       "cNEBi", ",", "cNEBf", ",", "dirE", ",", "dataE", ",", "E0", ",", 
       "Eads", ",", "nebName", ",", "dataEads", ",", "minEads", ",", "dataE0",
        ",", "minE", ",", "dataMEP"}], "}"}], ",", "\[IndentingNewLine]", 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"path", "=", 
       RowBox[{
       "folderPath", "<>", "\"\</\>\"", "<>", "strName", "<>", "\"\<_\>\"", "<>",
         "ion"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"zeolitePath", "=", 
       RowBox[{"path", "<>", "\"\</1_zeolite_GeoOpt\>\""}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"IFpath", "=", 
       RowBox[{"path", "<>", "\"\</4_IF_GeoOpt\>\""}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"cNEBpath", "=", 
       RowBox[{"path", "<>", "\"\</5_cNEB_Opt\>\""}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"ExcelFile", "=", 
       RowBox[{
       "path", "<>", "\"\</energy_\>\"", "<>", "strName", "<>", "\"\<_\>\"", "<>",
         "ion", "<>", "\"\<.xlsx\>\""}]}], ";", "\[IndentingNewLine]", 
      "\[IndentingNewLine]", 
      RowBox[{"SetDirectory", "[", "cNEBpath", "]"}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"dirName", "=", 
       RowBox[{"Select", "[", 
        RowBox[{
         RowBox[{"FileNames", "[", "]"}], ",", "DirectoryQ"}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"titleDir", "=", 
       RowBox[{"Join", "[", 
        RowBox[{
         RowBox[{"{", "strName", "}"}], ",", "dirName"}], "]"}]}], ";", 
      "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"cNEBE", "=", 
       RowBox[{"{", 
        RowBox[{"{", 
         RowBox[{
         "\"\<00\>\"", ",", "\"\<01\>\"", ",", "\"\<02\>\"", ",", 
          "\"\<03\>\"", ",", "\"\<04\>\""}], "}"}], "}"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"For", "[", 
       RowBox[{
        RowBox[{"i", "=", "1"}], ",", 
        RowBox[{"i", "\[LessEqual]", 
         RowBox[{"Length", "@", "dirName"}]}], ",", 
        RowBox[{"i", "=", 
         RowBox[{"i", "+", "1"}]}], ",", "\[IndentingNewLine]", "      ", 
        RowBox[{
         RowBox[{"dir", "=", 
          RowBox[{"dirName", "[", 
           RowBox[{"[", "i", "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
         "      ", 
         RowBox[{"cNEBi", "=", 
          RowBox[{
           RowBox[{"StringSplit", "[", 
            RowBox[{"dir", ",", "\"\<-\>\""}], "]"}], "[", 
           RowBox[{"[", "1", "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
         "      ", 
         RowBox[{"cNEBf", "=", 
          RowBox[{
           RowBox[{"StringSplit", "[", 
            RowBox[{"dir", ",", "\"\<-\>\""}], "]"}], "[", 
           RowBox[{"[", 
            RowBox[{"-", "1"}], "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
         "      ", 
         RowBox[{"dirE", "=", 
          RowBox[{"FinalE0", "/@", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"IFpath", "<>", "\"\</\>\"", "<>", "cNEBi"}], ",", 
             RowBox[{
             "cNEBpath", "<>", "\"\</\>\"", "<>", "dir", "<>", 
              "\"\</01\>\""}], ",", 
             RowBox[{
             "cNEBpath", "<>", "\"\</\>\"", "<>", "dir", "<>", 
              "\"\</02\>\""}], ",", 
             RowBox[{
             "cNEBpath", "<>", "\"\</\>\"", "<>", "dir", "<>", 
              "\"\</03\>\""}], ",", 
             RowBox[{"IFpath", "<>", "\"\</\>\"", "<>", "cNEBf"}]}], 
            "}"}]}]}], ";", "\[IndentingNewLine]", "      ", 
         RowBox[{"cNEBE", "=", 
          RowBox[{"Join", "[", 
           RowBox[{"cNEBE", ",", 
            RowBox[{"{", "dirE", "}"}]}], "]"}]}], ";"}]}], 
       "\[IndentingNewLine]", " ", "]"}], ";", "\[IndentingNewLine]", 
      RowBox[{"geoOptE", "=", 
       RowBox[{"FinalE0", "[", "zeolitePath", "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"dataE", "=", 
       RowBox[{"cNEBE", "\[Transpose]"}]}], ";", "\[IndentingNewLine]", 
      "\[IndentingNewLine]", 
      RowBox[{"dataE0", "=", 
       RowBox[{"Join", "[", 
        RowBox[{
         RowBox[{"{", "titleDir", "}"}], ",", "dataE"}], "]"}]}], ";", 
      "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"nebName", "=", 
       RowBox[{"Partition", "[", 
        RowBox[{
         RowBox[{"dataE", "[", 
          RowBox[{"[", 
           RowBox[{"All", ",", "1"}], "]"}], "]"}], ",", "1"}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"Eads", "=", 
       RowBox[{
        RowBox[{"dataE", "[", 
         RowBox[{"[", 
          RowBox[{"All", ",", 
           RowBox[{"2", ";;"}]}], "]"}], "]"}], "-", "geoOptE", "-", 
        "Eion"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"dataEads", "=", 
       RowBox[{
        RowBox[{"Join", "[", 
         RowBox[{
          RowBox[{"nebName", "\[Transpose]"}], ",", 
          RowBox[{"Eads", "\[Transpose]"}]}], "]"}], "\[Transpose]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"minEads", "=", 
       RowBox[{"Min", "[", 
        RowBox[{
         RowBox[{"dataEads", "[", 
          RowBox[{"[", 
           RowBox[{"All", ",", 
            RowBox[{"2", ";;"}]}], "]"}], "]"}], "//", "Flatten"}], "]"}]}], 
      ";", "\[IndentingNewLine]", 
      RowBox[{"dataEads", "=", 
       RowBox[{"Join", "[", 
        RowBox[{
         RowBox[{"{", "titleDir", "}"}], ",", "dataEads"}], "]"}]}], ";", 
      "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"minE", "=", 
       RowBox[{"Min", "[", 
        RowBox[{
         RowBox[{"dataE", "[", 
          RowBox[{"[", 
           RowBox[{"All", ",", 
            RowBox[{"2", ";;"}]}], "]"}], "]"}], "//", "Flatten"}], "]"}]}], 
      ";", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"dataE", "[", 
        RowBox[{"[", 
         RowBox[{"All", ",", 
          RowBox[{"2", ";;"}]}], "]"}], "]"}], "=", 
       RowBox[{
        RowBox[{"dataE", "[", 
         RowBox[{"[", 
          RowBox[{"All", ",", 
           RowBox[{"2", ";;"}]}], "]"}], "]"}], "-", "minE"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"dataMEP", "=", 
       RowBox[{"Join", "[", 
        RowBox[{
         RowBox[{"{", "titleDir", "}"}], ",", "dataE"}], "]"}]}], ";", 
      "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"Print", "[", 
       RowBox[{
        RowBox[{
        "\"\<Minimum adsorption energy of \>\"", "<>", "ion", "<>", 
         "\"\< in \>\"", "<>", "strName", "<>", "\"\<: \>\""}], ",", 
        "minEads"}], "]"}], ";", "\[IndentingNewLine]", 
      RowBox[{"Export", "[", 
       RowBox[{"ExcelFile", ",", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"\"\<Final energy\>\"", "->", "dataE0"}], ",", 
          RowBox[{"\"\<Adsorption energy\>\"", "->", "dataEads"}], ",", 
          RowBox[{"\"\<MEP\>\"", "->", "dataMEP"}]}], "}"}]}], "]"}]}]}], 
    "\[IndentingNewLine]", "]"}]}], ";"}]}], "Input",
 CellChangeTimes->{{3.947689984245611*^9, 3.947690031483719*^9}, {
   3.9476901671580887`*^9, 3.94769022823782*^9}, {3.947690279189674*^9, 
   3.947690352852*^9}, {3.947690525650257*^9, 3.947690526174067*^9}, {
   3.947690657797768*^9, 3.947690738850965*^9}, {3.947690776668703*^9, 
   3.947690782645191*^9}, {3.947690814120644*^9, 3.947690957358835*^9}, {
   3.947691053853235*^9, 3.94769117476607*^9}, {3.947691240680735*^9, 
   3.947691271219501*^9}, {3.947691433469867*^9, 3.947691507908058*^9}, {
   3.947691638579093*^9, 3.947691766150378*^9}, 3.947692164497251*^9, 
   3.947692391692395*^9, {3.947692481091982*^9, 3.94769251156964*^9}, {
   3.947692768516768*^9, 3.947692835921057*^9}, {3.947692884597106*^9, 
   3.947692896207382*^9}, {3.9476929282718697`*^9, 3.947692938416173*^9}, {
   3.947693018444709*^9, 3.947693029392036*^9}, {3.947693061259748*^9, 
   3.947693107468252*^9}, 3.9476931395428953`*^9, {3.947693212385164*^9, 
   3.947693215597677*^9}, {3.9476963750085278`*^9, 3.94769637551612*^9}, {
   3.94769641314566*^9, 3.947696413585993*^9}, {3.947718271849755*^9, 
   3.9477182765109806`*^9}, {3.9477183176625032`*^9, 3.947718328748619*^9}, {
   3.947718398878017*^9, 3.947718410478786*^9}, 3.947718442802614*^9, {
   3.947718512067938*^9, 3.947718551899096*^9}},
 CellLabel->"In[22]:=",ExpressionUUID->"baefb03c-404d-4cf4-8432-719a5166bc45"]
}, Closed]],

Cell[CellGroupData[{

Cell[TextData[StyleBox["Steps 6-8 in the paper",
 FontFamily->"Tahoma",
 FontSize->20,
 FontColor->RGBColor[0., 0.5098039215686274, 0.7490196078431373]]], "Section",
 CellChangeTimes->{
  3.861677451689701*^9, {3.861677484775999*^9, 3.8616775165810046`*^9}, {
   3.8616775642747974`*^9, 3.8616775644778476`*^9}, {3.861677623886115*^9, 
   3.861677637320485*^9}, 3.862536274595021*^9, 3.86486892230955*^9, {
   3.8648689583685627`*^9, 3.864869038748819*^9}, {3.864869299768076*^9, 
   3.864869300002394*^9}, {3.864870234042578*^9, 3.864870242706471*^9}, {
   3.8648723025226116`*^9, 3.864872303570187*^9}, {3.864872495529555*^9, 
   3.864872499096853*^9}, {3.864888177375281*^9, 3.864888182817638*^9}, {
   3.8680030147972336`*^9, 3.8680031168622985`*^9}, {3.868072087782483*^9, 
   3.868072089204934*^9}, {3.868151878254257*^9, 3.868151879504495*^9}, {
   3.868153174941499*^9, 3.868153208865707*^9}, {3.8684206928758388`*^9, 
   3.868420693112447*^9}, {3.8684316846841288`*^9, 3.868431684952415*^9}, {
   3.946605438000347*^9, 3.9466054406119986`*^9}, 3.946606407022202*^9, {
   3.947590988206456*^9, 3.947590989962858*^9}, {3.947678857546352*^9, 
   3.947678860183939*^9}, {3.9476937728723397`*^9, 
   3.94769377540718*^9}},ExpressionUUID->"3f9a7937-ad75-4cf0-863e-\
0b859e393da6"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", 
   StyleBox[
    RowBox[{
    "Generate", " ", "trajectory", " ", "file", " ", "from", " ", "cNEB", " ",
      "results"}],
    FontColor->RGBColor[0, 0.501961, 0.752941]], "*)"}], 
  "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{
     RowBox[{"NewPoints", "[", 
      RowBox[{"SP_", ",", "EP_", ",", "nos_"}], "]"}], ":=", 
     RowBox[{"Map", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"(", 
         RowBox[{"SP", "+", 
          RowBox[{
           RowBox[{"#", "/", 
            RowBox[{"(", 
             RowBox[{"nos", "-", "1"}], ")"}]}], "*", 
           RowBox[{"(", 
            RowBox[{"EP", "-", " ", "SP"}], ")"}]}]}], ")"}], "&"}], ",", 
       RowBox[{
        RowBox[{"Range", "[", "nos", "]"}], "-", "1"}]}], "]"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"CreatePoints", "[", 
      RowBox[{"points_", ",", "nos_"}], "]"}], ":=", 
     RowBox[{"Module", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"segments", ",", "Num", ",", "ans0"}], "}"}], ",", 
       "\[IndentingNewLine]", 
       "                                                                      \
      ", 
       RowBox[{
        RowBox[{"segments", "=", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{
            RowBox[{"Drop", "[", 
             RowBox[{"points", ",", 
              RowBox[{"-", "1"}]}], "]"}], ",", 
            RowBox[{"Drop", "[", 
             RowBox[{"points", ",", "1"}], "]"}]}], "}"}], "\[Transpose]"}]}],
         ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
        "                                                                     \
       ", 
        RowBox[{"Num", "=", 
         RowBox[{"Length", "[", "segments", "]"}]}], ";", 
        "\[IndentingNewLine]", 
        "                                                                     \
       ", 
        RowBox[{"ans0", "=", 
         RowBox[{"Map", "[", 
          RowBox[{
           RowBox[{
            RowBox[{"NewPoints", "[", 
             RowBox[{
              RowBox[{"segments", "[", 
               RowBox[{"[", 
                RowBox[{"#", ",", "1"}], "]"}], "]"}], ",", 
              RowBox[{"segments", "[", 
               RowBox[{"[", 
                RowBox[{"#", ",", "2"}], "]"}], "]"}], ",", "nos"}], "]"}], 
            "&"}], ",", 
           RowBox[{"Range", "[", "Num", "]"}]}], "]"}]}], ";", 
        "\[IndentingNewLine]", 
        "                                                                     \
       ", 
        RowBox[{"ans0", "=", 
         RowBox[{"Flatten", "[", 
          RowBox[{"ans0", ",", "1"}], "]"}]}], ";", "\[IndentingNewLine]", 
        "                                                                     \
       ", 
        RowBox[{"Map", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"StringJoin", "[", 
            RowBox[{
             RowBox[{"ToString", "[", 
              RowBox[{"#", "[", 
               RowBox[{"[", "1", "]"}], "]"}], "]"}], "<>", "\"\< \>\"", "<>", 
             RowBox[{"ToString", "[", 
              RowBox[{"#", "[", 
               RowBox[{"[", "2", "]"}], "]"}], "]"}], "<>", "\"\< \>\"", "<>", 
             RowBox[{"ToString", "[", 
              RowBox[{"#", "[", 
               RowBox[{"[", "3", "]"}], "]"}], "]"}]}], "]"}], "&"}], ",", 
          RowBox[{"Chop", "[", 
           RowBox[{"ans0", ",", 
            SuperscriptBox["10", 
             RowBox[{"-", "4"}]]}], "]"}]}], "]"}]}]}], "\[IndentingNewLine]",
       "                                                                      \
      ", "]"}]}], ";"}], "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"Xreds", "[", 
      RowBox[{"file_", ",", "atomnum_"}], "]"}], ":=", 
     RowBox[{
      RowBox[{
       RowBox[{"Import", "[", 
        RowBox[{"file", ",", "\"\<Table\>\""}], "]"}], "[", 
       RowBox[{"[", "atomnum", "]"}], "]"}], "//", 
      RowBox[{
       RowBox[{"Chop", "[", 
        RowBox[{"#", ",", 
         SuperscriptBox["10", 
          RowBox[{"-", "5"}]]}], "]"}], "&"}]}]}], ";"}], 
   "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"NewPOSCAR", "[", 
      RowBox[{
      "dir1_", ",", "dir2_", ",", "atomnum_", ",", "nos0_", ",", "opt1_", ",",
        "trajAtom_"}], "]"}], ":=", 
     RowBox[{"Module", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
        "nos", ",", "files", ",", "points", ",", "newpoints", ",", "ans", ",",
          "name", ",", "nameNewpoints"}], "}"}], ",", "\[IndentingNewLine]", 
       "                             ", 
       RowBox[{
        RowBox[{"nos", "=", 
         RowBox[{"nos0", "+", "2"}]}], ";", "\[IndentingNewLine]", 
        "                            ", 
        RowBox[{"files", "=", 
         RowBox[{"Map", "[", 
          RowBox[{
           RowBox[{
            RowBox[{
            "dir1", "<>", "\"\</\>\"", "<>", "#", "<>", "\"\</CONTCAR\>\""}], 
            "&"}], ",", "dir2"}], "]"}]}], ";", "\[IndentingNewLine]", 
        "                            ", 
        RowBox[{"files", "=", 
         RowBox[{"If", "[", 
          RowBox[{
           RowBox[{"opt1", "\[Equal]", "\"\<POSCAR\>\""}], ",", 
           "\[IndentingNewLine]", 
           "                                               ", 
           RowBox[{"Map", "[", 
            RowBox[{
             RowBox[{
              RowBox[{
              "dir1", "<>", "\"\</\>\"", "<>", "#", "<>", "\"\</POSCAR\>\""}],
               "&"}], ",", "dir2"}], "]"}], ",", "\[IndentingNewLine]", 
           "                                               ", 
           RowBox[{"Map", "[", 
            RowBox[{
             RowBox[{
              RowBox[{"If", "[", 
               RowBox[{
                RowBox[{
                 RowBox[{"ToString", "@", 
                  RowBox[{"FileType", "[", "#", "]"}]}], "==", 
                 "\"\<File\>\""}], ",", "#", ",", 
                RowBox[{"StringReplace", "[", 
                 RowBox[{"#", ",", 
                  RowBox[{"\"\<CONTCAR\>\"", "\[Rule]", "\"\<POSCAR\>\""}]}], 
                 "]"}]}], "]"}], "&"}], ",", "files"}], "]"}]}], 
          "\[IndentingNewLine]", 
          "                                             ", "]"}]}], ";", 
        "\[IndentingNewLine]", "                  ", "\[IndentingNewLine]", 
        "                            ", 
        RowBox[{"points", "=", 
         RowBox[{"Map", "[", 
          RowBox[{
           RowBox[{
            RowBox[{"Xreds", "[", 
             RowBox[{"#", ",", "atomnum"}], "]"}], "&"}], ",", "files"}], 
          "]"}]}], ";", "    ", "\[IndentingNewLine]", 
        "                            ", 
        RowBox[{
         RowBox[{"points", "[", 
          RowBox[{"[", "2", "]"}], "]"}], "=", 
         RowBox[{
          RowBox[{"points", "[", 
           RowBox[{"[", "2", "]"}], "]"}], "+", 
          RowBox[{"Round", "[", 
           RowBox[{
            RowBox[{"points", "[", 
             RowBox[{"[", "1", "]"}], "]"}], "-", 
            RowBox[{"points", "[", 
             RowBox[{"[", "2", "]"}], "]"}]}], "]"}]}]}], ";", 
        "\[IndentingNewLine]", "                            ", 
        RowBox[{
         RowBox[{"points", "[", 
          RowBox[{"[", "3", "]"}], "]"}], "=", 
         RowBox[{
          RowBox[{"points", "[", 
           RowBox[{"[", "3", "]"}], "]"}], "+", 
          RowBox[{"Round", "[", 
           RowBox[{
            RowBox[{"points", "[", 
             RowBox[{"[", "2", "]"}], "]"}], "-", 
            RowBox[{"points", "[", 
             RowBox[{"[", "3", "]"}], "]"}]}], "]"}]}]}], ";", 
        "\[IndentingNewLine]", "                            ", 
        RowBox[{
         RowBox[{"points", "[", 
          RowBox[{"[", "4", "]"}], "]"}], "=", 
         RowBox[{
          RowBox[{"points", "[", 
           RowBox[{"[", "4", "]"}], "]"}], "+", 
          RowBox[{"Round", "[", 
           RowBox[{
            RowBox[{"points", "[", 
             RowBox[{"[", "3", "]"}], "]"}], "-", 
            RowBox[{"points", "[", 
             RowBox[{"[", "4", "]"}], "]"}]}], "]"}]}]}], ";", 
        "\[IndentingNewLine]", "                            ", 
        RowBox[{
         RowBox[{"points", "[", 
          RowBox[{"[", "5", "]"}], "]"}], "=", 
         RowBox[{
          RowBox[{"points", "[", 
           RowBox[{"[", "5", "]"}], "]"}], "+", 
          RowBox[{"Round", "[", 
           RowBox[{
            RowBox[{"points", "[", 
             RowBox[{"[", "4", "]"}], "]"}], "-", 
            RowBox[{"points", "[", 
             RowBox[{"[", "5", "]"}], "]"}]}], "]"}]}]}], ";", 
        "\[IndentingNewLine]", "                            ", 
        RowBox[{"newpoints", "=", 
         RowBox[{"CreatePoints", "[", 
          RowBox[{"points", ",", "nos"}], "]"}]}], ";", " ", 
        "\[IndentingNewLine]", "\[IndentingNewLine]", 
        "                            ", 
        RowBox[{"ans", "=", 
         RowBox[{"Import", "[", 
          RowBox[{
           RowBox[{"dir1", "<>", "\"\</\>\"", "<>", 
            RowBox[{"dir2", "[", 
             RowBox[{"[", "1", "]"}], "]"}], "<>", "\"\</POSCAR\>\""}], ",", 
           "\"\<Lines\>\""}], "]"}]}], ";", "\[IndentingNewLine]", 
        "                            ", 
        RowBox[{
         RowBox[{"ans", "[", 
          RowBox[{"[", "6", "]"}], "]"}], "=", 
         RowBox[{
          RowBox[{"ans", "[", 
           RowBox[{"[", "6", "]"}], "]"}], "<>", "\"\<   \>\"", "<>", 
          RowBox[{"ToString", "[", "trajAtom", "]"}]}]}], ";", 
        "\[IndentingNewLine]", "                            ", 
        RowBox[{
         RowBox[{"ans", "[", 
          RowBox[{"[", "7", "]"}], "]"}], "=", 
         RowBox[{
          RowBox[{"ans", "[", 
           RowBox[{"[", "7", "]"}], "]"}], "<>", "\"\< \>\"", "<>", 
          RowBox[{"ToString", "[", 
           RowBox[{"Length", "@", "newpoints"}], "]"}]}]}], ";", 
        "\[IndentingNewLine]", "                            ", 
        RowBox[{"ans", "=", 
         RowBox[{"Join", "[", 
          RowBox[{"ans", ",", "newpoints"}], "]"}]}], ";", 
        "\[IndentingNewLine]", "\[IndentingNewLine]", 
        "                            ", 
        RowBox[{"name", "=", 
         RowBox[{"dir1", "<>", "\"\</\>\"", "<>", 
          RowBox[{
           RowBox[{"StringSplit", "[", 
            RowBox[{"dir1", ",", "\"\</\>\""}], "]"}], "[", 
           RowBox[{"[", 
            RowBox[{"-", "1"}], "]"}], "]"}], "<>", 
          RowBox[{"ToString", "[", "dir2", "]"}], "<>", 
          "\"\<_trajectory.vasp\>\""}]}], ";", "\[IndentingNewLine]", 
        "                            ", 
        RowBox[{"Export", "[", 
         RowBox[{"name", ",", "ans", ",", "\"\<Lines\>\""}], "]"}], ";", 
        "\[IndentingNewLine]", "                            ", 
        RowBox[{"nameNewpoints", "=", 
         RowBox[{"dir1", "<>", "\"\</trajectory_atoms\>\""}]}], ";", 
        "\[IndentingNewLine]", "                            ", 
        RowBox[{"Export", "[", 
         RowBox[{"nameNewpoints", ",", "newpoints", ",", "\"\<Lines\>\""}], 
         "]"}]}]}], "\[IndentingNewLine]", "                            ", 
      "]"}]}], ";"}], "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{"(*", 
    StyleBox[
     RowBox[{
     "Create", " ", "cNEB", " ", "paths", " ", "with", " ", "trajectory", " ",
       "atoms"}],
     FontColor->RGBColor[0, 0.501961, 0.752941]], "*)"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"CreateTrajectory", "[", 
      RowBox[{"folderPath_", ",", "strName_", ",", "ion_", ",", 
       RowBox[{"a_", ":", "20"}]}], "]"}], ":=", 
     RowBox[{"Module", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
        "cNEBpath", ",", "dirName", ",", "labels", ",", "contcar", ",", 
         "ionPos"}], "}"}], ",", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"cNEBpath", "=", 
         RowBox[{
         "folderPath", "<>", "\"\</\>\"", "<>", "strName", "<>", "\"\<_\>\"", 
          "<>", "ion", "<>", "\"\</5_cNEB_Opt\>\""}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"SetDirectory", "[", "cNEBpath", "]"}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"dirName", "=", 
         RowBox[{"Select", "[", 
          RowBox[{
           RowBox[{"FileNames", "[", "]"}], ",", "DirectoryQ"}], "]"}]}], ";",
         "\[IndentingNewLine]", 
        RowBox[{"labels", "=", 
         RowBox[{
          RowBox[{"(", 
           RowBox[{
            RowBox[{"Alphabet", "[", "]"}], "[", 
            RowBox[{"[", 
             RowBox[{"1", ";;", 
              RowBox[{"Length", "[", "dirName", "]"}]}], "]"}], "]"}], ")"}], 
          "//", "ToUpperCase"}]}], ";", "\[IndentingNewLine]", 
        "\[IndentingNewLine]", 
        RowBox[{"contcar", "=", 
         RowBox[{"Import", "[", 
          RowBox[{
           RowBox[{"cNEBpath", "<>", "\"\</\>\"", "<>", 
            RowBox[{"ToString", "[", 
             RowBox[{"dirName", "[", 
              RowBox[{"[", "1", "]"}], "]"}], "]"}], "<>", 
            "\"\</01/CONTCAR\>\""}], ",", "\"\<Table\>\""}], "]"}]}], ";", 
        RowBox[{"(*", 
         RowBox[{"Find", " ", "position", " ", "of", " ", "ion"}], "*)"}], 
        "\[IndentingNewLine]", 
        RowBox[{"ionPos", "=", 
         RowBox[{
          RowBox[{"Total", "[", 
           RowBox[{"contcar", "[", 
            RowBox[{"[", "7", "]"}], "]"}], "]"}], "+", 
          RowBox[{
           RowBox[{"Position", "[", 
            RowBox[{"contcar", ",", 
             RowBox[{"{", "\"\<Direct\>\"", "}"}]}], "]"}], "[", 
           RowBox[{"[", 
            RowBox[{"1", ",", "1"}], "]"}], "]"}]}]}], ";", 
        "\[IndentingNewLine]", "\[IndentingNewLine]", 
        RowBox[{"Map", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"NewPOSCAR", "[", 
            RowBox[{
             RowBox[{"cNEBpath", "<>", "\"\</\>\"", "<>", 
              RowBox[{"ToString", "[", 
               RowBox[{"dirName", "[", 
                RowBox[{"[", "#", "]"}], "]"}], "]"}]}], ",", 
             RowBox[{"{", 
              RowBox[{
              "\"\<00\>\"", ",", "\"\<01\>\"", ",", "\"\<02\>\"", ",", 
               "\"\<03\>\"", ",", "\"\<04\>\""}], "}"}], ",", "ionPos", ",", 
             "a", ",", "\"\<CONTCAR\>\"", ",", 
             RowBox[{"labels", "[", 
              RowBox[{"[", "#", "]"}], "]"}]}], "]"}], "&"}], ",", 
          RowBox[{"Range", "[", 
           RowBox[{"Length", "@", "dirName"}], "]"}]}], "]"}], ";"}]}], 
      "\[IndentingNewLine]", "]"}]}], ";"}], "\[IndentingNewLine]", 
   "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{
    "Generate", " ", "dump", " ", "file", " ", "for", " ", "LAMMPS", " ", 
     "visulization"}], "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"RadiusfromMEP", "[", 
      RowBox[{"strName_", ",", "MEPdata_", ",", 
       RowBox[{"a_", ":", "20"}]}], "]"}], ":=", 
     RowBox[{"Module", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"zeolitesRow", ",", "energy", ",", "Eb", ",", 
         RowBox[{"allTrajEb", "=", 
          RowBox[{"{", "}"}]}], ",", "i", ",", "j", ",", "trajEb", ",", 
         RowBox[{"allTrajEbRad", "=", 
          RowBox[{"{", "}"}]}], ",", "Radius"}], "}"}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"zeolitesRow", "=", 
         RowBox[{
          RowBox[{"Position", "[", 
           RowBox[{"MEPdata", ",", "strName"}], "]"}], "[", 
          RowBox[{"[", 
           RowBox[{"1", ",", "1"}], "]"}], "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"energy", "=", 
         RowBox[{
          RowBox[{"MEPdata", "[", 
           RowBox[{"[", 
            RowBox[{
             RowBox[{"zeolitesRow", "+", "1"}], ";;", 
             RowBox[{"zeolitesRow", "+", "5"}]}], "]"}], "]"}], "[", 
          RowBox[{"[", 
           RowBox[{"All", ",", 
            RowBox[{"2", ";;", 
             RowBox[{"-", "1"}]}]}], "]"}], "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"energy", "=", 
         RowBox[{"Map", "[", 
          RowBox[{
           RowBox[{
            RowBox[{"DeleteCases", "[", 
             RowBox[{
              RowBox[{"energy", "[", 
               RowBox[{"[", "#", "]"}], "]"}], ",", "\"\<\>\""}], "]"}], 
            "&"}], ",", 
           RowBox[{"Range", "[", 
            RowBox[{"Length", "@", "energy"}], "]"}]}], "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"Eb", "=", 
         RowBox[{"energy", "\[Transpose]"}]}], ";", "\[IndentingNewLine]", 
        "\[IndentingNewLine]", 
        RowBox[{"(*", 
         RowBox[{
         "linear", " ", "insert", " ", "energy", " ", "betwwen", " ", "two", 
          " ", "images"}], "*)"}], "\[IndentingNewLine]", 
        RowBox[{"For", "[", 
         RowBox[{
          RowBox[{"i", "=", "1"}], ",", 
          RowBox[{"i", "\[LessEqual]", 
           RowBox[{"Length", "@", "Eb"}]}], ",", 
          RowBox[{"i", "=", 
           RowBox[{"i", "+", "1"}]}], ",", "\[IndentingNewLine]", 
          RowBox[{"For", "[", 
           RowBox[{
            RowBox[{"j", "=", "1"}], ",", 
            RowBox[{"j", "\[LessEqual]", "4"}], ",", 
            RowBox[{"j", "=", 
             RowBox[{"j", "+", "1"}]}], ",", "\[IndentingNewLine]", "     ", 
            RowBox[{
             RowBox[{"trajEb", "=", 
              RowBox[{"Map", "[", 
               RowBox[{
                RowBox[{
                 RowBox[{"(", 
                  RowBox[{
                   RowBox[{"Eb", "[", 
                    RowBox[{"[", 
                    RowBox[{"i", ",", "j"}], "]"}], "]"}], "+", 
                   RowBox[{
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"Eb", "[", 
                    RowBox[{"[", 
                    RowBox[{"i", ",", 
                    RowBox[{"j", "+", "1"}]}], "]"}], "]"}], "-", 
                    RowBox[{"Eb", "[", 
                    RowBox[{"[", 
                    RowBox[{"i", ",", "j"}], "]"}], "]"}]}], ")"}], "/", 
                    RowBox[{"(", 
                    RowBox[{"a", "+", "1"}], ")"}]}], "*", "#"}]}], ")"}], 
                 "&"}], ",", 
                RowBox[{"Range", "[", 
                 RowBox[{"0", ",", 
                  RowBox[{"a", "+", "1"}]}], "]"}]}], "]"}]}], ";", 
             "\[IndentingNewLine]", "     ", 
             RowBox[{"allTrajEb", "=", 
              RowBox[{"Append", "[", 
               RowBox[{"allTrajEb", ",", "trajEb"}], "]"}]}], ";"}]}], 
           "\[IndentingNewLine]", "     ", "]"}]}], "\[IndentingNewLine]", 
         "  ", "]"}], ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
        RowBox[{"allTrajEb", "=", 
         RowBox[{"allTrajEb", "//", "Flatten"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"(*", 
         RowBox[{
          RowBox[{"E", "\[LessEqual]", 
           RowBox[{"0.1", "eV"}]}], ",", " ", 
          RowBox[{
           RowBox[{"Rad", "=", "0.4"}], ";", " ", 
           RowBox[{"E", ">", 
            RowBox[{"0.1", " ", "eV"}]}]}], ",", " ", 
          RowBox[{"Rad", "~", 
           SuperscriptBox["me", 
            RowBox[{
             RowBox[{"-", "Eb"}], "/", "n"}]]}]}], "*)"}], 
        "\[IndentingNewLine]", 
        RowBox[{"For", "[", 
         RowBox[{
          RowBox[{"i", "=", "1"}], ",", 
          RowBox[{"i", "\[LessEqual]", 
           RowBox[{"Length", "@", "allTrajEb"}]}], ",", 
          RowBox[{"i", "=", 
           RowBox[{"i", "+", "1"}]}], ",", "\[IndentingNewLine]", "      ", 
          RowBox[{
           RowBox[{"If", "[", 
            RowBox[{
             RowBox[{
              RowBox[{"allTrajEb", "[", 
               RowBox[{"[", "i", "]"}], "]"}], "\[LessEqual]", "0.1"}], ",", 
             RowBox[{"Radius", "=", "0.4"}], ",", 
             RowBox[{"Radius", "=", 
              RowBox[{"N", "[", 
               RowBox[{
                RowBox[{"Rationalize", "[", 
                 RowBox[{
                  RowBox[{
                   FractionBox["0.4", 
                    SuperscriptBox["\[ExponentialE]", 
                    RowBox[{
                    RowBox[{"-", 
                    SuperscriptBox["0.1", "1"]}], "/", 
                    RowBox[{"(", 
                    RowBox[{"0.026", "*", "8"}], ")"}]}]]], "*", 
                   SuperscriptBox["\[ExponentialE]", 
                    RowBox[{
                    RowBox[{"-", 
                    SuperscriptBox[
                    RowBox[{"allTrajEb", "[", 
                    RowBox[{"[", "i", "]"}], "]"}], "1"]}], "/", 
                    RowBox[{"(", 
                    RowBox[{"0.026", "*", "8"}], ")"}]}]]}], ",", 
                  SuperscriptBox["10", 
                   RowBox[{"-", "100"}]]}], "]"}], ",", "2"}], "]"}]}]}], 
            "]"}], ";", "\[IndentingNewLine]", "      ", 
           RowBox[{"allTrajEbRad", "=", 
            RowBox[{"Append", "[", 
             RowBox[{"allTrajEbRad", ",", 
              RowBox[{"{", 
               RowBox[{
                RowBox[{"allTrajEb", "[", 
                 RowBox[{"[", "i", "]"}], "]"}], ",", "Radius"}], "}"}]}], 
             "]"}]}], ";"}]}], "\[IndentingNewLine]", "  ", "]"}], ";", 
        "\[IndentingNewLine]", "\[IndentingNewLine]", "allTrajEbRad"}]}], 
      "\[IndentingNewLine]", "]"}]}], ";"}], "\[IndentingNewLine]", 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"incell", "[", "var_", "]"}], ":=", 
     RowBox[{"Which", "[", 
      RowBox[{
       RowBox[{"1", "\[GreaterEqual]", "var", "\[GreaterEqual]", "0"}], ",", 
       "var", ",", 
       RowBox[{"var", ">", "1"}], ",", 
       RowBox[{"var", "-", "1"}], ",", 
       RowBox[{"var", "<", "0"}], ",", 
       RowBox[{"var", "+", "1"}]}], "]"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"SymNetwork", "[", 
      RowBox[{
      "folderPath_", ",", "strName_", ",", "ion_", ",", "symGroupN_"}], "]"}],
      ":=", 
     RowBox[{"Module", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
        "cNEBpath", ",", "dirName", ",", "allTrajAtom", ",", "MEPdata", ",", 
         "allTrajEbRad", ",", "traj", ",", 
         RowBox[{"network", "=", 
          RowBox[{"{", "}"}]}], ",", "i", ",", "trajAtomSym", ",", "m", ",", 
         "n", ",", "trajSymRad"}], "}"}], ",", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"cNEBpath", "=", 
         RowBox[{
         "folderPath", "<>", "\"\</\>\"", "<>", "strName", "<>", "\"\<_\>\"", 
          "<>", "ion", "<>", "\"\</5_cNEB_Opt\>\""}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"SetDirectory", "[", "cNEBpath", "]"}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"dirName", "=", 
         RowBox[{"Select", "[", 
          RowBox[{
           RowBox[{"FileNames", "[", "]"}], ",", "DirectoryQ"}], "]"}]}], ";",
         "\[IndentingNewLine]", 
        RowBox[{"allTrajAtom", "=", 
         RowBox[{"Flatten", "[", 
          RowBox[{
           RowBox[{"Map", "[", 
            RowBox[{
             RowBox[{
              RowBox[{"MyImport", "[", 
               RowBox[{
                RowBox[{"cNEBpath", "<>", "\"\</\>\"", "<>", 
                 RowBox[{"dirName", "[", 
                  RowBox[{"[", "#", "]"}], "]"}], "<>", 
                 "\"\</trajectory_atoms\>\""}], ",", "\"\<Table\>\""}], "]"}],
               "&"}], ",", 
             RowBox[{"Range", "[", 
              RowBox[{"Length", "@", "dirName"}], "]"}]}], "]"}], ",", "1"}], 
          "]"}]}], ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
        RowBox[{"MEPdata", "=", 
         RowBox[{
          RowBox[{"MyImport", "[", 
           RowBox[{
            RowBox[{
            "folderPath", "<>", "\"\</\>\"", "<>", "strName", "<>", 
             "\"\<_\>\"", "<>", "ion", "<>", "\"\</energy_EDI_Li.xlsx\>\""}], 
            ",", "\"\<XLSX\>\""}], "]"}], "[", 
          RowBox[{"[", "3", "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"allTrajEbRad", "=", 
         RowBox[{"RadiusfromMEP", "[", 
          RowBox[{"strName", ",", "MEPdata"}], "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"traj", "=", 
         RowBox[{"Join", "[", 
          RowBox[{"allTrajAtom", ",", "allTrajEbRad", ",", "2"}], "]"}]}], 
        ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
        RowBox[{"For", "[", 
         RowBox[{
          RowBox[{"i", "=", "1"}], ",", 
          RowBox[{"i", "\[LessEqual]", 
           RowBox[{"Length", "@", "traj"}]}], ",", 
          RowBox[{"i", "=", 
           RowBox[{"i", "+", "1"}]}], ",", "\[IndentingNewLine]", "     ", 
          RowBox[{
           RowBox[{"trajAtomSym", "=", 
            RowBox[{"symmetry", "[", 
             RowBox[{"folderPath", ",", "symGroupN", ",", 
              RowBox[{"traj", "[", 
               RowBox[{"[", 
                RowBox[{"i", ",", 
                 RowBox[{"{", 
                  RowBox[{"1", ",", "2", ",", "3"}], "}"}]}], "]"}], "]"}]}], 
             "]"}]}], ";", "\[IndentingNewLine]", "     ", 
           RowBox[{"trajAtomSym", "=", 
            RowBox[{"Round", "[", 
             RowBox[{"trajAtomSym", ",", "0.0001"}], "]"}]}], ";", 
           "\[IndentingNewLine]", "     ", 
           RowBox[{"(*", 
            RowBox[{
             RowBox[{"trajAtomSym", "=", 
              RowBox[{"woPerXYZ", "[", "trajAtomSym", "]"}]}], ";"}], "*)"}], 
           "\[IndentingNewLine]", "     ", 
           RowBox[{"trajAtomSym", "=", 
            RowBox[{"Map", "[", 
             RowBox[{"incell", ",", "trajAtomSym", ",", 
              RowBox[{"{", "2", "}"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
           "     ", 
           RowBox[{"trajAtomSym", "=", 
            RowBox[{"Map", "[", 
             RowBox[{"incell", ",", "trajAtomSym", ",", 
              RowBox[{"{", "2", "}"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
           "\[IndentingNewLine]", "     ", 
           RowBox[{"trajAtomSym", "=", 
            RowBox[{"trajAtomSym", "//", "DeleteDuplicates"}]}], ";", 
           "\[IndentingNewLine]", "     ", 
           RowBox[{"trajSymRad", "=", 
            RowBox[{"Map", "[", 
             RowBox[{
              RowBox[{
               RowBox[{"Join", "[", 
                RowBox[{
                 RowBox[{"trajAtomSym", "[", 
                  RowBox[{"[", "#", "]"}], "]"}], ",", 
                 RowBox[{"traj", "[", 
                  RowBox[{"[", 
                   RowBox[{"i", ",", 
                    RowBox[{"{", "5", "}"}]}], "]"}], "]"}]}], "]"}], "&"}], 
              ",", 
              RowBox[{"Range", "[", 
               RowBox[{"Length", "@", "trajAtomSym"}], "]"}]}], "]"}]}], ";", 
           "\[IndentingNewLine]", "     ", 
           RowBox[{"network", "=", 
            RowBox[{"Append", "[", 
             RowBox[{"network", ",", "trajSymRad"}], "]"}]}], ";"}]}], 
         "\[IndentingNewLine]", "     ", "]"}], ";", "\[IndentingNewLine]", 
        "\[IndentingNewLine]", 
        RowBox[{"Sort", "[", 
         RowBox[{
          RowBox[{"Flatten", "[", 
           RowBox[{"network", ",", "1"}], "]"}], ",", 
          RowBox[{
           RowBox[{
            RowBox[{"#1", "[", 
             RowBox[{"[", "4", "]"}], "]"}], "<", 
            RowBox[{"#2", "[", 
             RowBox[{"[", "4", "]"}], "]"}]}], "&"}]}], "]"}]}]}], 
      "\[IndentingNewLine]", "]"}]}], ";"}], "\[IndentingNewLine]", 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"GenerateDumpFile", "[", 
      RowBox[{
      "folderPath_", ",", "strName_", ",", "ion_", ",", "symGroupN_"}], "]"}],
      ":=", 
     RowBox[{"Module", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
        "mat", ",", "cell", ",", "xlo", ",", "ylo", ",", "zlo", ",", "xhi", 
         ",", "yhi", ",", "zhi", ",", "xy", ",", "xz", ",", "yz", ",", 
         "xloBound", ",", "xhiBound", ",", "yloBound", ",", "yhiBound", ",", 
         "zloBound", ",", "zhiBound", ",", "cellDump", ",", "atom1", ",", 
         "atom2", ",", "atom3", ",", "natom1", ",", "natom2", ",", "natom3", 
         ",", "pos", ",", "SiO2xyz", ",", "ratom1", ",", "ratom2", ",", 
         "ratom3", ",", "network", ",", "Natoms", ",", "records", ",", 
         "labels", ",", "i", ",", "strPath"}], "}"}], ",", 
       "\[IndentingNewLine]", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"mat", "=", 
         RowBox[{"MyImport", "[", 
          RowBox[{
           RowBox[{
           "folderPath", "<>", "\"\</\>\"", "<>", "strName", "<>", 
            "\"\<_\>\"", "<>", "ion", "<>", 
            "\"\</1_zeolite_GeoOpt/CONTCAR\>\""}], ",", "\"\<Table\>\""}], 
          "]"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"cell", "=", 
         RowBox[{
          RowBox[{"mat", "[", 
           RowBox[{"[", 
            RowBox[{"2", ",", "1"}], "]"}], "]"}], "*", 
          RowBox[{"mat", "[", 
           RowBox[{"[", 
            RowBox[{
             RowBox[{"{", 
              RowBox[{"3", ",", "4", ",", "5"}], "}"}], ",", "All"}], "]"}], 
           "]"}]}]}], ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
        RowBox[{"xlo", "=", 
         RowBox[{"ylo", "=", 
          RowBox[{"zlo", "=", "0"}]}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"xhi", "=", 
         RowBox[{"cell", "[", 
          RowBox[{"[", 
           RowBox[{"1", ",", "1"}], "]"}], "]"}]}], ";", 
        RowBox[{"yhi", "=", 
         RowBox[{"cell", "[", 
          RowBox[{"[", 
           RowBox[{"2", ",", "2"}], "]"}], "]"}]}], ";", 
        RowBox[{"zhi", "=", 
         RowBox[{"cell", "[", 
          RowBox[{"[", 
           RowBox[{"3", ",", "3"}], "]"}], "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"xy", "=", 
         RowBox[{"cell", "[", 
          RowBox[{"[", 
           RowBox[{"2", ",", "1"}], "]"}], "]"}]}], ";", 
        RowBox[{"xz", "=", 
         RowBox[{"cell", "[", 
          RowBox[{"[", 
           RowBox[{"3", ",", "1"}], "]"}], "]"}]}], ";", 
        RowBox[{"yz", "=", 
         RowBox[{"cell", "[", 
          RowBox[{"[", 
           RowBox[{"3", ",", "2"}], "]"}], "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"xloBound", "=", 
         RowBox[{"xlo", "+", 
          RowBox[{"Min", "[", 
           RowBox[{"0.0", ",", "xy", ",", "xz", ",", 
            RowBox[{"xy", "+", "xz"}]}], "]"}]}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"xhiBound", "=", 
         RowBox[{"xhi", "+", 
          RowBox[{"Max", "[", 
           RowBox[{"0.0", ",", "xy", ",", "xz", ",", 
            RowBox[{"xy", "+", "xz"}]}], "]"}]}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"yloBound", "=", 
         RowBox[{"ylo", "+", 
          RowBox[{"Min", "[", 
           RowBox[{"0.0", ",", "yz"}], "]"}]}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"yhiBound", "=", 
         RowBox[{"yhi", "+", 
          RowBox[{"Max", "[", 
           RowBox[{"0.0", ",", "yz"}], "]"}]}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"zloBound", "=", "zlo"}], ";", "\[IndentingNewLine]", 
        RowBox[{"zhiBound", "=", "zhi"}], ";", "\[IndentingNewLine]", 
        RowBox[{"cellDump", "=", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{"xloBound", ",", "xhiBound", ",", "xy"}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"yloBound", ",", "yhiBound", ",", "xz"}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"zloBound", ",", "zhiBound", ",", "yz"}], "}"}]}], 
          "}"}]}], ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"atom1", ",", "atom2"}], 
          RowBox[{"(*", 
           RowBox[{",", "atom3"}], "*)"}], "}"}], "=", 
         RowBox[{"mat", "[", 
          RowBox[{"[", "6", "]"}], "]"}]}], ";", 
        RowBox[{"(*", 
         RowBox[{"two", " ", "elements"}], "*)"}], "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"natom1", ",", "natom2"}], 
          RowBox[{"(*", 
           RowBox[{",", "natom3"}], "*)"}], "}"}], "=", 
         RowBox[{"mat", "[", 
          RowBox[{"[", "7", "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"pos", "=", 
         RowBox[{
          RowBox[{"Position", "[", 
           RowBox[{"mat", ",", 
            RowBox[{"{", "\"\<Direct\>\"", "}"}]}], "]"}], "[", 
          RowBox[{"[", 
           RowBox[{"1", ",", "1"}], "]"}], "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"SiO2xyz", "=", 
         RowBox[{"mat", "[", 
          RowBox[{"[", 
           RowBox[{
            RowBox[{"pos", "+", "1"}], ";;", 
            RowBox[{"pos", "+", "natom1", "+", "natom2"}]}], "]"}], "]"}]}], 
        ";", "\[IndentingNewLine]", 
        RowBox[{"ratom1", "=", 
         RowBox[{"ratom2", "=", 
          RowBox[{"(*", 
           RowBox[{"ratom3", "="}], "*)"}], "0.2"}]}], ";", 
        "\[IndentingNewLine]", "\[IndentingNewLine]", 
        RowBox[{"network", "=", 
         RowBox[{"SymNetwork", "[", 
          RowBox[{
          "folderPath", ",", "strName", ",", "ion", ",", "symGroupN"}], 
          "]"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"Natoms", "=", 
         RowBox[{
          RowBox[{"Total", "[", 
           RowBox[{"mat", "[", 
            RowBox[{"[", "7", "]"}], "]"}], "]"}], "+", 
          RowBox[{"Length", "@", "network"}]}]}], ";", "\[IndentingNewLine]", 
        "\[IndentingNewLine]", 
        RowBox[{"records", "=", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"{", "\"\<ITEM: TIMESTEP\>\"", "}"}], ",", 
           RowBox[{"{", "\"\<1\>\"", "}"}], ",", 
           RowBox[{"{", "\"\<ITEM: NUMBER OF ATOMS\>\"", "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"ToString", "[", "Natoms", "]"}], "}"}], ",", 
           RowBox[{"{", "\"\<ITEM: BOX BOUNDS xy xz yz\>\"", "}"}]}], "}"}]}],
         ";", "\[IndentingNewLine]", 
        RowBox[{"records", "=", 
         RowBox[{"Join", "[", 
          RowBox[{"records", ",", "cellDump", ",", 
           RowBox[{"{", 
            RowBox[{"{", "\"\<ITEM: ATOMS id element x y z radius\>\"", "}"}],
             "}"}], ",", "SiO2xyz", ",", "network"}], "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"records", "[", 
          RowBox[{"[", 
           RowBox[{
            RowBox[{"9", "+", "1"}], ";;", 
            RowBox[{"9", "+", "natom1"}]}], "]"}], "]"}], "=", 
         RowBox[{"Map", "[", 
          RowBox[{
           RowBox[{
            RowBox[{"Join", "[", 
             RowBox[{
              RowBox[{"{", "atom1", "}"}], ",", 
              RowBox[{"records", "[", 
               RowBox[{"[", "#", "]"}], "]"}], ",", 
              RowBox[{"{", 
               RowBox[{"ToString", "[", "ratom1", "]"}], "}"}]}], "]"}], 
            "&"}], ",", 
           RowBox[{"Range", "[", 
            RowBox[{
             RowBox[{"9", "+", "1"}], ",", 
             RowBox[{"9", "+", "natom1"}]}], "]"}]}], "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"records", "[", 
          RowBox[{"[", 
           RowBox[{
            RowBox[{"9", "+", "natom1", "+", "1"}], ";;", 
            RowBox[{"9", "+", "natom1", "+", "natom2"}]}], "]"}], "]"}], "=", 
         RowBox[{"Map", "[", 
          RowBox[{
           RowBox[{
            RowBox[{"Join", "[", 
             RowBox[{
              RowBox[{"{", "atom2", "}"}], ",", 
              RowBox[{"records", "[", 
               RowBox[{"[", "#", "]"}], "]"}], ",", 
              RowBox[{"{", 
               RowBox[{"ToString", "[", "ratom2", "]"}], "}"}]}], "]"}], 
            "&"}], ",", 
           RowBox[{"Range", "[", 
            RowBox[{
             RowBox[{"9", "+", "natom1", "+", "1"}], ",", 
             RowBox[{"9", "+", "natom1", "+", "natom2"}]}], "]"}]}], "]"}]}], 
        ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
        RowBox[{"labels", "=", 
         RowBox[{"Map", "[", 
          RowBox[{
           RowBox[{
            RowBox[{"\"\<A\>\"", "<>", 
             RowBox[{"ToString", "[", "#", "]"}]}], "&"}], ",", 
           RowBox[{"Range", "[", 
            RowBox[{"Length", "@", "network"}], "]"}]}], "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"For", "[", 
         RowBox[{
          RowBox[{"i", "=", "1"}], ",", 
          RowBox[{"i", "\[LessEqual]", 
           RowBox[{"Length", "@", "labels"}]}], ",", 
          RowBox[{"i", "=", 
           RowBox[{"i", "+", "1"}]}], ",", 
          RowBox[{
           RowBox[{"records", "[", 
            RowBox[{"[", 
             RowBox[{"9", "+", "natom1", "+", "natom2", "+", 
              RowBox[{"(*", 
               RowBox[{"natom3", "+"}], "*)"}], "i"}], "]"}], "]"}], "=", 
           RowBox[{"Join", "[", 
            RowBox[{
             RowBox[{"{", 
              RowBox[{"labels", "[", 
               RowBox[{"[", "i", "]"}], "]"}], "}"}], ",", 
             RowBox[{"records", "[", 
              RowBox[{"[", 
               RowBox[{"9", "+", "natom1", "+", "natom2", "+", 
                RowBox[{"(*", 
                 RowBox[{"natom3", "+"}], "*)"}], "i"}], "]"}], "]"}]}], 
            "]"}]}]}], "]"}], ";", "\[IndentingNewLine]", 
        RowBox[{"For", "[", 
         RowBox[{
          RowBox[{"i", "=", "1"}], ",", 
          RowBox[{"i", "\[LessEqual]", "Natoms"}], ",", 
          RowBox[{"i", "=", 
           RowBox[{"i", "+", "1"}]}], ",", 
          RowBox[{
           RowBox[{"records", "[", 
            RowBox[{"[", 
             RowBox[{"9", "+", "i"}], "]"}], "]"}], "=", 
           RowBox[{"Join", "[", 
            RowBox[{
             RowBox[{"{", "i", "}"}], ",", 
             RowBox[{"records", "[", 
              RowBox[{"[", 
               RowBox[{"9", "+", "i"}], "]"}], "]"}]}], "]"}]}]}], "]"}], ";",
         "\[IndentingNewLine]", 
        RowBox[{"For", "[", 
         RowBox[{
          RowBox[{"i", "=", "10"}], ",", 
          RowBox[{"i", "\[LessEqual]", 
           RowBox[{"Length", "@", "records"}]}], ",", 
          RowBox[{"i", "=", 
           RowBox[{"i", "+", "1"}]}], ",", 
          RowBox[{
           RowBox[{"records", "[", 
            RowBox[{"[", 
             RowBox[{"i", ",", 
              RowBox[{"{", 
               RowBox[{"3", ",", "4", ",", "5"}], "}"}]}], "]"}], "]"}], "=", 
           RowBox[{
            RowBox[{"records", "[", 
             RowBox[{"[", 
              RowBox[{"i", ",", 
               RowBox[{"{", 
                RowBox[{"3", ",", "4", ",", "5"}], "}"}]}], "]"}], "]"}], ".",
             "cell"}]}]}], "]"}], ";", "\[IndentingNewLine]", 
        "\[IndentingNewLine]", 
        RowBox[{"Export", "[", 
         RowBox[{
          RowBox[{
          "folderPath", "<>", "\"\</\>\"", "<>", "strName", "<>", "\"\<_\>\"",
            "<>", "ion", "<>", "\"\</6_3D_network/dump_\>\"", "<>", "strName",
            "<>", "\"\<-traj.xyz\>\""}], ",", "records", ",", 
          "\"\<Table\>\""}], "]"}]}]}], "\[IndentingNewLine]", "]"}]}], 
    ";"}]}]}]], "Input",
 CellChangeTimes->{{3.94769377929086*^9, 3.947693848009571*^9}, 
   3.94769413918788*^9, {3.94769417694423*^9, 3.947694202593912*^9}, {
   3.947694257287883*^9, 3.947694270368998*^9}, {3.947694707890826*^9, 
   3.947694861288065*^9}, 3.9476949093286543`*^9, {3.94769499775714*^9, 
   3.947695010938886*^9}, {3.947695047900105*^9, 3.947695051664003*^9}, {
   3.947695088742105*^9, 3.947695089167163*^9}, {3.94769545638019*^9, 
   3.947695540884203*^9}, {3.947695682942446*^9, 3.9476956842688*^9}, {
   3.947695967850613*^9, 3.947695972407366*^9}, {3.947696419569096*^9, 
   3.947696428379992*^9}, {3.947696469585915*^9, 3.947696469952342*^9}, {
   3.947697462903848*^9, 3.947697472711372*^9}, {3.947697536757566*^9, 
   3.947697543390462*^9}, {3.947710740313644*^9, 3.947710740324988*^9}, {
   3.947718955904454*^9, 3.947718994685976*^9}, {3.94771903956734*^9, 
   3.947719040074964*^9}, {3.947719087574164*^9, 3.947719099073576*^9}, {
   3.947719148969389*^9, 3.947719283053232*^9}, {3.9477193237108994`*^9, 
   3.947719325044433*^9}, {3.947719378582405*^9, 3.947719450439512*^9}, {
   3.947719577696536*^9, 3.94771961748598*^9}, {3.94773349003056*^9, 
   3.9477335282312202`*^9}, 3.947733573335247*^9, {3.947734786807888*^9, 
   3.94773494616835*^9}, {3.947736211197976*^9, 3.947736213027556*^9}, {
   3.947736347259221*^9, 3.947736347431918*^9}, {3.947736466216703*^9, 
   3.947736474250189*^9}, {3.947736747474572*^9, 3.947736774871913*^9}, {
   3.947736886979152*^9, 3.947736891857921*^9}, {3.947736931539419*^9, 
   3.947736992706711*^9}, {3.947737048386366*^9, 3.947737056748001*^9}, {
   3.947737090342071*^9, 3.947737096337506*^9}, {3.947737168304121*^9, 
   3.947737212017692*^9}, {3.947737262139913*^9, 3.947737300431869*^9}, {
   3.947737336170749*^9, 3.947737340484083*^9}, {3.947737488515731*^9, 
   3.947737537078482*^9}, {3.947737570902687*^9, 3.947737588438694*^9}, {
   3.947737739208778*^9, 3.947737773044227*^9}, {3.947737823766682*^9, 
   3.94773786092129*^9}, {3.947737901186387*^9, 3.947737923567683*^9}, {
   3.947738312499661*^9, 3.947738319411512*^9}, {3.947738368525607*^9, 
   3.947738444799744*^9}, {3.947738546854559*^9, 3.947738559094512*^9}, {
   3.947738670429178*^9, 3.947738713581148*^9}, 3.947738756924058*^9, {
   3.947738812712616*^9, 3.9477388247317266`*^9}, {3.947738877784267*^9, 
   3.947738894751037*^9}, {3.94773899400812*^9, 3.9477390141814*^9}, {
   3.94773911704759*^9, 3.947739138574033*^9}, {3.947739225541056*^9, 
   3.947739280927984*^9}, 3.947739332212798*^9, {3.947739470220666*^9, 
   3.947739503363391*^9}, {3.947740521455106*^9, 3.947740524878663*^9}, {
   3.947740951101582*^9, 3.947741122559249*^9}, {3.947741203093945*^9, 
   3.947741203437245*^9}, {3.947741251367634*^9, 3.9477412953480186`*^9}, {
   3.947741370203582*^9, 3.947741370874282*^9}, {3.94774151718888*^9, 
   3.947741541433199*^9}, {3.947741667666229*^9, 3.947741704080126*^9}, 
   3.947742041951258*^9, {3.947752805864805*^9, 3.947752807584395*^9}, {
   3.9477544144743843`*^9, 3.947754426086719*^9}, {3.947754543304832*^9, 
   3.947754545177747*^9}, {3.947754588067212*^9, 3.947754589154517*^9}, {
   3.947754654738586*^9, 3.947754654762946*^9}, {3.947754866522574*^9, 
   3.947754930498942*^9}, {3.947754981944654*^9, 3.9477549893144007`*^9}, {
   3.9477550242683697`*^9, 3.947755026820146*^9}, {3.9477551339811573`*^9, 
   3.9477551778971176`*^9}, {3.947755230555895*^9, 3.947755230572604*^9}, 
   3.947755348399467*^9, {3.947755387711492*^9, 3.947755416742092*^9}, 
   3.947755471841261*^9, {3.947755520149045*^9, 3.9477555786528*^9}, {
   3.947755704516766*^9, 3.947755762946866*^9}, {3.947755794048025*^9, 
   3.9477557995012817`*^9}, {3.947755862516499*^9, 3.94775587647754*^9}, {
   3.947755921892239*^9, 3.947755945359551*^9}, {3.947755999161488*^9, 
   3.947755999453413*^9}, {3.947756243787502*^9, 3.947756297652922*^9}, {
   3.947756399046614*^9, 3.947756422810554*^9}, 3.947756460929657*^9, 
   3.9477636311358023`*^9, {3.9477639929146957`*^9, 3.947763998526327*^9}, {
   3.947764061927327*^9, 3.9477640707653313`*^9}, 3.947764111526712*^9},
 CellLabel->"In[24]:=",ExpressionUUID->"0a944ecb-4d44-430b-8997-055f3d31e6ee"]
}, Closed]],

Cell[CellGroupData[{

Cell[TextData[StyleBox["Run Program",
 FontFamily->"Tahoma",
 FontSize->20,
 FontColor->RGBColor[0, 0.501961, 0.752941]]], "Section",
 CellChangeTimes->{
  3.861677451689701*^9, {3.861677484775999*^9, 3.8616775165810046`*^9}, {
   3.8616775642747974`*^9, 3.8616775644778476`*^9}, {3.861677623886115*^9, 
   3.861677637320485*^9}, 3.862536274595021*^9, 3.8648689223095503`*^9, {
   3.8648689583685627`*^9, 3.864869038748819*^9}, {3.864869299768076*^9, 
   3.864869300002394*^9}, {3.864870234042578*^9, 3.864870242706471*^9}, {
   3.8648723025226116`*^9, 3.864872303570187*^9}, {3.864872495529555*^9, 
   3.864872499096853*^9}, {3.864888177375281*^9, 3.864888182817638*^9}, {
   3.8680030147972336`*^9, 3.8680031168622985`*^9}, {3.868072087782483*^9, 
   3.868072089204934*^9}, {3.868151878254257*^9, 3.868151879504495*^9}, {
   3.868153174941499*^9, 3.868153208865707*^9}, 3.868415589689834*^9, {
   3.896647148893177*^9, 
   3.896647150162019*^9}},ExpressionUUID->"a2b616d5-0169-45f8-9e66-\
40cda8b17f5f"],

Cell[CellGroupData[{

Cell["Initial settings and generate folders", "Subsubsection",
 CellChangeTimes->{{3.947764631559256*^9, 3.947764651052347*^9}, 
   3.94776471620107*^9},ExpressionUUID->"4e7d7127-ee79-4aea-aef7-\
ec2b3a2d7b4a"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"folderPath", "=", 
    RowBox[{
     RowBox[{"DirectoryName", "[", 
      RowBox[{"NotebookFileName", "[", "]"}], "]"}], "<>", 
     "\"\<zeolites\>\""}]}], ";"}], 
  RowBox[{"(*", 
   RowBox[{"folder", " ", "to", " ", "put", " ", "the", " ", "caculations"}], 
   "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"{", 
     RowBox[{"meshIntvl", ",", "meshTol"}], "}"}], "=", 
    RowBox[{"{", 
     RowBox[{"1", ",", "0.2"}], "}"}]}], ";"}], 
  RowBox[{"(*", 
   RowBox[{
    RowBox[{"sampling", " ", "mesh", " ", "interval"}], ",", " ", 
    RowBox[{"symmetry", " ", "tolerance", " ", "for", " ", "mesh"}]}], 
   "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"{", 
     RowBox[{"bondOLi", ",", "bondONa", ",", "bondOK", ",", "bondTol"}], 
     "}"}], "=", 
    RowBox[{"{", 
     RowBox[{"2.0", ",", "2.4", ",", "2.7", ",", "0.2"}], "}"}]}], ";"}], 
  RowBox[{"(*", 
   RowBox[{
    RowBox[{
     RowBox[{"bond", " ", "lengths", " ", "of", " ", "O"}], "-", "Li"}], ",", 
    " ", 
    RowBox[{"O", "-", "Na"}], ",", " ", 
    RowBox[{
     RowBox[{
      RowBox[{"and", " ", "O"}], "-", "K"}], ";", " ", 
     RowBox[{"bond", " ", "length", " ", "tolerance"}]}]}], 
   "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"eqlTol", "=", "0.5"}], ";"}], 
  RowBox[{"(*", 
   RowBox[{
   "symmetry", " ", "tolerance", " ", "for", " ", "optimized", " ", 
    "adsorption", " ", "sites"}], "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"{", 
     RowBox[{"drmin", ",", "drmax"}], "}"}], "=", 
    RowBox[{"{", 
     RowBox[{"0.5", ",", "5"}], "}"}]}], ";"}], 
  RowBox[{"(*", 
   RowBox[{
   "range", " ", "of", " ", "hopping", " ", "distances", " ", "to", " ", 
    "consider"}], "*)"}], "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"list", "=", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"{", 
       RowBox[{"\"\<EDI\>\"", ",", "\"\<Li\>\"", ",", "115"}], "}"}], "}"}], 
     "\[Transpose]"}]}], ";"}], 
  RowBox[{"(*", 
   RowBox[{
    RowBox[{"zeolite", " ", "name"}], ",", " ", 
    RowBox[{"diffusion", " ", "ion"}], ",", " ", 
    RowBox[{
    "space", " ", "group", " ", "number", " ", "of", " ", "zeolite"}]}], 
   "*)"}], "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{"MapThread", "[", 
  RowBox[{
   RowBox[{
    RowBox[{"CreateDir", "[", 
     RowBox[{"folderPath", ",", "#1", ",", "#2"}], "]"}], "&"}], ",", 
   "list"}], "]"}]}], "Input",
 CellChangeTimes->{{3.868399716094222*^9, 3.868399727333042*^9}, {
   3.868407919962435*^9, 3.86840792580658*^9}, {3.86841130852336*^9, 
   3.8684113262165394`*^9}, 3.868421070873072*^9, {3.868421131680641*^9, 
   3.868421219235026*^9}, {3.868421580658224*^9, 3.868421589414407*^9}, 
   3.868421647701087*^9, {3.8684806829856005`*^9, 3.868480692906909*^9}, {
   3.868508055946482*^9, 3.868508057561642*^9}, {3.869090474823405*^9, 
   3.869090475153701*^9}, {3.8690905539333954`*^9, 3.8690905549006248`*^9}, {
   3.8690905940111475`*^9, 3.869090596719927*^9}, {3.869106740857942*^9, 
   3.8691067411231155`*^9}, {3.869278625973293*^9, 3.869278626207585*^9}, 
   3.869688699698434*^9, {3.869691043268269*^9, 3.869691047910861*^9}, {
   3.869697401069204*^9, 3.8696974088319254`*^9}, {3.869704088460476*^9, 
   3.869704096891085*^9}, 3.869714246468135*^9, {3.8698015287718*^9, 
   3.869801529052983*^9}, {3.87109216936121*^9, 3.871092169770602*^9}, {
   3.8713324781271877`*^9, 3.871332478378016*^9}, {3.871372669446061*^9, 
   3.8713726695866528`*^9}, {3.8716139772004147`*^9, 3.871613987729985*^9}, {
   3.872283489812792*^9, 3.87228349104939*^9}, {3.872303482606457*^9, 
   3.872303483733154*^9}, {3.896229240741451*^9, 3.896229243430398*^9}, {
   3.8962296046526537`*^9, 3.8962296083731127`*^9}, {3.902350785992174*^9, 
   3.9023507865227995`*^9}, {3.934842606425311*^9, 3.934842606517818*^9}, {
   3.934853454883766*^9, 3.934853455053767*^9}, {3.9348538065935564`*^9, 
   3.934853806896556*^9}, {3.93485560157785*^9, 3.934855601939849*^9}, 
   3.946604341583188*^9, {3.946605372899247*^9, 3.946605389673734*^9}, {
   3.946605505128107*^9, 3.9466055056206703`*^9}, {3.947622612294137*^9, 
   3.947622631006386*^9}, {3.947623001152823*^9, 3.947623001960091*^9}, {
   3.9476230851198883`*^9, 3.947623271780801*^9}, 3.947623367820616*^9, {
   3.94762343800708*^9, 3.947623441280183*^9}, {3.947623640535034*^9, 
   3.947623640907996*^9}, {3.947624194942244*^9, 3.947624294889446*^9}, {
   3.947624353807472*^9, 3.947624365576296*^9}, {3.9476244130594683`*^9, 
   3.94762441694599*^9}, {3.947624464559886*^9, 3.947624464910453*^9}, {
   3.947624588920479*^9, 3.947624591132436*^9}, {3.9476246221888943`*^9, 
   3.947624665289019*^9}, {3.947624717656557*^9, 3.947625015545106*^9}, {
   3.94762508405956*^9, 3.947625092185625*^9}, 3.947644188365221*^9, {
   3.947644515973303*^9, 3.947644522910338*^9}, 3.947648570152336*^9, {
   3.947678117061764*^9, 3.947678117749365*^9}, {3.947678206893138*^9, 
   3.94767820795231*^9}, {3.947689064979414*^9, 3.947689065686728*^9}, {
   3.94771222782729*^9, 3.947712230201031*^9}, {3.947713750397972*^9, 
   3.9477137512271395`*^9}, {3.947718837071601*^9, 3.947718850819069*^9}, {
   3.947720425554493*^9, 3.947720425903944*^9}, {3.947721047418857*^9, 
   3.947721050562389*^9}, {3.947742190257646*^9, 3.947742193659257*^9}, {
   3.947761126820423*^9, 3.947761154228765*^9}, {3.947764640168577*^9, 
   3.947764656626192*^9}},
 CellLabel->"In[50]:=",ExpressionUUID->"159008e2-58b6-4fd3-96d6-7cf015854836"]
}, Open  ]],

Cell[CellGroupData[{

Cell["\<\
A. Finish DFT calculation of zeolite in 1_zeolite _GeoOpt, then generate \
POSCARs with alkali ions at inequivalent sampling sites -> 2_quick _GeoOpt\
\>", "Subsubsection",
 CellChangeTimes->{{3.947764631559256*^9, 
  3.9477647101051397`*^9}},ExpressionUUID->"4dc765da-f44e-46be-88b6-\
a7b727221882"],

Cell[BoxData[
 RowBox[{
  RowBox[{"MapThread", "[", 
   RowBox[{
    RowBox[{
     RowBox[{"Step2POSCARs", "[", 
      RowBox[{"folderPath", ",", "#1", ",", "#2", ",", "#3", ",", 
       RowBox[{"{", 
        RowBox[{"bondOLi", ",", "bondTol"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"meshIntvl", ",", "meshTol"}], "}"}]}], "]"}], "&"}], ",", 
    "list"}], "]"}], ";"}]], "Input",
 CellChangeTimes->{
  3.872306934839864*^9, {3.872306983714216*^9, 3.8723069887364593`*^9}, {
   3.89622924600613*^9, 3.896229247758808*^9}, {3.896645212996247*^9, 
   3.896645215263668*^9}, {3.902350802366163*^9, 3.902350831529336*^9}, {
   3.9348426210930576`*^9, 3.934842622492064*^9}, {3.9348534580339174`*^9, 
   3.9348534582159166`*^9}, {3.934853502860015*^9, 3.9348535031520133`*^9}, {
   3.9348535509776945`*^9, 3.9348535511466947`*^9}, {3.9348538133272777`*^9, 
   3.934853813703618*^9}, {3.934855607147698*^9, 3.9348556074656973`*^9}, 
   3.946604345184967*^9, {3.946604425999986*^9, 3.946604441805335*^9}, {
   3.947646091915276*^9, 3.9476461119225197`*^9}, {3.947646193210495*^9, 
   3.9476463154586973`*^9}, {3.947646355005788*^9, 3.947646369107181*^9}, 
   3.947646412175894*^9, {3.947646500606605*^9, 3.947646603614861*^9}, {
   3.947646823301789*^9, 3.947646907012129*^9}, {3.947646959576849*^9, 
   3.947646960347197*^9}, 3.947648570153323*^9, {3.9476493761867037`*^9, 
   3.9476494193661337`*^9}, {3.947652726921715*^9, 3.947652802931189*^9}, {
   3.947653484279547*^9, 3.947653511464389*^9}, {3.947653562008158*^9, 
   3.947653562736507*^9}, 3.947653678181476*^9, 3.947654247491414*^9, 
   3.947654433451899*^9, {3.947655650394042*^9, 3.947655744429656*^9}, 
   3.947675316087301*^9, 3.9476753667894897`*^9, {3.947677912252622*^9, 
   3.947677918043584*^9}, {3.94767812358751*^9, 3.947678124651615*^9}, {
   3.947678184943161*^9, 3.9476781852534323`*^9}, {3.947711933073044*^9, 
   3.947711936236067*^9}, {3.9477135561942*^9, 3.947713562097744*^9}, {
   3.947713612047966*^9, 3.947713614000413*^9}, 3.947713701830035*^9, 
   3.947713761352765*^9, {3.94771707592023*^9, 3.947717104342834*^9}, {
   3.947718860517288*^9, 3.947718860761465*^9}, {3.94772020346938*^9, 
   3.947720232778292*^9}, {3.947720292828638*^9, 3.947720303950912*^9}, {
   3.947720738954906*^9, 3.947720775270283*^9}, {3.947720912054408*^9, 
   3.947720912292234*^9}, {3.947721054444289*^9, 3.947721054803222*^9}, 
   3.947752046633817*^9, {3.94776467443499*^9, 3.947764685125966*^9}},
 CellLabel->"In[57]:=",ExpressionUUID->"fa54aa8e-5231-45a2-adb4-705fa9271f0f"]
}, Open  ]],

Cell[CellGroupData[{

Cell["\<\
B. Finish DFT calculations in 2_quick _GeoOpt, then select inequivalent \
sampling sites for normal DFT calculations -> 3_normal _GeoOpt\
\>", "Subsubsection",
 CellChangeTimes->{{3.947764631559256*^9, 
  3.947764767118599*^9}},ExpressionUUID->"bd6e9789-0aac-428e-a468-\
332edb3860b6"],

Cell[BoxData[
 RowBox[{
  RowBox[{"MapThread", "[", 
   RowBox[{
    RowBox[{
     RowBox[{"Step3POSCARs", "[", 
      RowBox[{
      "folderPath", ",", "#1", ",", "#2", ",", "#3", ",", "eqlTol", ",", 
       "\"\<2_quick_GeoOpt\>\""}], "]"}], "&"}], ",", "list"}], "]"}], 
  ";"}]], "Input",
 CellChangeTimes->{
  3.868419990690806*^9, {3.868421624733595*^9, 3.8684216344207554`*^9}, 
   3.8684819038448534`*^9, {3.868486218106097*^9, 3.868486218299979*^9}, {
   3.86848839848476*^9, 3.868488398663476*^9}, {3.868923232528219*^9, 
   3.86892323278147*^9}, {3.86892615758457*^9, 3.868926157774641*^9}, {
   3.869104011764558*^9, 3.869104012232903*^9}, {3.869106814756424*^9, 
   3.869106814970248*^9}, {3.8691068797561088`*^9, 3.869106902249563*^9}, {
   3.869114983127511*^9, 3.869114986772743*^9}, {3.869278729801113*^9, 
   3.869278730035367*^9}, {3.869714481098275*^9, 3.869714481285734*^9}, 
   3.869803119380483*^9, 3.86986390327954*^9, 3.870120761429507*^9, {
   3.870207765912202*^9, 3.87020776600261*^9}, {3.871332622418994*^9, 
   3.8713326226689353`*^9}, {3.871527307500469*^9, 3.871527307725762*^9}, {
   3.896610504829649*^9, 3.896610505430845*^9}, {3.902467146483159*^9, 
   3.9024671476733837`*^9}, {3.934872064911059*^9, 3.9348720654790587`*^9}, 
   3.9466045072654257`*^9, {3.946605395452245*^9, 3.946605397607788*^9}, {
   3.94767547932316*^9, 3.947675485827586*^9}, 3.947675970324396*^9, 
   3.94767629879021*^9, 3.947676550630972*^9, {3.947677940342514*^9, 
   3.947678087855894*^9}, {3.9476781274726267`*^9, 3.94767816835961*^9}, {
   3.947696202756459*^9, 3.9476962030547247`*^9}, 3.947713801873076*^9, {
   3.947714663587136*^9, 3.94771467480949*^9}, {3.947715808333405*^9, 
   3.947715834702224*^9}, {3.947717051226413*^9, 3.947717054830221*^9}, {
   3.947718865705887*^9, 3.947718865886146*^9}, {3.947719785518881*^9, 
   3.947719822564502*^9}, {3.947719867303355*^9, 3.947719868741859*^9}, {
   3.947720243652052*^9, 3.947720272984874*^9}, {3.947720777173641*^9, 
   3.94772078209887*^9}, {3.947720835293026*^9, 3.947720846312243*^9}, {
   3.947720915836925*^9, 3.947720916738335*^9}, 3.947721058655183*^9, {
   3.947752107075371*^9, 3.947752107980133*^9}, {3.94776473388444*^9, 
   3.94776474237822*^9}},
 CellLabel->"In[58]:=",ExpressionUUID->"c2fe175f-a613-48a5-a69e-0371b51bbf12"]
}, Open  ]],

Cell[CellGroupData[{

Cell["\<\
C. Finish DFT calculations in 3_normal _GeoOpt, then select inequivalent \
sampling sites, regenerate initial and final states for cNEB calculations -> \
4_IF _GeoOpt\
\>", "Subsubsection",
 CellChangeTimes->{{3.947764631559256*^9, 
  3.9477647951544933`*^9}},ExpressionUUID->"a2fd32c4-d951-4b49-8af9-\
e34921789e89"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"MapThread", "[", 
   RowBox[{
    RowBox[{
     RowBox[{"IneqSites", "[", 
      RowBox[{
      "folderPath", ",", "#1", ",", "#2", ",", "#3", ",", "eqlTol", ",", 
       "\"\<3_normal_GeoOpt\>\""}], "]"}], "&"}], ",", "list"}], "]"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"MapThread", "[", 
   RowBox[{
    RowBox[{
     RowBox[{"netIF", "[", 
      RowBox[{"folderPath", ",", "#1", ",", "#2", ",", "#3", ",", 
       RowBox[{"{", 
        RowBox[{"drmin", ",", "drmax"}], "}"}]}], "]"}], "&"}], ",", "list"}],
    "]"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"MapThread", "[", 
   RowBox[{
    RowBox[{
     RowBox[{"Step4POSCARs", "[", 
      RowBox[{"folderPath", ",", "#1", ",", "#2"}], "]"}], "&"}], ",", 
    "list"}], "]"}], ";"}]}], "Input",
 CellChangeTimes->{
  3.896645121646808*^9, {3.89664519606084*^9, 3.896645218697787*^9}, {
   3.9030507840676985`*^9, 3.903050784515896*^9}, {3.9349173972492633`*^9, 
   3.934917397817637*^9}, 3.946604509966317*^9, {3.946605401390199*^9, 
   3.946605403087536*^9}, 3.947676059148958*^9, {3.947678225269987*^9, 
   3.947678252762928*^9}, 3.947678336304659*^9, {3.94769630501715*^9, 
   3.947696305349079*^9}, {3.947696878382964*^9, 3.94769695680663*^9}, {
   3.947715864289953*^9, 3.9477158820046453`*^9}, {3.947716619127586*^9, 
   3.947716621227092*^9}, {3.947716689417156*^9, 3.94771669801455*^9}, {
   3.94771685659356*^9, 3.947716865367171*^9}, {3.947717061505208*^9, 
   3.947717061845856*^9}, {3.947718868654961*^9, 3.947718869015751*^9}, {
   3.94771984038279*^9, 3.947719850441448*^9}, {3.947720101404892*^9, 
   3.947720114396184*^9}, {3.94772045383156*^9, 3.9477204904241753`*^9}, {
   3.947720818847801*^9, 3.94772092317146*^9}, {3.9477210609499636`*^9, 
   3.947721061291173*^9}, {3.94775211535081*^9, 3.9477521156769114`*^9}, {
   3.9477647829262877`*^9, 3.94776480093165*^9}},
 CellLabel->"In[59]:=",ExpressionUUID->"b75d118b-08b8-4942-aedb-f6390d94830e"]
}, Open  ]],

Cell[CellGroupData[{

Cell["\<\
D. Finish DFT calculations in 4_IF _GeoOpt, then generate input files for \
cNEB calculations -> 5_cNEB _Opt\
\>", "Subsubsection",
 CellChangeTimes->{{3.947764631559256*^9, 
  3.9477648278909063`*^9}},ExpressionUUID->"bc111b98-c3d5-4c50-9c9d-\
a58058a9c3b2"],

Cell[BoxData[
 RowBox[{"MapThread", "[", 
  RowBox[{
   RowBox[{
    RowBox[{"PrepareNEB", "[", 
     RowBox[{"folderPath", ",", "#1", ",", "#2"}], "]"}], "&"}], ",", 
   "list"}], "]"}]], "Input",
 CellChangeTimes->{{3.947731434672323*^9, 3.9477314622889385`*^9}},
 CellLabel->"In[62]:=",ExpressionUUID->"21206c90-a1eb-45fc-bd8c-cd3bcb826e25"]
}, Open  ]],

Cell[CellGroupData[{

Cell["\<\
E. Finish DFT calculations in 5_cNEB _Opt, then collect and compile cNEB \
results\
\>", "Subsubsection",
 CellChangeTimes->{{3.947764631559256*^9, 3.9477648278909063`*^9}, {
  3.947764863089066*^9, 
  3.94776488222643*^9}},ExpressionUUID->"20864a18-9fc8-42d8-91c2-\
0074a50f3c73"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"Eion", "=", "0"}], 
  RowBox[{"(*", 
   RowBox[{
    RowBox[{"Li", "-", 
     RowBox[{"ion", " ", 
      RowBox[{"energy", ":", "0"}]}]}], ";", " ", 
    RowBox[{"Na", "-", 
     RowBox[{"ion", " ", 
      RowBox[{"energy", ":", "0"}]}]}], ";", " ", 
    RowBox[{"K", "-", 
     RowBox[{"ion", " ", 
      RowBox[{"energy", ":", "0.297"}]}]}], ";"}], "*)"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{"MapThread", "[", 
  RowBox[{
   RowBox[{
    RowBox[{"CompileMEP", "[", 
     RowBox[{"folderPath", ",", "#1", ",", "#2", ",", "Eion"}], "]"}], "&"}], 
   ",", "list"}], "]"}]}], "Input",
 CellChangeTimes->{{3.947697025452332*^9, 3.9476970395352917`*^9}, 
   3.9477183800336227`*^9, {3.947718596718675*^9, 3.947718624700541*^9}, {
   3.947718873505664*^9, 3.947718874788785*^9}, {3.947719761736888*^9, 
   3.947719774342998*^9}, {3.94771990419118*^9, 3.947720007710905*^9}, 
   3.947720725561952*^9, {3.947720944889475*^9, 3.947720945561095*^9}, {
   3.947721073920989*^9, 3.947721075343398*^9}, 3.947764859777762*^9, {
   3.947764891131979*^9, 3.947764891406098*^9}},
 CellLabel->"In[63]:=",ExpressionUUID->"3a3a30c5-96d2-4758-a3c6-6f50988e6d7d"]
}, Open  ]],

Cell[CellGroupData[{

Cell["F. Generate 3D diffusion network -> 6_ 3D_network", "Subsubsection",
 CellChangeTimes->{{3.947764631559256*^9, 3.9477648278909063`*^9}, {
  3.947764863089066*^9, 
  3.947764911322435*^9}},ExpressionUUID->"87fefa85-a78b-4cec-a7d2-\
beedc1431556"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"MapThread", "[", 
   RowBox[{
    RowBox[{
     RowBox[{"CreateTrajectory", "[", 
      RowBox[{"folderPath", ",", "#1", ",", "#2"}], "]"}], "&"}], ",", 
    "list"}], "]"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{"MapThread", "[", 
  RowBox[{
   RowBox[{
    RowBox[{"GenerateDumpFile", "[", 
     RowBox[{"folderPath", ",", "#1", ",", "#2", ",", "#3"}], "]"}], "&"}], 
   ",", "list"}], "]"}]}], "Input",
 CellChangeTimes->{{3.9476946553757*^9, 3.947694691869995*^9}, 
   3.947694921073164*^9, {3.947697050132862*^9, 3.947697062309073*^9}, 
   3.947697487221946*^9, {3.947710882248904*^9, 3.947710882661129*^9}, {
   3.947718878318204*^9, 3.947718878768379*^9}, {3.947718925531248*^9, 
   3.947718940334096*^9}, 3.947719030939892*^9, {3.94772094846259*^9, 
   3.947720948852124*^9}, {3.947721009233848*^9, 3.94772103450492*^9}, {
   3.947721077629626*^9, 3.947721078507319*^9}, {3.947733538751545*^9, 
   3.94773355743635*^9}, {3.947736138087134*^9, 3.947736138548714*^9}, {
   3.947737318545657*^9, 3.947737319398493*^9}, {3.947737836090307*^9, 
   3.94773783642798*^9}, {3.947737933634815*^9, 3.9477379339002857`*^9}, 
   3.947741273506388*^9, {3.947741865485691*^9, 3.947741865908654*^9}, {
   3.947757811161475*^9, 3.947757812065466*^9}, {3.947757843823839*^9, 
   3.947757845204264*^9}, {3.9477649028987517`*^9, 3.94776491374055*^9}},
 CellLabel->"In[65]:=",ExpressionUUID->"472b3735-c11a-4da0-be10-0266b2d7961b"]
}, Open  ]]
}, Open  ]]
},
WindowSize->{1728, 959},
WindowMargins->{{0, Automatic}, {Automatic, 0}},
Magnification:>1.1 Inherited,
FrontEndVersion->"14.0 for Mac OS X ARM (64-bit) (December 12, 2023)",
StyleDefinitions->"Default.nb",
ExpressionUUID->"e420861d-5c96-4174-bbdc-945049955591"
]
(* End of Notebook Content *)

(* Internal cache information *)
(*CellTagsOutline
CellTagsIndex->{}
*)
(*CellTagsIndex
CellTagsIndex->{}
*)
(*NotebookFileOutline
Notebook[{
Cell[CellGroupData[{
Cell[580, 22, 1302, 20, 62, "Section",ExpressionUUID->"67b66d33-e159-4bf6-8153-251727357a1b"],
Cell[1885, 44, 27353, 652, 2013, "Input",ExpressionUUID->"10101d97-c54b-4c44-8ddf-90dadb59f522"]
}, Closed]],
Cell[CellGroupData[{
Cell[29275, 701, 1207, 19, 46, "Section",ExpressionUUID->"66f55196-31fa-4be5-96d0-d6e54c178936"],
Cell[30485, 722, 14616, 326, 1116, "Input",ExpressionUUID->"df2e0752-035e-4f15-8b65-f5ff9acdb406"]
}, Closed]],
Cell[CellGroupData[{
Cell[45138, 1053, 1232, 19, 46, "Section",ExpressionUUID->"dca36987-43ff-4a2d-98af-1c5bbf2a3d89"],
Cell[46373, 1074, 68319, 1544, 4566, "Input",ExpressionUUID->"c36d70f7-7c2d-425f-aeeb-f0f5ea2291d3"]
}, Closed]],
Cell[CellGroupData[{
Cell[114729, 2623, 632, 11, 46, "Section",ExpressionUUID->"028338cc-696b-4e76-8b80-34664c32bf42"],
Cell[115364, 2636, 6640, 158, 472, "Input",ExpressionUUID->"8dd4975a-d123-4bcb-8040-124c60415da2"]
}, Closed]],
Cell[CellGroupData[{
Cell[122041, 2799, 581, 10, 46, "Section",ExpressionUUID->"a926768b-aec1-44fd-a961-221fe6e4cdc9"],
Cell[122625, 2811, 9745, 232, 1070, "Input",ExpressionUUID->"baefb03c-404d-4cf4-8432-719a5166bc45"]
}, Closed]],
Cell[CellGroupData[{
Cell[132407, 3048, 1283, 20, 46, "Section",ExpressionUUID->"3f9a7937-ad75-4cf0-863e-0b859e393da6"],
Cell[133693, 3070, 43329, 1023, 3350, "Input",ExpressionUUID->"0a944ecb-4d44-430b-8997-055f3d31e6ee"]
}, Closed]],
Cell[CellGroupData[{
Cell[177059, 4098, 1005, 17, 46, "Section",ExpressionUUID->"a2b616d5-0169-45f8-9e66-40cda8b17f5f"],
Cell[CellGroupData[{
Cell[178089, 4119, 210, 3, 49, "Subsubsection",ExpressionUUID->"4e7d7127-ee79-4aea-aef7-ec2b3a2d7b4a"],
Cell[178302, 4124, 5596, 122, 219, "Input",ExpressionUUID->"159008e2-58b6-4fd3-96d6-7cf015854836"]
}, Open  ]],
Cell[CellGroupData[{
Cell[183935, 4251, 310, 6, 49, "Subsubsection",ExpressionUUID->"4dc765da-f44e-46be-88b6-a7b727221882"],
Cell[184248, 4259, 2546, 41, 34, "Input",ExpressionUUID->"fa54aa8e-5231-45a2-adb4-705fa9271f0f"]
}, Open  ]],
Cell[CellGroupData[{
Cell[186831, 4305, 295, 6, 49, "Subsubsection",ExpressionUUID->"bd6e9789-0aac-428e-a468-332edb3860b6"],
Cell[187129, 4313, 2310, 38, 34, "Input",ExpressionUUID->"c2fe175f-a613-48a5-a69e-0371b51bbf12"]
}, Open  ]],
Cell[CellGroupData[{
Cell[189476, 4356, 327, 7, 49, "Subsubsection",ExpressionUUID->"a2fd32c4-d951-4b49-8af9-e34921789e89"],
Cell[189806, 4365, 1986, 42, 81, "Input",ExpressionUUID->"b75d118b-08b8-4942-aedb-f6390d94830e"]
}, Open  ]],
Cell[CellGroupData[{
Cell[191829, 4412, 269, 6, 49, "Subsubsection",ExpressionUUID->"bc111b98-c3d5-4c50-9c9d-a58058a9c3b2"],
Cell[192101, 4420, 344, 8, 34, "Input",ExpressionUUID->"21206c90-a1eb-45fc-bd8c-cd3bcb826e25"]
}, Open  ]],
Cell[CellGroupData[{
Cell[192482, 4433, 291, 7, 49, "Subsubsection",ExpressionUUID->"20864a18-9fc8-42d8-91c2-0074a50f3c73"],
Cell[192776, 4442, 1186, 28, 58, "Input",ExpressionUUID->"3a3a30c5-96d2-4758-a3c6-6f50988e6d7d"]
}, Open  ]],
Cell[CellGroupData[{
Cell[193999, 4475, 251, 4, 49, "Subsubsection",ExpressionUUID->"87fefa85-a78b-4cec-a7d2-beedc1431556"],
Cell[194253, 4481, 1457, 27, 58, "Input",ExpressionUUID->"472b3735-c11a-4da0-be10-0266b2d7961b"]
}, Open  ]]
}, Open  ]]
}
]
*)

